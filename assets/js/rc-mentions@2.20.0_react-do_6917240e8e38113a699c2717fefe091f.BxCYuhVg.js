import{h as e,i as t,g as n,k as o}from"./@babel_runtime@7.28.3.BsXYqacS.js";import{c as r}from"./classnames@2.5.1.DzaQuX-8.js";import{B as a}from"./rc-input@1.8.0_react-dom@19.1.1_react@19.1.1__react@19.1.1.BStWp2MJ.js";import{f as l,A as i,K as u}from"./rc-util@5.44.4_react-dom@19.1.1_react@19.1.1__react@19.1.1.Cptqj8wH.js";import{r as c,e as s}from"./react@19.1.1.DFOJwFPq.js";import{T as f}from"./rc-textarea@1.10.2_react-do_9e63c3c40a7644816d7e7f4d071a8248.hF2RuTk2.js";import"./rc-resize-observer@1.4.3_re_417e6ee79a83d8d6def766a6be83681f.C5AGUuAA.js";import{T as d}from"./@rc-component_trigger@2.3.0_98a5ef371ed9a77c6843246644ee9b58.BREfuzzF.js";import{E as p,M as v}from"./rc-menu@9.16.1_react-dom@19.1.1_react@19.1.1__react@19.1.1.BhjpGEzL.js";var m=c.createContext(null);function C(e){var t=c.useContext(m),n=t.notFoundContent,o=t.activeIndex,r=t.setActiveIndex,a=t.selectOption,l=t.onFocus,i=t.onBlur,u=t.onScroll,s=e.prefixCls,f=e.options,d=f[o]||{};return c.createElement(p,{prefixCls:"".concat(s,"-menu"),activeKey:d.key,onSelect:function(e){var t=e.key,n=f.find(function(e){return e.key===t});a(n)},onFocus:l,onBlur:i,onScroll:u},f.map(function(e,t){var n=e.key,o=e.disabled,a=e.className,l=e.style,i=e.label;return c.createElement(v,{key:n,disabled:o,className:a,style:l,onMouseEnter:function(){r(t)}},i)}),!f.length&&c.createElement(v,{disabled:!0},n))}var x={bottomRight:{points:["tl","br"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},bottomLeft:{points:["tr","bl"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},topRight:{points:["bl","tr"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}},topLeft:{points:["br","tl"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}}},h=function(e){var t=e.prefixCls,n=e.options,o=e.children,r=e.visible,a=e.transitionName,l=e.getPopupContainer,i=e.dropdownClassName,u=e.direction,s=e.placement,f="".concat(t,"-dropdown"),p=c.createElement(C,{prefixCls:f,options:n}),v=c.useMemo(function(){return"rtl"===u?"top"===s?"topLeft":"bottomLeft":"top"===s?"topRight":"bottomRight"},[u,s]);return c.createElement(d,{prefixCls:f,popupVisible:r,popup:p,popupPlacement:v,popupTransitionName:a,builtinPlacements:x,getPopupContainer:l,popupClassName:i},o)};function g(e){return(e||"").toLowerCase()}function b(e,t){var n=t.measureLocation,o=t.prefix,r=t.targetText,a=t.selectionStart,l=t.split,i=e.slice(0,n);i[i.length-l.length]===l&&(i=i.slice(0,i.length-l.length)),i&&(i="".concat(i).concat(l));var u=function(e,t,n){var o=e[0];if(!o||o===n)return e;for(var r=e,a=t.length,l=0;l<a;l+=1){if(g(r[l])!==g(t[l])){r=r.slice(l);break}l===a-1&&(r=r.slice(a))}return r}(e.slice(a),r.slice(a-n-o.length),l);u.slice(0,l.length)===l&&(u=u.slice(l.length));var c="".concat(i).concat(o).concat(r).concat(l);return{text:"".concat(c).concat(u),selectionLocation:c.length}}function w(e,t){return!t||-1===e.indexOf(t)}function E(e,t){var n=t.value,o=void 0===n?"":n,r=e.toLowerCase();return-1!==o.toLowerCase().indexOf(r)}var N=["prefixCls","className","style","prefix","split","notFoundContent","value","defaultValue","children","options","open","allowClear","silent","validateSearch","filterOption","onChange","onKeyDown","onKeyUp","onPressEnter","onSearch","onSelect","onFocus","onBlur","transitionName","placement","direction","getPopupContainer","dropdownClassName","rows","visible","onPopupScroll"],S=["suffix","prefixCls","defaultValue","value","allowClear","onChange","classNames","className","disabled","onClear"],y=c.forwardRef(function(a,d){var p=a.prefixCls,v=a.className,C=a.style,x=a.prefix,g=void 0===x?"@":x,S=a.split,y=void 0===S?" ":S,_=a.notFoundContent,j=void 0===_?"Not Found":_,k=a.value,P=a.defaultValue,R=a.children,T=a.options,L=a.open;a.allowClear;var O=a.silent,A=a.validateSearch,F=void 0===A?w:A,I=a.filterOption,K=void 0===I?E:I,B=a.onChange,D=a.onKeyDown,M=a.onKeyUp,V=a.onPressEnter,U=a.onSearch,X=a.onSelect,Y=a.onFocus,z=a.onBlur,H=a.transitionName,W=a.placement,G=a.direction,q=a.getPopupContainer,J=a.dropdownClassName,Q=a.rows,Z=void 0===Q?1:Q;a.visible;var $=a.onPopupScroll,ee=t(a,N),te=c.useMemo(function(){return Array.isArray(g)?g:[g]},[g]),ne=c.useRef(null),oe=c.useRef(null),re=c.useRef(null),ae=function(){var e;return null===(e=oe.current)||void 0===e||null===(e=e.resizableTextArea)||void 0===e?void 0:e.textArea};s.useImperativeHandle(d,function(){var e;return{focus:function(){var e;return null===(e=oe.current)||void 0===e?void 0:e.focus()},blur:function(){var e;return null===(e=oe.current)||void 0===e?void 0:e.blur()},textarea:null===(e=oe.current)||void 0===e||null===(e=e.resizableTextArea)||void 0===e?void 0:e.textArea,nativeElement:ne.current}});var le=c.useState(!1),ie=e(le,2),ue=ie[0],ce=ie[1],se=c.useState(""),fe=e(se,2),de=fe[0],pe=fe[1],ve=c.useState(""),me=e(ve,2),Ce=me[0],xe=me[1],he=c.useState(0),ge=e(he,2),be=ge[0],we=ge[1],Ee=c.useState(0),Ne=e(Ee,2),Se=Ne[0],ye=Ne[1],_e=c.useState(!1),je=e(_e,2),ke=je[0],Pe=je[1],Re=l("",{defaultValue:P,value:k}),Te=e(Re,2),Le=Te[0],Oe=Te[1];c.useEffect(function(){ue&&re.current&&(re.current.scrollTop=ae().scrollTop)},[ue]);var Ae=s.useMemo(function(){if(L)for(var e=0;e<te.length;e+=1){var t=te[e],n=Le.lastIndexOf(t);if(n>=0)return[!0,"",t,n]}return[ue,de,Ce,be]},[L,ue,te,Le,de,Ce,be]),Fe=e(Ae,4),Ie=Fe[0],Ke=Fe[1],Be=Fe[2],De=Fe[3],Me=s.useCallback(function(e){return(T&&T.length>0?T.map(function(e){var t;return n(n({},e),{},{key:null!==(t=null==e?void 0:e.key)&&void 0!==t?t:e.value})}):i(R).map(function(e){var t=e.props,o=e.key;return n(n({},t),{},{label:t.children,key:o||t.value})})).filter(function(t){return!1===K||K(e,t)})},[R,T,K]),Ve=s.useMemo(function(){return Me(Ke)},[Me,Ke]),Ue=function(){var t=c.useState({id:0,callback:null}),n=e(t,2),o=n[0],r=n[1],a=c.useCallback(function(e){r(function(t){return{id:t.id+1,callback:e}})},[]);return c.useEffect(function(){var e;null===(e=o.callback)||void 0===e||e.call(o)},[o]),a}(),Xe=function(e){ce(!1),we(0),pe(""),Ue(e)},Ye=function(e){Oe(e),null==B||B(e)},ze=function(e){var t,n=e.value,o=b(Le,{measureLocation:De,targetText:void 0===n?"":n,prefix:Be,selectionStart:null===(t=ae())||void 0===t?void 0:t.selectionStart,split:y}),r=o.text,a=o.selectionLocation;Ye(r),Xe(function(){var e,t;e=ae(),t=a,e.setSelectionRange(t,t),e.blur(),e.focus()}),null==X||X(e,Be)},He=c.useRef(),We=function(e){window.clearTimeout(He.current),!ke&&e&&Y&&Y(e),Pe(!0)},Ge=function(e){He.current=window.setTimeout(function(){Pe(!1),Xe(),null==z||z(e)},0)};return s.createElement("div",{className:r(p,v),style:C,ref:ne},s.createElement(f,o({ref:oe,value:Le},ee,{rows:Z,onChange:function(e){var t=e.target.value;Ye(t)},onKeyDown:function(e){var t=e.which;if(null==D||D(e),Ie)if(t===u.UP||t===u.DOWN){var n=Ve.length,o=t===u.UP?-1:1;ye((Se+o+n)%n),e.preventDefault()}else if(t===u.ESC)Xe();else if(t===u.ENTER){if(e.preventDefault(),O)return;if(!Ve.length)return void Xe();var r=Ve[Se];ze(r)}},onKeyUp:function(e){var t,n,o=e.key,r=e.which,a=e.target,l=(n=(t=a).selectionStart,t.value.slice(0,n)),i=function(e,t){return t.reduce(function(t,n){var o=e.lastIndexOf(n);return o>t.location?{location:o,prefix:n}:t},{location:-1,prefix:""})}(l,te),c=i.location,s=i.prefix;if(null==M||M(e),-1===[u.ESC,u.UP,u.DOWN,u.ENTER].indexOf(r))if(-1!==c){var f=l.slice(c+s.length),d=F(f,y),p=!!Me(f).length;d?(o===s||"Shift"===o||r===u.ALT||"AltGraph"===o||Ie||f!==Ke&&p)&&function(e,t,n){ce(!0),pe(e),xe(t),we(n),ye(0)}(f,s,c):Ie&&Xe(),U&&d&&U(f,s)}else Ie&&Xe()},onPressEnter:function(e){!Ie&&V&&V(e)},onFocus:We,onBlur:Ge})),Ie&&s.createElement("div",{ref:re,className:"".concat(p,"-measure")},Le.slice(0,De),s.createElement(m.Provider,{value:{notFoundContent:j,activeIndex:Se,setActiveIndex:ye,selectOption:ze,onFocus:function(){We()},onBlur:function(){Ge()},onScroll:function(e){null==$||$(e)}}},s.createElement(h,{prefixCls:p,transitionName:H,placement:W,direction:G,options:Ve,visible:!0,getPopupContainer:q,dropdownClassName:J},s.createElement("span",null,Be))),Le.slice(De+Be.length)))}),_=c.forwardRef(function(r,i){var u=r.suffix,f=r.prefixCls,d=void 0===f?"rc-mentions":f,p=r.defaultValue,v=r.value,m=r.allowClear,C=r.onChange,x=r.classNames,h=r.className,g=r.disabled,b=r.onClear,w=t(r,S),E=c.useRef(null),N=c.useRef(null);c.useImperativeHandle(i,function(){var e,t;return n(n({},N.current),{},{nativeElement:(null===(e=E.current)||void 0===e?void 0:e.nativeElement)||(null===(t=N.current)||void 0===t?void 0:t.nativeElement)})});var _=l("",{defaultValue:p,value:v}),j=e(_,2),k=j[0],P=j[1],R=function(e){P(e),null==C||C(e)};return s.createElement(a,{suffix:u,prefixCls:d,value:k,allowClear:m,handleReset:function(){R("")},className:h,classNames:x,disabled:g,ref:E,onClear:b},s.createElement(y,o({className:null==x?void 0:x.mentions,prefixCls:d,ref:N,onChange:R,disabled:g},w)))});_.Option=function(){return null};export{_ as M};
