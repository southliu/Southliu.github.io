import{c as e}from"./clsx@2.1.1.DMqMD_4V.js";import{B as t}from"./@rc-component_input@1.1.2_r_6672dd2a1daa1d4fb8167692335bdc32.Cwueeivh.js";import{d as n,f as l,t as o,K as r}from"./@rc-component_util@1.7.0_re_97ed4941f5d27d044aa2ecbc4a75f304.4n28hD7h.js";import{r as a,e as s}from"./react@19.2.3.DikTGMTS.js";import{T as c}from"./@rc-component_textarea@1.1._509480b13cbc5aaa7fb930d30d5446b8.CeaP0cAz.js";import"./@rc-component_resize-observ_a5d141e3de655ef602de0c6d9e51ffb4.BTh966e6.js";import{T as i}from"./@rc-component_trigger@3.7.2_b5d51e27885fcdc381f6db89cb94580b.MgdExJH2.js";import{E as u,M as p}from"./@rc-component_menu@1.2.0_re_22c4d0f32307dedeae1bf96beb63120f.BRiKyNrJ.js";const f=a.createContext(null);function d(e){const{notFoundContent:t,activeIndex:n,setActiveIndex:l,selectOption:o,onFocus:r,onBlur:c,onScroll:i}=s.useContext(f),{prefixCls:d,options:m,opened:v}=e,b=m[n]||{},x=a.useRef(null);return a.useEffect(()=>{var e,t;if(-1===n||!x.current||!v)return;const l=null==(t=null==(e=x.current)?void 0:e.findItem)?void 0:t.call(e,{key:b.key});l&&l.scrollIntoView({block:"nearest",inline:"nearest"})},[n,b.key,v]),s.createElement(u,{ref:x,prefixCls:"".concat(d,"-menu"),activeKey:b.key,onSelect:({key:e})=>{const t=m.find(({key:t})=>t===e);o(t)},onFocus:r,onBlur:c,onScroll:i},m.map((e,t)=>{const{key:n,disabled:o,className:r,style:a,label:c}=e;return s.createElement(p,{key:n,disabled:o,className:r,style:a,onMouseEnter:()=>{l(t)}},c)}),!m.length&&s.createElement(p,{disabled:!0},t))}const m={bottomRight:{points:["tl","br"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},bottomLeft:{points:["tr","bl"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},topRight:{points:["bl","tr"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}},topLeft:{points:["br","tl"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}}},v=e=>{const{prefixCls:t,options:n,children:l,visible:o,transitionName:r,getPopupContainer:s,popupClassName:c,popupStyle:u,direction:p,placement:f}=e,v="".concat(t,"-dropdown"),[b,x]=a.useState(!1),h=a.createElement(d,{prefixCls:v,options:n,opened:b}),C=a.useMemo(()=>{let e;return e="rtl"===p?"top"===f?"topLeft":"bottomLeft":"top"===f?"topRight":"bottomRight",e},[p,f]);return a.createElement(i,{prefixCls:v,popupVisible:o,popup:h,popupPlacement:C,popupMotion:{motionName:r},builtinPlacements:m,getPopupContainer:s,popupClassName:c,popupStyle:u,afterOpenChange:x},l)};function b(e){return(e||"").toLowerCase()}function x(e,t){const{measureLocation:n,prefix:l,targetText:o,selectionStart:r,split:a}=t;let s=e.slice(0,n);s[s.length-a.length]===a&&(s=s.slice(0,s.length-a.length)),s&&(s="".concat(s).concat(a));let c=function(e,t,n){const l=e[0];if(!l||l===n)return e;let o=e;const r=t.length;for(let a=0;a<r;a+=1){if(b(o[a])!==b(t[a])){o=o.slice(a);break}a===r-1&&(o=o.slice(r))}return o}(e.slice(r),o.slice(r-n-l.length),a);c.slice(0,a.length)===a&&(c=c.slice(a.length));const i="".concat(s).concat(l).concat(o).concat(a);return{text:"".concat(i).concat(c),selectionLocation:i.length}}function h(e,t){return!t||-1===e.indexOf(t)}function C(e,{value:t=""}){const n=e.toLowerCase();return-1!==t.toLowerCase().indexOf(n)}const g=a.createContext({});function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},y.apply(this,arguments)}const E=a.forwardRef((t,i)=>{const{prefixCls:u,className:p,style:d,classNames:m,styles:b,prefix:E="@",split:S=" ",notFoundContent:N="Not Found",value:w,defaultValue:k,children:j,options:R,allowClear:O,hasWrapper:_,silent:P,validateSearch:L=h,filterOption:T=C,onChange:I,onKeyDown:A,onKeyUp:F,onPressEnter:M,onSearch:D,onSelect:K,onFocus:z,onBlur:B,transitionName:U,placement:V,direction:W,getPopupContainer:X,popupClassName:Y,rows:H=1,visible:G,onPopupScroll:q,...J}=t,Q=a.useMemo(()=>Array.isArray(E)?E:[E],[E]),Z=a.useRef(null),$=a.useRef(null),ee=a.useRef(null),te=()=>{var e,t;return null==(t=null==(e=$.current)?void 0:e.resizableTextArea)?void 0:t.textArea};s.useImperativeHandle(i,()=>{var e,t;return{focus:()=>{var e;return null==(e=$.current)?void 0:e.focus()},blur:()=>{var e;return null==(e=$.current)?void 0:e.blur()},textarea:null==(t=null==(e=$.current)?void 0:e.resizableTextArea)?void 0:t.textArea,nativeElement:Z.current}});const[ne,le]=a.useState(!1),[oe,re]=a.useState(""),[ae,se]=a.useState(""),[ce,ie]=a.useState(0),[ue,pe]=a.useState(0),[fe,de]=a.useState(!1),me=l(t.id),[ve,be]=n(k||"",w),{open:xe}=a.useContext(g);a.useEffect(()=>{ne&&ee.current&&(ee.current.scrollTop=te().scrollTop)},[ne]);const[he,Ce,ge,ye]=s.useMemo(()=>{if(xe)for(let e=0;e<Q.length;e+=1){const t=Q[e],n=ve.lastIndexOf(t);if(n>=0)return[!0,"",t,n]}return[ne,oe,ae,ce]},[xe,ne,Q,ve,oe,ae,ce]),Ee=s.useCallback(e=>{let t;return t=R&&R.length>0?R.map(e=>{var t;return{...e,key:"".concat(null!=(t=null==e?void 0:e.key)?t:e.value,"-").concat(me)}}):o(j).map(({props:e,key:t})=>({...e,label:e.children,key:"".concat(t||e.value,"-").concat(me)})),t.filter(t=>!1===T||T(e,t))},[R,me,j,T]),Se=s.useMemo(()=>Ee(Ce),[Ee,Ce]),Ne=function(){const[e,t]=a.useState({id:0,callback:null}),n=a.useCallback(e=>{t(({id:t})=>({id:t+1,callback:e}))},[]);return a.useEffect(()=>{var t;null==(t=e.callback)||t.call(e)},[e]),n}(),we=e=>{le(!1),ie(0),re(""),Ne(e)},ke=e=>{be(e),null==I||I(e)},je=e=>{var t;const{value:n=""}=e,{text:l,selectionLocation:o}=x(ve,{measureLocation:ye,targetText:n,prefix:ge,selectionStart:null==(t=te())?void 0:t.selectionStart,split:S});ke(l),we(()=>{var e,t;e=te(),t=o,e.setSelectionRange(t,t),e.blur(),e.focus()}),null==K||K(e,ge)},Re=a.useRef(),Oe=e=>{window.clearTimeout(Re.current),!fe&&e&&z&&z(e),de(!0)},_e=e=>{Re.current=window.setTimeout(()=>{de(!1),we(),null==B||B(e)},0)},Pe=s.useMemo(()=>{var e,t;const n=null!=(t=null==(e=null==b?void 0:b.textarea)?void 0:e.resize)?t:null==d?void 0:d.resize,l={...null==b?void 0:b.textarea};return void 0!==n&&(l.resize=n),{...b,textarea:l}},[d,b]),Le=s.createElement(s.Fragment,null,s.createElement(c,y({classNames:{textarea:null==m?void 0:m.textarea},styles:Pe,ref:$,value:ve},J,{rows:H,onChange:({target:{value:e}})=>{ke(e)},onKeyDown:e=>{const{which:t}=e;if(null==A||A(e),he)if(t===r.UP||t===r.DOWN){const n=Se.length,l=t===r.UP?-1:1;pe((ue+l+n)%n),e.preventDefault()}else if(t===r.ESC)we();else if(t===r.ENTER){if(e.preventDefault(),P)return;if(!Se.length)return void we();const t=Se[ue];je(t)}},onKeyUp:e=>{const{key:t,which:n}=e,l=function(e){const{selectionStart:t}=e;return e.value.slice(0,t)}(e.target),{location:o,prefix:a}=function(e,t){return t.reduce((t,n)=>{const l=e.lastIndexOf(n);return l>t.location?{location:l,prefix:n}:t},{location:-1,prefix:""})}(l,Q);if(null==F||F(e),-1===[r.ESC,r.UP,r.DOWN,r.ENTER].indexOf(n))if(-1!==o){const e=l.slice(o+a.length),s=L(e,S),c=!!Ee(e).length;s?(t===a||"Shift"===t||n===r.ALT||"AltGraph"===t||he||e!==Ce&&c)&&((e,t,n)=>{le(!0),re(e),se(t),ie(n),pe(0)})(e,a,o):he&&we(),D&&s&&D(e,a)}else he&&we()},onPressEnter:e=>{!he&&M&&M(e)},onFocus:Oe,onBlur:_e})),he&&s.createElement("div",{ref:ee,className:"".concat(u,"-measure")},ve.slice(0,ye),s.createElement(f.Provider,{value:{notFoundContent:N,activeIndex:ue,setActiveIndex:pe,selectOption:je,onFocus:()=>{Oe()},onBlur:()=>{_e()},onScroll:e=>{null==q||q(e)}}},s.createElement(v,{prefixCls:u,transitionName:U,placement:V,direction:W,options:Se,visible:!0,getPopupContainer:X,popupClassName:e(Y,null==m?void 0:m.popup),popupStyle:null==b?void 0:b.popup},s.createElement("span",null,ge))),ve.slice(ye+ge.length)));return _?Le:s.createElement("div",{className:e(u,p),style:d,ref:Z},Le)}),S=a.forwardRef(({suffix:l,prefixCls:o="rc-mentions",defaultValue:r,value:c,id:i,allowClear:u,onChange:p,classNames:f,styles:d,className:m,disabled:v,onClear:b,...x},h)=>{const C=!(!l&&!u),g=a.useRef(null),S=a.useRef(null);a.useImperativeHandle(h,()=>{var e,t;return{...S.current,nativeElement:(null==(e=g.current)?void 0:e.nativeElement)||(null==(t=S.current)?void 0:t.nativeElement)}});const[N,w]=n(r||"",c),k=e=>{w(e),null==p||p(e)};return s.createElement(t,{suffix:l,prefixCls:o,value:N,allowClear:u,handleReset:()=>{k("")},className:e(o,m,{["".concat(o,"-has-suffix")]:C}),classNames:f,disabled:v,ref:g,onClear:b},s.createElement(E,y({className:null==f?void 0:f.mentions,styles:d,classNames:f,prefixCls:o,id:i,ref:S,onChange:k,disabled:v,hasWrapper:C},x)))});S.Option=()=>null;export{S as M};
