var e=Object.defineProperty,t=(t,n,r)=>((t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r)(t,"symbol"!=typeof n?n+"":n,r);import{r as n}from"./react@18.3.1.zoCbf7Ot.js";import{c as r,l as o,D as s,E as i,e as a,s as c,n as u,F as l}from"./@rc-component_util@1.7.0_re_e38ee95702524036372f825efc96e921.ChzNieGb.js";import{c as f}from"./clsx@2.1.1.DMqMD_4V.js";const m=n.createContext({});function p({children:e,...t}){return n.createElement(m.Provider,{value:t},e)}const d="none",v="appear",y="enter",E="leave",h="none",k="prepare",b="start",A="active",L="end",g="prepared";function C(e,t){const n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit".concat(e)]="webkit".concat(t),n["Moz".concat(e)]="moz".concat(t),n["ms".concat(e)]="MS".concat(t),n["O".concat(e)]="o".concat(t.toLowerCase()),n}const P=function(e,t){const n={animationend:C("Animation","AnimationEnd"),transitionend:C("Transition","TransitionEnd")};return e&&("AnimationEvent"in t||delete n.animationend.animation,"TransitionEvent"in t||delete n.transitionend.transition),n}(r(),"undefined"!=typeof window?window:{});let j={};r()&&({style:j}=document.createElement("div"));const w={};function O(e){if(w[e])return w[e];const t=P[e];if(t){const n=Object.keys(t),r=n.length;for(let o=0;o<r;o+=1){const r=n[o];if(Object.prototype.hasOwnProperty.call(t,r)&&r in j)return w[e]=t[r],w[e]}}return""}const R=O("animationend"),S=O("transitionend"),M=!(!R||!S),N=R||"animationend",x=S||"transitionend";function T(e,t){if(!e)return null;if("object"==typeof e){return e[t.replace(/-\w/g,e=>e[1].toUpperCase())]}return"".concat(e,"-").concat(t)}const D=r()?n.useLayoutEffect:n.useEffect,V=[k,b,A,L],F=[k,g],I=!1;function _(e){return e===A||e===L}const z=(e,t,r)=>{const[i,a]=s(h),[c,u]=(()=>{const e=n.useRef(null);function t(){o.cancel(e.current)}return n.useEffect(()=>()=>{t()},[]),[function n(r,s=2){t();const i=o(()=>{s<=1?r({isCanceled:()=>i!==e.current}):n(r,s-1)});e.current=i},t]})();const l=t?F:V;return D(()=>{if(i!==h&&i!==L){const e=l.indexOf(i),t=l[e+1],n=r(i);n===I?a(t,!0):t&&c(e=>{function r(){e.isCanceled()||a(t,!0)}!0===n?r():Promise.resolve(n).then(r)})}},[e,i]),n.useEffect(()=>()=>{u()},[]),[function(){a(k,!0)},i]};function K(e,t,r,{motionEnter:o=!0,motionAppear:c=!0,motionLeave:u=!0,motionDeadline:l,motionLeaveImmediately:f,onAppearPrepare:m,onEnterPrepare:p,onLeavePrepare:h,onAppearStart:L,onEnterStart:C,onLeaveStart:P,onAppearActive:j,onEnterActive:w,onLeaveActive:O,onAppearEnd:R,onEnterEnd:S,onLeaveEnd:M,onVisibleChanged:T}){const[V,F]=s(),[K,H]=i(d),[U,W]=s(null),q=K(),B=n.useRef(!1),G=n.useRef(null);function J(){return r()}const Q=n.useRef(!1);function X(){H(d),W(null,!0)}const Y=a(e=>{const t=K();if(t===d)return;const n=J();if(e&&!e.deadline&&e.target!==n)return;const r=Q.current;let o;t===v&&r?o=null==R?void 0:R(n,e):t===y&&r?o=null==S?void 0:S(n,e):t===E&&r&&(o=null==M?void 0:M(n,e)),r&&!1!==o&&X()}),[Z]=(e=>{const t=n.useRef();function r(t){t&&(t.removeEventListener(x,e),t.removeEventListener(N,e))}return n.useEffect(()=>()=>{r(t.current),t.current=null},[]),[function(n){t.current&&t.current!==n&&r(t.current),n&&n!==t.current&&(n.addEventListener(x,e),n.addEventListener(N,e),t.current=n)},r]})(Y),$=e=>{switch(e){case v:return{[k]:m,[b]:L,[A]:j};case y:return{[k]:p,[b]:C,[A]:w};case E:return{[k]:h,[b]:P,[A]:O};default:return{}}},ee=n.useMemo(()=>$(q),[q]),[te,ne]=z(q,!e,e=>{var t;if(e===k){const e=ee[k];return e?e(J()):I}return ne in ee&&W((null==(t=ee[ne])?void 0:t.call(ee,J(),null))||null),ne===A&&q!==d&&(Z(J()),l>0&&(clearTimeout(G.current),G.current=setTimeout(()=>{Y({deadline:!0})},l))),ne===g&&X(),true}),re=_(ne);Q.current=re;const oe=n.useRef(null);D(()=>{if(B.current&&oe.current===t)return;F(t);const n=B.current;let r;B.current=!0,!n&&t&&c&&(r=v),n&&t&&o&&(r=y),(n&&!t&&u||!n&&f&&!t&&u)&&(r=E);const s=$(r);r&&(e||s[k])?(H(r),te()):H(d),oe.current=t},[t]),n.useEffect(()=>{(q===v&&!c||q===y&&!o||q===E&&!u)&&H(d)},[c,o,u]),n.useEffect(()=>()=>{B.current=!1,clearTimeout(G.current)},[]);const se=n.useRef(!1);n.useEffect(()=>{V&&(se.current=!0),void 0!==V&&q===d&&((se.current||V)&&(null==T||T(V)),se.current=!0)},[V,q]);let ie=U;return ee[k]&&ne===b&&(ie={transition:"none",...ie}),[K,ne,ie,null!=V?V:t]}const H=function(e){let t=e;"object"==typeof e&&({transitionSupport:t}=e);const r=n.forwardRef((e,r)=>{const{visible:o=!0,removeOnLeave:s=!0,forceRender:i,children:a,motionName:p,leavedClassName:v,eventProps:y}=e,{motion:E}=n.useContext(m),h=function(e,n){return!(!e.motionName||!t||!1===n)}(e,E),A=n.useRef();function L(){return l(A.current)}const[g,C,P,j]=K(h,o,L,e),w=g(),O=n.useRef(j);j&&(O.current=!0);const R=n.useMemo(()=>{const e={};return Object.defineProperties(e,{nativeElement:{enumerable:!0,get:L},inMotion:{enumerable:!0,get:()=>()=>g()!==d},enableMotion:{enumerable:!0,get:()=>()=>h}}),e},[]);let S;n.useImperativeHandle(r,()=>R,[]);const M={...y,visible:o};if(a)if(w===d)S=j?a({...M},A):!s&&O.current&&v?a({...M,className:v},A):i||!s&&!v?a({...M,style:{display:"none"}},A):null;else{let e;C===k?e="prepare":_(C)?e="active":C===b&&(e="start");const t=T(p,"".concat(w,"-").concat(e));S=a({...M,className:f(T(p,w),{[t]:t&&e,[p]:"string"==typeof p}),style:P},A)}else S=null;if(n.isValidElement(S)&&c(S)){u(S)||(S=n.cloneElement(S,{ref:A}))}return S});return r.displayName="CSSMotion",r}(M),U="add",W="keep",q="remove",B="removed";function G(e){let t;return t=e&&"object"==typeof e&&"key"in e?e:{key:e},{...t,key:String(t.key)}}function J(e=[]){return e.map(G)}function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Q.apply(this,arguments)}const X=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];const Y=function(e,r=H){class o extends n.Component{constructor(){super(...arguments),t(this,"state",{keyEntities:[]}),t(this,"removeKey",e=>{this.setState(t=>({keyEntities:t.keyEntities.map(t=>t.key!==e?t:{...t,status:B})}),()=>{const{keyEntities:e}=this.state;0===e.filter(({status:e})=>e!==B).length&&this.props.onAllRemoved&&this.props.onAllRemoved()})})}static getDerivedStateFromProps({keys:e},{keyEntities:t}){const n=J(e),r=function(e=[],t=[]){let n=[],r=0;const o=t.length,s=J(e),i=J(t);s.forEach(e=>{let t=!1;for(let s=r;s<o;s+=1){const o=i[s];if(o.key===e.key){r<s&&(n=n.concat(i.slice(r,s).map(e=>({...e,status:U}))),r=s),n.push({...o,status:W}),r+=1,t=!0;break}}t||n.push({...e,status:q})}),r<o&&(n=n.concat(i.slice(r).map(e=>({...e,status:U}))));const a={};return n.forEach(({key:e})=>{a[e]=(a[e]||0)+1}),Object.keys(a).filter(e=>a[e]>1).forEach(e=>{n=n.filter(({key:t,status:n})=>t!==e||n!==q),n.forEach(t=>{t.key===e&&(t.status=W)})}),n}(t,n);return{keyEntities:r.filter(e=>{const n=t.find(({key:t})=>e.key===t);return!n||n.status!==B||e.status!==q})}}render(){const{keyEntities:e}=this.state,{component:t,children:o,onVisibleChanged:s,onAllRemoved:i,...a}=this.props,c=t||n.Fragment,u={};return X.forEach(e=>{u[e]=a[e],delete a[e]}),delete a.keys,n.createElement(c,a,e.map(({status:e,...t},i)=>{const a=e===U||e===W;return n.createElement(r,Q({},u,{key:t.key,visible:a,eventProps:t,onVisibleChanged:e=>{null==s||s(e,{key:t.key}),e||this.removeKey(t.key)}}),(e,t)=>o({...e,index:i},t))}))}}return t(o,"defaultProps",{component:"div"}),o}();export{H as C,p as M,Y as a};
