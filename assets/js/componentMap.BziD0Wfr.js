import{r as e,j as t}from"./react@19.1.0.Bf1nU3Xp.js";import{l}from"./lodash@4.17.21.B1rlCWCX.js";import{T as a,D as n,r as s,P as r}from"./index.CKK7LeYB.js";import{d as o}from"./dayjs@1.11.13.AZtgMeec.js";import{i,j as u,f as c,k as p,m as d,n as f,I as v,a as m,o as h,C as g,p as y,q as S,r as j,v as b,U as x}from"./antd@5.26.6_react-dom@19.1.0_react@19.1.0__react@19.1.0.BblooLD6.js";import{u as P}from"./react-i18next@15.6.1_i18nex_8494df3c5789a08eaaa9660264635b87.GGzZsTB5.js";function C(e){switch(e){case"Switch":return"checked";case"Upload":return"fileList";default:return"value"}}function w(e,t){switch(t){case"Select":case"TreeSelect":return{allowClear:!0,showSearch:!0,placeholder:e("public.inputPleaseSelect")};case"InputNumber":return{placeholder:e("public.inputPleaseEnter")};case"Checkbox":case"CheckboxGroup":return{};case"DatePicker":return{placeholder:e("public.inputPleaseSelect"),format:n};case"RangePicker":return{placeholder:[e("public.inputPleaseSelect"),e("public.inputPleaseSelect")],format:[n,n]};case"TimePicker":return{placeholder:e("public.inputPleaseSelect"),format:a};case"TimeRangePicker":return{placeholder:[e("public.inputPleaseSelect"),e("public.inputPleaseSelect")],format:[a,a]};default:return{allowClear:!0,placeholder:e("public.inputPleaseEnter")}}}const k=e=>Array.isArray(e)?e:null==e?void 0:e.fileList,D=e=>{var t;const a=l.cloneDeep(e);return delete a.wrapperWidth,delete a.componentProps,delete a.render,a.hidden&&(null==(t=a.rules)?void 0:t.length)&&(a.rules=void 0),"Upload"!==a.component||(null==a?void 0:a.getValueFromEvent)||(a.getValueFromEvent=k),a},T=e=>{const t={};return Object.keys(e).forEach(l=>{var a;"string"==typeof e[l]&&(e[l]=null==(a=e[l])?void 0:a.trim()),""!==e[l]&&(t[l]=e[l])}),t};function A(e){return s.get("/authority/common/games",{params:e})}function N(){return t.jsx("div",{className:"absolute left-50% top-50% -translate-x-1/2 -translate-y-1/2 text-center",children:t.jsx(c,{spinning:!0})})}function R(l){var a;const{t:n}=P(),[s,r]=e.useState(!1),[o,u]=e.useState([]),c={...l};delete c.api,delete c.params,delete c.apiResultKey;const p=e.useCallback(async()=>{if(l.api)try{const{api:e,params:t,apiResultKey:a}=l;if(r(!0),e){const l=Array.isArray(t)?e(...t):e(t),{code:n,data:s}=await l;if(200!==Number(n))return;const r=a?null==s?void 0:s[a]:s;u(r)}}finally{r(!1)}},[l]);e.useEffect(()=>{l.value&&0===o.length&&p()},[l.value]);return t.jsx(i,{allowClear:!0,showSearch:!0,maxTagCount:E,placeholder:n("public.inputPleaseSelect"),optionFilterProp:(null==(a=null==c?void 0:c.fieldNames)?void 0:a.label)||"label",...c,loading:s,options:o,notFoundContent:s&&t.jsx(N,{}),onOpenChange:e=>{var t;e&&p(),null==(t=l.onOpenChange)||t.call(l,e)}})}function F(l){var a;const{t:n}=P(),[s,r]=e.useState(!1),[o,i]=e.useState([]),c={...l};delete c.api,delete c.params,delete c.apiResultKey;const p=e.useCallback(async()=>{if(l.api)try{const{api:e,params:t,apiResultKey:a}=l;if(r(!0),e){const l=Array.isArray(t)?e(...t):e(t),{code:n,data:s}=await l;if(200!==Number(n))return;const r=a?null==s?void 0:s[a]:s;i(r)}}finally{r(!1)}},[l]);e.useEffect(()=>{l.value&&0===(null==o?void 0:o.length)&&p()},[l.value]);return t.jsx(u,{allowClear:!0,showSearch:!0,maxTagCount:E,treeNodeFilterProp:(null==(a=null==c?void 0:c.fieldNames)?void 0:a.label)||"label",placeholder:n("public.inputPleaseSelect"),...c,loading:s,treeData:o,notFoundContent:s&&t.jsx(N,{}),onOpenChange:e=>{var t;e&&p(),null==(t=l.onOpenChange)||t.call(l,e)}})}const E="responsive";function K(e){return t.jsx(t.Fragment,{children:t.jsx(F,{...e,multiple:!0,api:A,fieldNames:{label:"name",value:"id"}})})}function z(e){return s.get("/platform/partner",{params:e})}function O(e,t){return s.get(e,{params:t})}function G(e){return t.jsx(R,{...e,api:z,mode:"multiple",fieldNames:{label:"name",value:"id"}})}function I(e,t=n){return o.isDayjs(e)?e.format(t):e}function _(e){return o.isDayjs(e)?e:o(e)}function U(e,t=n){if(e)return(null==e?void 0:e.length)>1&&o.isDayjs(null==e?void 0:e[0])&&o.isDayjs(null==e?void 0:e[1])?[e[0].format(t),e[1].format(t)]:e}function q(e){if(e)return(null==e?void 0:e.length)>1&&!o.isDayjs(null==e?void 0:e[0])&&o.isDayjs(null==e?void 0:e[1])?[o(e[0]),e[1]]:(null==e?void 0:e.length)>1&&o.isDayjs(null==e?void 0:e[0])&&!o.isDayjs(null==e?void 0:e[1])?[e[0],o(e[1])]:(null==e?void 0:e.length)>1&&!o.isDayjs(null==e?void 0:e[0])&&!o.isDayjs(null==e?void 0:e[1])?[o(e[0]),o(e[1])]:e}function H(e,t){var l;for(let a=0;a<e.length;a++)if(e[a].name===t)return(null==(l=e[a].componentProps)?void 0:l.format)||n;return n}function L(e,t){var l;const a=t.filter(e=>"customize"===e.component).map(e=>e.name);for(const n in e)if(!(null==a?void 0:a.includes(n))){if(2===(null==(l=e[n])?void 0:l.length)&&o.isDayjs(e[n][0])&&o.isDayjs(e[n][1])){const l=H(t,n);e[n]=U(e[n],l)}if((null==e?void 0:e[n])&&o.isDayjs(e[n])){const l=H(t,n);e[n]=I(e[n],l)}}return e}const{RangePicker:V}=p;const{RangePicker:M}=d;const W=new Map;function B(e,l){const{component:a,componentProps:n}=l,s=t.jsx(v,{...w(e,"Input"),...n});if("customize"===a){const{render:e}=l;if(!e)return s;J("customize",e)}const r=W.get(a);return r?t.jsx(t.Fragment,{children:t.jsx(r,{...w(e,a),...n})}):s}function J(e,t){W.set(e,t)}W.set("Input",v),W.set("TextArea",v.TextArea),W.set("InputNumber",m),W.set("InputPassword",v.Password),W.set("AutoComplete",h),W.set("Select",function(l){var a;const{options:n}=l,{t:s}=P(),[r,o]=e.useState([]);return e.useEffect(()=>{if(n){for(let e=0;e<(null==n?void 0:n.length);e++){const t=n[e];"object"!=typeof t&&(n[e]={label:t,value:t})}o(n)}else o([])},[n]),t.jsx(i,{allowClear:!0,showSearch:!0,maxTagCount:E,placeholder:s("public.inputPleaseSelect"),optionFilterProp:(null==(a=null==l?void 0:l.fieldNames)?void 0:a.label)||"label",...l,options:r})}),W.set("TreeSelect",function(l){var a;const{treeData:n}=l,{t:s}=P(),[r,o]=e.useState([]);return e.useEffect(()=>{if(n){for(let e=0;e<(null==n?void 0:n.length);e++){const t=n[e];"object"!=typeof t&&(n[e]={label:t,value:t})}o(n)}else o([])},[n]),t.jsx(u,{allowClear:!0,showSearch:!0,maxTagCount:E,treeNodeFilterProp:(null==(a=null==l?void 0:l.fieldNames)?void 0:a.label)||"label",placeholder:s("public.inputPleaseSelect"),...l,treeData:r})}),W.set("Checkbox",g),W.set("CheckboxGroup",g.Group),W.set("RadioGroup",y.Group),W.set("Switch",S),W.set("Rate",j),W.set("Slider",b),W.set("Upload",x),W.set("Transfer",function(l){const{value:a}=l,[n,s]=e.useState(a||[]);return t.jsx(f,{...l,targetKeys:n,onChange:e=>{var t;s(e),null==(t=null==l?void 0:l.onChange)||t.call(l,e)}})}),W.set("DatePicker",function(e){const{value:l}=e,a={...e};return l&&(a.value=_(l)),t.jsx(p,{...a})}),W.set("RangePicker",function(e){const{value:l}=e,a={...e};return l&&(a.value=q(l)),t.jsx(V,{...a})}),W.set("TimePicker",function(e){const{value:l}=e,a={...e};return l&&(a.value=_(l)),t.jsx(d,{...a})}),W.set("TimeRangePicker",function(e){const{value:l}=e,a={...e};return l&&(a.value=q(l)),t.jsx(M,{...a})}),W.set("ApiSelect",R),W.set("ApiTreeSelect",F),W.set("ApiPageSelect",function(a){var n;const{pageKey:s="page",pageSizeKey:r="pageSize",queryKey:o="query",page:u=1,pageSize:p=20}=a,{t:d}=P(),[f,v]=e.useState(!1),[m,h]=e.useState(u),[g,y]=e.useState(!0),[S,j]=e.useState([]),[b,x]=e.useState(!1),[C,w]=e.useState(""),k={...a};delete k.api,delete k.params,delete k.apiResultKey,delete k.pageKey,delete k.pageSizeKey,e.useEffect(()=>{b&&(x(!1),D())},[b]);const D=e.useCallback(async()=>{if(a.api&&g)try{const{api:e,params:t,apiResultKey:l}=a,n={[s]:m,[r]:p,[o]:C||void 0};if(Array.isArray(t))for(let a=0;a<(null==t?void 0:t.length);a++){const e=t[a];e.constructor===Object&&(t[a]={...e,...n})}if(v(!0),e){const a=Array.isArray(t)?e(...t):e({...t,...n}),{code:s,data:r}=await a;if(200!==Number(s))return;const o=l?null==r?void 0:r[l]:r;if(null==o?void 0:o.length){const e=S.concat(o);j(e)}y(!!(null==o?void 0:o.length))}}finally{v(!1)}},[m,C]);e.useEffect(()=>{a.value&&0===S.length&&D()},[a.value]);const T=e.useCallback(async e=>{const{scrollTop:t,scrollHeight:l,clientHeight:a}=e.currentTarget;t+a>=l-10&&!f&&g&&(h(m+1),x(!0))},[f,g,m]),A=l.debounce(e=>{var t;null==(t=null==a?void 0:a.onSearch)||t.call(a,e),j([]),h(u),y(!0),w(e),x(!0)},200);return t.jsx(i,{allowClear:!0,showSearch:!0,maxTagCount:E,placeholder:d("public.inputPleaseSelect"),optionFilterProp:(null==(n=null==k?void 0:k.fieldNames)?void 0:n.label)||"label",...k,onSearch:A,onPopupScroll:T,popupRender:e=>t.jsxs(t.Fragment,{children:[e,t.jsx("div",{className:"py-3px text-center",children:f&&g&&!!(null==S?void 0:S.length)&&t.jsx(c,{size:"small",spinning:!0})})]}),loading:f,options:S,notFoundContent:f&&t.jsx(N,{}),onOpenChange:e=>{var t;e&&!(null==S?void 0:S.length)&&D(),null==(t=a.onOpenChange)||t.call(a,e)}})}),W.set("PasswordStrength",r),J("GameSelect",K),J("PartnerSelect",G);export{J as a,T as b,B as c,D as d,L as f,O as g,C as h};
