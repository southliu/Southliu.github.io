import{K as e,d as t,p as n}from"./@rc-component_util@1.4.0_re_a8b68d4fbe51b122ded4cf0ecf2ca619.D3_e-sfJ.js";import{c as r}from"./clsx@2.1.1.BvmCeSbq.js";import{e as o,r as l}from"./react@19.2.1.BpVBN_43.js";function a(t,n){const{disabled:l,prefixCls:a,character:c,characterRender:u,index:s,count:f,value:d,allowHalf:i,focused:p,onHover:m,onClick:b}=t,v=s+1,y=new Set([a]);0===d&&0===s&&p?y.add(`${a}-focused`):i&&d+.5>=v&&d<v?(y.add(`${a}-half`),y.add(`${a}-active`),p&&y.add(`${a}-focused`)):(v<=d?y.add(`${a}-full`):y.add(`${a}-zero`),v===d&&p&&y.add(`${a}-focused`));const w="function"==typeof c?c(t):c;let h=o.createElement("li",{className:r(Array.from(y)),ref:n},o.createElement("div",{onClick:l?null:e=>{b(e,s)},onKeyDown:l?null:t=>{t.keyCode===e.ENTER&&b(t,s)},onMouseMove:l?null:e=>{m(e,s)},role:"radio","aria-checked":d>s?"true":"false","aria-posinset":s+1,"aria-setsize":f,tabIndex:l?-1:0},o.createElement("div",{className:`${a}-first`},w),o.createElement("div",{className:`${a}-second`},w)));return u&&(h=u(h,t)),h}const c=o.forwardRef(a);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function s(a,s){const{prefixCls:f="rc-rate",className:d,defaultValue:i,value:p,count:m=5,allowHalf:b=!1,allowClear:v=!0,keyboard:y=!0,character:w="â˜…",characterRender:h,disabled:E,direction:C="ltr",tabIndex:R=0,autoFocus:$,onHoverChange:g,onChange:x,onFocus:H,onBlur:k,onKeyDown:D,onMouseLeave:L,...T}=a,[j,I]=function(){const e=l.useRef({});return[function(t){return e.current[t]},function(t){return n=>{e.current[t]=n}}]}(),N=o.useRef(null),F=()=>{E||N.current?.focus()};o.useImperativeHandle(s,()=>({focus:F,blur:()=>{E||N.current?.blur()}}));const[O,K]=t(i||0,p),[M,B]=t(null),S=(e,t)=>{const n="rtl"===C;let r=e+1;if(b){const o=j(e),l=function(e){const t=function(e){let t,n;const r=e.ownerDocument,{body:o}=r,l=r&&r.documentElement,a=e.getBoundingClientRect();return t=a.left,n=a.top,t-=l.clientLeft||o.clientLeft||0,n-=l.clientTop||o.clientTop||0,{left:t,top:n}}(e),n=e.ownerDocument,r=n.defaultView||n.parentWindow;return t.left+=function(e){let t=e.pageXOffset;const n="scrollLeft";if("number"!=typeof t){const r=e.document;t=r.documentElement[n],"number"!=typeof t&&(t=r.body[n])}return t}(r),t.left}(o),a=o.clientWidth;(n&&t-l>a/2||!n&&t-l<a/2)&&(r-=.5)}return r},X=e=>{K(e),x?.(e)},[_,z]=o.useState(!1),[A,G]=o.useState(null),V=(e,t)=>{const n=S(t,e.pageX);n!==M&&(G(n),B(null)),g?.(n)},W=e=>{E||(G(null),B(null),g?.(void 0)),e&&L?.(e)},P=(e,t)=>{const n=S(t,e.pageX);let r=!1;v&&(r=n===O),W(),X(r?0:n),B(r?n:null)};o.useEffect(()=>{$&&!E&&F()},[]);const q=new Array(m).fill(0).map((e,t)=>o.createElement(c,{ref:I(t),index:t,count:m,disabled:E,prefixCls:`${f}-star`,allowHalf:b,value:null===A?O:A,onClick:P,onHover:V,key:e||t,character:w,characterRender:h,focused:_})),J=r(f,d,{[`${f}-disabled`]:E,[`${f}-rtl`]:"rtl"===C});return o.createElement("ul",u({className:J,onMouseLeave:W,tabIndex:E?-1:R,onFocus:E?null:()=>{z(!0),H?.()},onBlur:E?null:()=>{z(!1),k?.()},onKeyDown:E?null:t=>{const{keyCode:n}=t,r="rtl"===C,o=b?.5:1;y&&(n===e.RIGHT&&O<m&&!r?(X(O+o),t.preventDefault()):n===e.LEFT&&O>0&&!r||n===e.RIGHT&&O>0&&r?(X(O-o),t.preventDefault()):n===e.LEFT&&O<m&&r&&(X(O+o),t.preventDefault())),D?.(t)},ref:N},n(T,{aria:!0,data:!0,attr:!0})),q)}const f=o.forwardRef(s);export{f as R};
