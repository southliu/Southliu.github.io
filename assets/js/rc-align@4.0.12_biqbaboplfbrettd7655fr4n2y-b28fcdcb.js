import{c as H,d as F}from"./@babel_runtime@7.20.1-5f192e20.js";import{R as r}from"./react@18.2.0-52f219d3.js";import{n as N,p as O,j as V,q as D}from"./rc-util@5.24.6_biqbaboplfbrettd7655fr4n2y-e98ccc02.js";import{a as I,b as L}from"./dom-align@1.12.4-7970bd81.js";import{i as S}from"./lodash@4.17.21-29628d20.js";import{i as k}from"./resize-observer-polyfill@1.5.1-1e2b0dc8.js";function G(n,e){return n===e?!0:!n||!e?!1:"pageX"in e&&"pageY"in e?n.pageX===e.pageX&&n.pageY===e.pageY:"clientX"in e&&"clientY"in e?n.clientX===e.clientX&&n.clientY===e.clientY:!1}function J(n,e){n!==document.activeElement&&N(e,n)&&typeof n.focus=="function"&&n.focus()}function M(n,e){var i=null,f=null;function a(g){var b=H(g,1),m=b[0].target;if(!!document.documentElement.contains(m)){var v=m.getBoundingClientRect(),z=v.width,l=v.height,u=Math.floor(z),o=Math.floor(l);(i!==u||f!==o)&&Promise.resolve().then(function(){e({width:u,height:o})}),i=u,f=o}}var c=new k(a);return n&&c.observe(n),function(){c.disconnect()}}const K=function(n,e){var i=r.useRef(!1),f=r.useRef(null);function a(){window.clearTimeout(f.current)}function c(g){if(a(),!i.current||g===!0){if(n()===!1)return;i.current=!0,f.current=window.setTimeout(function(){i.current=!1},e)}else f.current=window.setTimeout(function(){i.current=!1,c()},e)}return[c,function(){i.current=!1,a()}]};function _(n){return typeof n!="function"?null:n()}function C(n){return F(n)!=="object"||!n?null:n}var Q=function(e,i){var f=e.children,a=e.disabled,c=e.target,g=e.align,b=e.onAlign,m=e.monitorWindowResize,v=e.monitorBufferTime,z=v===void 0?0:v,l=r.useRef({}),u=r.useRef(),o=r.Children.only(f),R=r.useRef({});R.current.disabled=a,R.current.target=c,R.current.align=g,R.current.onAlign=b;var $=K(function(){var t=R.current,T=t.disabled,B=t.target,y=t.align,W=t.onAlign;if(!T&&B){var A=u.current,w,E=_(B),P=C(B);l.current.element=E,l.current.point=P,l.current.align=y;var j=document,q=j.activeElement;return E&&D(E)?w=I(A,E,y):P&&(w=L(A,P,y)),J(q,A),W&&w&&W(A,w),!0}return!1},z),X=H($,2),d=X[0],Y=X[1],h=r.useRef({cancel:function(){}}),p=r.useRef({cancel:function(){}});r.useEffect(function(){var t=_(c),T=C(c);u.current!==p.current.element&&(p.current.cancel(),p.current.element=u.current,p.current.cancel=M(u.current,d)),(l.current.element!==t||!G(l.current.point,T)||!S(l.current.align,g))&&(d(),h.current.element!==t&&(h.current.cancel(),h.current.element=t,h.current.cancel=M(t,d)))}),r.useEffect(function(){a?Y():d()},[a]);var s=r.useRef(null);return r.useEffect(function(){m?s.current||(s.current=O(window,"resize",d)):s.current&&(s.current.remove(),s.current=null)},[m]),r.useEffect(function(){return function(){h.current.cancel(),p.current.cancel(),s.current&&s.current.remove(),Y()}},[]),r.useImperativeHandle(i,function(){return{forceAlign:function(){return d(!0)}}}),r.isValidElement(o)&&(o=r.cloneElement(o,{ref:V(o.ref,u)})),o},U=r.forwardRef(Q);U.displayName="Align";export{U as R};
