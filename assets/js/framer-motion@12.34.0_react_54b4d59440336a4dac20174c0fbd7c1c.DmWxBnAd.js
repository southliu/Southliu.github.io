import{r as t,j as n}from"./react@19.2.3.DikTGMTS.js";import{g as e,s as o,i as s,a as i,b as r,c as a,d as l,e as u,f as c,r as h,h as d,j as p,k as m,l as f,m as g,o as v,S as y,H as x,F as P,n as w,p as E,q as S,t as C,u as M,v as A,w as L,x as D,y as T,z as b,A as j,B as I,C as V,D as k,E as R,G as O,I as W,J as F,K as H,L as B,M as G,N as U,O as N,P as q}from"./motion-dom@12.34.0.DGkaOpyQ.js";import{p as X,s as Y,m as _,a as z,c as J,n as K}from"./motion-utils@12.29.2.DDt8zdnb.js";const Z=t.createContext({});const Q="undefined"!=typeof window,$=Q?t.useLayoutEffect:t.useEffect,tt=t.createContext(null),nt=t.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});const et=t.createContext({strict:!1}),ot={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let st=!1;function it(){return function(){if(st)return;const t={};for(const n in ot)t[n]={isEnabled:t=>ot[n].some(n=>!!t[n])};o(t),st=!0}(),e()}const rt=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","propagate","ignoreStrict","viewport"]);function at(t){return t.startsWith("while")||t.startsWith("drag")&&"draggable"!==t||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||rt.has(t)}let lt=t=>!at(t);try{"function"==typeof(ut=require("@emotion/is-prop-valid").default)&&(lt=t=>t.startsWith("on")?!at(t):ut(t))}catch(Pn){}var ut;const ct=t.createContext({});function ht(n){const{initial:e,animate:o}=function(t,n){if(s(t)){const{initial:n,animate:e}=t;return{initial:!1===n||i(n)?n:void 0,animate:i(e)?e:void 0}}return!1!==t.inherit?n:{}}(n,t.useContext(ct));return t.useMemo(()=>({initial:e,animate:o}),[dt(e),dt(o)])}function dt(t){return Array.isArray(t)?t.join(" "):t}const pt=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function mt(t,n,e){for(const o in n)r(n[o])||a(o,e)||(t[o]=n[o])}function ft(n,e){const o={};return mt(o,n.style||{},n),Object.assign(o,function({transformTemplate:n},e){return t.useMemo(()=>{const t={style:{},transform:{},transformOrigin:{},vars:{}};return l(t,e,n),Object.assign({},t.vars,t.style)},[e])}(n,e)),o}function gt(t,n){const e={},o=ft(t,n);return t.drag&&!1!==t.dragListener&&(e.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=!0===t.drag?"none":"pan-".concat("x"===t.drag?"y":"x")),void 0===t.tabIndex&&(t.onTap||t.onTapStart||t.whileTap)&&(e.tabIndex=0),e.style=o,e}const vt=()=>({style:{},transform:{},transformOrigin:{},vars:{},attrs:{}});function yt(n,e,o,s){const i=t.useMemo(()=>{const t={style:{},transform:{},transformOrigin:{},vars:{},attrs:{}};return u(t,e,c(s),n.transformTemplate,n.style),{...t.attrs,style:{...t.style}}},[e]);if(n.style){const t={};mt(t,n.style,n),i.style={...t,...i.style}}return i}const xt=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Pt(t){return"string"==typeof t&&!t.includes("-")&&!!(xt.indexOf(t)>-1||/[A-Z]/u.test(t))}function wt(n,e,o,{latestValues:s},i,a=!1,l){const u=((null!=l?l:Pt(n))?yt:gt)(e,s,i,n),c=function(t,n,e){const o={};for(const s in t)"values"===s&&"object"==typeof t.values||(lt(s)||!0===e&&at(s)||!n&&!at(s)||t.draggable&&s.startsWith("onDrag"))&&(o[s]=t[s]);return o}(e,"string"==typeof n,a),h=n!==t.Fragment?{...c,...u,ref:o}:{},{children:d}=e,p=t.useMemo(()=>r(d)?d.get():d,[d]);return t.createElement(n,{...h,children:p})}function Et(t,n,e,o){const i={},r=o(t,{});for(const s in r)i[s]=h(r[s]);let{initial:a,animate:l}=t;const u=s(t),c=d(t);n&&c&&!u&&!1!==t.inherit&&(void 0===a&&(a=n.initial),void 0===l&&(l=n.animate));let f=!!e&&!1===e.initial;f=f||!1===a;const g=f?l:a;if(g&&"boolean"!=typeof g&&!p(g)){const n=Array.isArray(g)?g:[g];for(let e=0;e<n.length;e++){const o=m(t,n[e]);if(o){const{transitionEnd:t,transition:n,...e}=o;for(const o in e){let t=e[o];if(Array.isArray(t)){t=t[f?t.length-1:0]}null!==t&&(i[o]=t)}for(const o in t)i[o]=t[o]}}}return i}const St=n=>(e,o)=>{const s=t.useContext(ct),i=t.useContext(tt),r=()=>function({scrapeMotionValuesFromProps:t,createRenderState:n},e,o,s){return{latestValues:Et(e,o,s,t),renderState:n()}}(n,e,s,i);return o?r():function(n){const e=t.useRef(null);return null===e.current&&(e.current=n()),e.current}(r)},Ct=St({scrapeMotionValuesFromProps:f,createRenderState:pt}),Mt=St({scrapeMotionValuesFromProps:g,createRenderState:vt}),At=Symbol.for("motionComponentSymbol");function Lt(n,e,o){const s=t.useRef(o);t.useInsertionEffect(()=>{s.current=o});const i=t.useRef(null);return t.useCallback(t=>{var o;t&&(null==(o=n.onMount)||o.call(n,t)),e&&(t?e.mount(t):e.unmount());const r=s.current;if("function"==typeof r)if(t){const n=r(t);"function"==typeof n&&(i.current=n)}else i.current?(i.current(),i.current=null):r(t);else r&&(r.current=t)},[e])}const Dt=t.createContext({});function Tt(t){return t&&"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"current")}function bt(n,e,o,s,i,r){var a,l;const{visualElement:u}=t.useContext(ct),c=t.useContext(et),h=t.useContext(tt),d=t.useContext(nt),p=d.reducedMotion,m=d.skipAnimations,f=t.useRef(null),g=t.useRef(!1);s=s||c.renderer,!f.current&&s&&(f.current=s(n,{visualState:e,parent:u,props:o,presenceContext:h,blockInitialAnimation:!!h&&!1===h.initial,reducedMotionConfig:p,skipAnimations:m,isSVG:r}),g.current&&f.current&&(f.current.manuallyAnimateOnMount=!0));const y=f.current,x=t.useContext(Dt);!y||y.projection||!i||"html"!==y.type&&"svg"!==y.type||function(t,n,e,o){const{layoutId:s,layout:i,drag:r,dragConstraints:a,layoutScroll:l,layoutRoot:u,layoutCrossfade:c}=n;t.projection=new e(t.latestValues,n["data-framer-portal-id"]?void 0:jt(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:Boolean(r)||a&&Tt(a),visualElement:t,animationType:"string"==typeof i?i:"both",initialPromotionConfig:o,crossfade:c,layoutScroll:l,layoutRoot:u})}(f.current,o,i,x);const P=t.useRef(!1);t.useInsertionEffect(()=>{y&&P.current&&y.update(o,h)});const w=o[v],E=t.useRef(Boolean(w)&&!(null==(a=window.MotionHandoffIsComplete)?void 0:a.call(window,w))&&(null==(l=window.MotionHasOptimisedAnimation)?void 0:l.call(window,w)));return $(()=>{g.current=!0,y&&(P.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),y.scheduleRenderMicrotask(),E.current&&y.animationState&&y.animationState.animateChanges())}),t.useEffect(()=>{y&&(!E.current&&y.animationState&&y.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var t;null==(t=window.MotionHandoffMarkAsComplete)||t.call(window,w)}),E.current=!1),y.enteringChildren=void 0)}),y}function jt(t){if(t)return!1!==t.options.allowProjection?t.projection:jt(t.parent)}function It(e,{forwardMotionProps:s=!1,type:i}={},r,a){var l,u;r&&function(t){const n=it();for(const e in t)n[e]={...n[e],...t[e]};o(n)}(r);const c=i?"svg"===i:Pt(e),h=c?Mt:Ct;function d(o,i){let r;const l={...t.useContext(nt),...o,layoutId:Vt(o)},{isStatic:u}=l,d=ht(o),p=h(o,u);if(!u&&Q){t.useContext(et).strict;const n=function(t){const n=it(),{drag:e,layout:o}=n;if(!e&&!o)return{};const s={...e,...o};return{MeasureLayout:(null==e?void 0:e.isEnabled(t))||(null==o?void 0:o.isEnabled(t))?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}(l);r=n.MeasureLayout,d.visualElement=bt(e,p,l,a,n.ProjectionNode,c)}return n.jsxs(ct.Provider,{value:d,children:[r&&d.visualElement?n.jsx(r,{visualElement:d.visualElement,...l}):null,wt(e,o,Lt(p,d.visualElement,i),p,u,s,c)]})}d.displayName="motion.".concat("string"==typeof e?e:"create(".concat(null!=(u=null!=(l=e.displayName)?l:e.name)?u:"",")"));const p=t.forwardRef(d);return p[At]=e,p}function Vt({layoutId:n}){const e=t.useContext(Z).id;return e&&void 0!==n?e+"-"+n:n}function kt(t,n){if("undefined"==typeof Proxy)return It;const e=new Map,o=(e,o)=>It(e,o,t,n);return new Proxy((t,n)=>o(t,n),{get:(s,i)=>"create"===i?o:(e.has(i)||e.set(i,It(i,void 0,t,n)),e.get(i))})}const Rt=(n,e)=>{var o;return(null!=(o=e.isSVG)?o:Pt(n))?new y(e):new x(e,{allowProjection:n!==t.Fragment})};let Ot=0;const Wt={animation:{Feature:class extends P{constructor(t){super(t),t.animationState||(t.animationState=w(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();p(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),null==(t=this.unmountControls)||t.call(this)}}},exit:{Feature:class extends P{constructor(){super(...arguments),this.id=Ot++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:e}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===e)return;const o=this.node.animationState.setActive("exit",!t);n&&!t&&o.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}}};function Ft(t){return{point:{x:t.pageX,y:t.pageY}}}function Ht(t,n,e,o){return S(t,n,(t=>n=>E(n)&&t(n,Ft(n)))(e),o)}const Bt=({current:t})=>t?t.ownerDocument.defaultView:null,Gt=(t,n)=>Math.abs(t-n);const Ut=new Set(["auto","scroll"]);class Nt{constructor(t,n,{transformPagePoint:e,contextWindow:o=window,dragSnapToOrigin:s=!1,distanceThreshold:i=3,element:r}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=t=>{this.handleScroll(t.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const t=Yt(this.lastMoveEventInfo,this.history),n=null!==this.startEvent,e=function(t,n){const e=Gt(t.x,n.x),o=Gt(t.y,n.y);return Math.sqrt(e**2+o**2)}(t.offset,{x:0,y:0})>=this.distanceThreshold;if(!n&&!e)return;const{point:o}=t,{timestamp:s}=C;this.history.push({...o,timestamp:s});const{onStart:i,onMove:r}=this.handlers;n||(i&&i(this.lastMoveEvent,t),this.startEvent=this.lastMoveEvent),r&&r(this.lastMoveEvent,t)},this.handlePointerMove=(t,n)=>{this.lastMoveEvent=t,this.lastMoveEventInfo=qt(n,this.transformPagePoint),M.update(this.updatePoint,!0)},this.handlePointerUp=(t,n)=>{this.end();const{onEnd:e,onSessionEnd:o,resumeAnimation:s}=this.handlers;if(!this.dragSnapToOrigin&&this.startEvent||s&&s(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const i=Yt("pointercancel"===t.type?this.lastMoveEventInfo:qt(n,this.transformPagePoint),this.history);this.startEvent&&e&&e(t,i),o&&o(t,i)},!E(t))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=e,this.distanceThreshold=i,this.contextWindow=o||window;const a=qt(Ft(t),this.transformPagePoint),{point:l}=a,{timestamp:u}=C;this.history=[{...l,timestamp:u}];const{onSessionStart:c}=n;c&&c(t,Yt(a,this.history)),this.removeListeners=X(Ht(this.contextWindow,"pointermove",this.handlePointerMove),Ht(this.contextWindow,"pointerup",this.handlePointerUp),Ht(this.contextWindow,"pointercancel",this.handlePointerUp)),r&&this.startScrollTracking(r)}startScrollTracking(t){let n=t.parentElement;for(;n;){const t=getComputedStyle(n);(Ut.has(t.overflowX)||Ut.has(t.overflowY))&&this.scrollPositions.set(n,{x:n.scrollLeft,y:n.scrollTop}),n=n.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const n=this.scrollPositions.get(t);if(!n)return;const e=t===window,o=e?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},s=o.x-n.x,i=o.y-n.y;0===s&&0===i||(e?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=s,this.lastMoveEventInfo.point.y+=i):this.history.length>0&&(this.history[0].x-=s,this.history[0].y-=i),this.scrollPositions.set(t,o),M.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),A(this.updatePoint)}}function qt(t,n){return n?{point:n(t.point)}:t}function Xt(t,n){return{x:t.x-n.x,y:t.y-n.y}}function Yt({point:t},n){return{point:t,delta:Xt(t,zt(n)),offset:Xt(t,_t(n)),velocity:Jt(n,.1)}}function _t(t){return t[0]}function zt(t){return t[t.length-1]}function Jt(t,n){if(t.length<2)return{x:0,y:0};let e=t.length-1,o=null;const s=zt(t);for(;e>=0&&(o=t[e],!(s.timestamp-o.timestamp>Y(n)));)e--;if(!o)return{x:0,y:0};o===t[0]&&t.length>2&&s.timestamp-o.timestamp>2*Y(n)&&(o=t[1]);const i=_(s.timestamp-o.timestamp);if(0===i)return{x:0,y:0};const r={x:(s.x-o.x)/i,y:(s.y-o.y)/i};return r.x===1/0&&(r.x=0),r.y===1/0&&(r.y=0),r}function Kt(t,n,e){return{min:void 0!==n?t.min+n:void 0,max:void 0!==e?t.max+e-(t.max-t.min):void 0}}function Zt(t,n){let e=n.min-t.min,o=n.max-t.max;return n.max-n.min<t.max-t.min&&([e,o]=[o,e]),{min:e,max:o}}const Qt=.35;function $t(t,n,e){return{min:tn(t,n),max:tn(t,e)}}function tn(t,n){return"number"==typeof t?t:t[n]||0}const nn=new WeakMap;class en{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=T(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:e}={}){const{presenceContext:o}=this.visualElement;if(o&&!1===o.isPresent)return;const{dragSnapToOrigin:s}=this.getProps();this.panSession=new Nt(t,{onSessionStart:t=>{n&&this.snapToCursor(Ft(t).point),this.stopAnimation()},onStart:(t,n)=>{const{drag:e,dragPropagation:o,onDragStart:s}=this.getProps();if(e&&!o&&(this.openDragLock&&this.openDragLock(),this.openDragLock=O(e),!this.openDragLock))return;this.latestPointerEvent=t,this.latestPanInfo=n,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),b(t=>{let n=this.getAxisMotionValue(t).get()||0;if(W.test(n)){const{projection:e}=this.visualElement;if(e&&e.layout){const o=e.layout.layoutBox[t];if(o){n=D(o)*(parseFloat(n)/100)}}}this.originPoint[t]=n}),s&&M.update(()=>s(t,n),!1,!0),k(this.visualElement,"transform");const{animationState:i}=this.visualElement;i&&i.setActive("whileDrag",!0)},onMove:(t,n)=>{this.latestPointerEvent=t,this.latestPanInfo=n;const{dragPropagation:e,dragDirectionLock:o,onDirectionLock:s,onDrag:i}=this.getProps();if(!e&&!this.openDragLock)return;const{offset:r}=n;if(o&&null===this.currentDirection)return this.currentDirection=function(t,n=10){let e=null;Math.abs(t.y)>n?e="y":Math.abs(t.x)>n&&(e="x");return e}(r),void(null!==this.currentDirection&&s&&s(this.currentDirection));this.updateAxis("x",n.point,r),this.updateAxis("y",n.point,r),this.visualElement.render(),i&&M.update(()=>i(t,n),!1,!0)},onSessionEnd:(t,n)=>{this.latestPointerEvent=t,this.latestPanInfo=n,this.stop(t,n),this.latestPointerEvent=null,this.latestPanInfo=null},resumeAnimation:()=>{const{dragSnapToOrigin:t}=this.getProps();(t||this.constraints)&&this.startAnimation({x:0,y:0})}},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:s,distanceThreshold:e,contextWindow:Bt(this.visualElement),element:this.visualElement.current})}stop(t,n){const e=t||this.latestPointerEvent,o=n||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!o||!e)return;const{velocity:i}=o;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&M.postRender(()=>r(e,o))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:e}=this.getProps();!e&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(t,n,e){const{drag:o}=this.getProps();if(!e||!sn(t,o,this.currentDirection))return;const s=this.getAxisMotionValue(t);let i=this.originPoint[t]+e[t];this.constraints&&this.constraints[t]&&(i=function(t,{min:n,max:e},o){return void 0!==n&&t<n?t=o?L(n,t,o.min):Math.max(t,n):void 0!==e&&t>e&&(t=o?L(e,t,o.max):Math.min(t,e)),t}(i,this.constraints[t],this.elastic[t])),s.set(i)}resolveConstraints(){var t;const{dragConstraints:n,dragElastic:e}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null==(t=this.visualElement.projection)?void 0:t.layout,s=this.constraints;n&&Tt(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!n||!o)&&function(t,{top:n,left:e,bottom:o,right:s}){return{x:Kt(t.x,e,s),y:Kt(t.y,n,o)}}(o.layoutBox,n),this.elastic=function(t=Qt){return!1===t?t=0:!0===t&&(t=Qt),{x:$t(t,"left","right"),y:$t(t,"top","bottom")}}(e),s!==this.constraints&&!Tt(n)&&o&&this.constraints&&!this.hasMutatedConstraints&&b(t=>{!1!==this.constraints&&this.getAxisMotionValue(t)&&(this.constraints[t]=function(t,n){const e={};return void 0!==n.min&&(e.min=n.min-t.min),void 0!==n.max&&(e.max=n.max-t.min),e}(o.layoutBox[t],this.constraints[t]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!Tt(t))return!1;const e=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const s=j(e,o.root,this.visualElement.getTransformPagePoint());let i=function(t,n){return{x:Zt(t.x,n.x),y:Zt(t.y,n.y)}}(o.layout.layoutBox,s);if(n){const t=n(I(i));this.hasMutatedConstraints=!!t,t&&(i=V(t))}return i}startAnimation(t){const{drag:n,dragMomentum:e,dragElastic:o,dragTransition:s,dragSnapToOrigin:i,onDragTransitionEnd:r}=this.getProps(),a=this.constraints||{},l=b(r=>{if(!sn(r,n,this.currentDirection))return;let l=a&&a[r]||{};i&&(l={min:0,max:0});const u=o?200:1e6,c=o?40:1e7,h={type:"inertia",velocity:e?t[r]:0,bounceStiffness:u,bounceDamping:c,timeConstant:750,restDelta:1,restSpeed:10,...s,...l};return this.startAxisValueAnimation(r,h)});return Promise.all(l).then(r)}startAxisValueAnimation(t,n){const e=this.getAxisMotionValue(t);return k(this.visualElement,t),e.start(R(t,e,0,n,this.visualElement,!1))}stopAnimation(){b(t=>this.getAxisMotionValue(t).stop())}getAxisMotionValue(t){const n="_drag".concat(t.toUpperCase()),e=this.visualElement.getProps(),o=e[n];return o||this.visualElement.getValue(t,(e.initial?e.initial[t]:void 0)||0)}snapToCursor(t){b(n=>{const{drag:e}=this.getProps();if(!sn(n,e,this.currentDirection))return;const{projection:o}=this.visualElement,s=this.getAxisMotionValue(n);if(o&&o.layout){const{min:e,max:i}=o.layout.layoutBox[n],r=s.get()||0;s.set(t[n]-L(e,i,.5)+r)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:e}=this.visualElement;if(!Tt(n)||!e||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};b(t=>{const n=this.getAxisMotionValue(t);if(n&&!1!==this.constraints){const e=n.get();o[t]=function(t,n){let e=.5;const o=D(t),s=D(n);return s>o?e=z(n.min,n.max-o,t.min):o>s&&(e=z(t.min,t.max-s,n.min)),J(0,1,e)}({min:e,max:e},this.constraints[t])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",e.root&&e.root.updateScroll(),e.updateLayout(),this.constraints=!1,this.resolveConstraints(),b(n=>{if(!sn(n,t,null))return;const e=this.getAxisMotionValue(n),{min:s,max:i}=this.constraints[n];e.set(L(s,i,o[n]))}),this.visualElement.render()}addListeners(){if(!this.visualElement.current)return;nn.set(this.visualElement,this);const t=this.visualElement.current,n=Ht(t,"pointerdown",n=>{const{drag:e,dragListener:o=!0}=this.getProps(),s=n.target,i=s!==t&&H(s);e&&o&&!i&&this.start(n)});let e;const o=()=>{const{dragConstraints:n}=this.getProps();Tt(n)&&n.current&&(this.constraints=this.resolveRefConstraints(),e||(e=function(t,n,e){const o=F(t,on(e)),s=F(n,on(e));return()=>{o(),s()}}(t,n.current,()=>this.scalePositionWithinConstraints())))},{projection:s}=this.visualElement,i=s.addEventListener("measure",o);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),M.read(o);const r=S(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:t,hasLayoutChanged:n})=>{this.isDragging&&n&&(b(n=>{const e=this.getAxisMotionValue(n);e&&(this.originPoint[n]+=t[n].translate,e.set(e.get()+t[n].translate))}),this.visualElement.render())});return()=>{r(),n(),i(),a&&a(),e&&e()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:e=!1,dragPropagation:o=!1,dragConstraints:s=!1,dragElastic:i=Qt,dragMomentum:r=!0}=t;return{...t,drag:n,dragDirectionLock:e,dragPropagation:o,dragConstraints:s,dragElastic:i,dragMomentum:r}}}function on(t){let n=!0;return()=>{n?n=!1:t()}}function sn(t,n,e){return!(!0!==n&&n!==t||null!==e&&e!==t)}const rn=t=>(n,e)=>{t&&M.update(()=>t(n,e),!1,!0)};let an=!1;class ln extends t.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:e,layoutId:o}=this.props,{projection:s}=t;s&&(n.group&&n.group.add(s),e&&e.register&&o&&e.register(s),an&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),B.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:e,drag:o,isPresent:s}=this.props,{projection:i}=e;return i?(i.isPresent=s,t.layoutDependency!==n&&i.setOptions({...i.options,layoutDependency:n}),an=!0,o||t.layoutDependency!==n||void 0===n||t.isPresent!==s?i.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?i.promote():i.relegate()||M.postRender(()=>{const t=i.getStack();t&&t.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),G.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:e}=this.props,{projection:o}=t;an=!0,o&&(o.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(o),e&&e.deregister&&e.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function un(e){const[o,s]=function(n=!0){const e=t.useContext(tt);if(null===e)return[!0,null];const{isPresent:o,onExitComplete:s,register:i}=e,r=t.useId();t.useEffect(()=>{if(n)return i(r)},[n]);const a=t.useCallback(()=>n&&s&&s(r),[r,s,n]);return!o&&s?[!1,a]:[!0]}(),i=t.useContext(Z);return n.jsx(ln,{...e,layoutGroup:i,switchLayoutGroup:t.useContext(Dt),isPresent:o,safeToRemove:s})}const cn={pan:{Feature:class extends P{constructor(){super(...arguments),this.removePointerDownListener=K}onPointerDown(t){this.session=new Nt(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Bt(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:e,onPanEnd:o}=this.node.getProps();return{onSessionStart:rn(t),onStart:rn(n),onMove:rn(e),onEnd:(t,n)=>{delete this.session,o&&M.postRender(()=>o(t,n))}}}mount(){this.removePointerDownListener=Ht(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends P{constructor(t){super(t),this.removeGroupControls=K,this.removeListeners=K,this.controls=new en(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||K}update(){const{dragControls:t}=this.node.getProps(),{dragControls:n}=this.node.prevProps||{};t!==n&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}},ProjectionNode:U,MeasureLayout:un}};function hn(t,n,e){const{props:o}=t;t.animationState&&o.whileHover&&t.animationState.setActive("whileHover","Start"===e);const s=o["onHover"+e];s&&M.postRender(()=>s(n,Ft(n)))}function dn(t,n,e){const{props:o}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&o.whileTap&&t.animationState.setActive("whileTap","Start"===e);const s=o["onTap"+("End"===e?"":e)];s&&M.postRender(()=>s(n,Ft(n)))}const pn=new WeakMap,mn=new WeakMap,fn=t=>{const n=pn.get(t.target);n&&n(t)},gn=t=>{t.forEach(fn)};function vn(t,n,e){const o=function({root:t,...n}){const e=t||document;mn.has(e)||mn.set(e,{});const o=mn.get(e),s=JSON.stringify(n);return o[s]||(o[s]=new IntersectionObserver(gn,{root:t,...n})),o[s]}(n);return pn.set(t,e),o.observe(t),()=>{pn.delete(t),o.unobserve(t)}}const yn={some:0,all:1};const xn=kt({...Wt,...{inView:{Feature:class extends P{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:e,amount:o="some",once:s}=t,i={root:n?n.current:void 0,rootMargin:e,threshold:"number"==typeof o?o:yn[o]};return vn(this.node.current,i,t=>{const{isIntersecting:n}=t;if(this.isInView===n)return;if(this.isInView=n,s&&!n&&this.hasEnteredView)return;n&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",n);const{onViewportEnter:e,onViewportLeave:o}=this.node.getProps(),i=n?e:o;i&&i(t)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(function({viewport:t={}},{viewport:n={}}={}){return e=>t[e]!==n[e]}(t,n))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends P{mount(){const{current:t}=this.node;if(!t)return;const{globalTapTarget:n,propagate:e}=this.node.props;this.unmount=q(t,(t,n)=>(dn(this.node,n,"Start"),(t,{success:n})=>dn(this.node,t,n?"End":"Cancel")),{useGlobalTarget:n,stopPropagation:!1===(null==e?void 0:e.tap)})}unmount(){}}},focus:{Feature:class extends P{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch(Pn){t=!0}t&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=X(S(this.node.current,"focus",()=>this.onFocus()),S(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends P{mount(){const{current:t}=this.node;t&&(this.unmount=N(t,(t,n)=>(hn(this.node,n,"Start"),t=>hn(this.node,t,"End"))))}unmount(){}}}},...cn,...{layout:{ProjectionNode:U,MeasureLayout:un}}},Rt);export{xn as m};
