import{o as e}from"./@babel_runtime@7.28.3.ESkOsrAB.js";import{r as t,a as r,b as n,c as o,d as a,e as c,f as u,g as i,h as s,i as l,j as p,k as f,l as d,m as h,n as v,o as y}from"./szfe-tools@0.0.0-beta.7.NDKJABvB.js";import{a as m}from"./react@19.1.1.osUeTYwR.js";import{b as g}from"./react-dom@19.1.1_react@19.1.1.Bn0b59nT.js";import{r as w}from"./hoist-non-react-statics@3.3.2.AL5xWxxn.js";import{r as b}from"./react-node-key@0.4.0_react@19.1.1.D7tDbVk-.js";var k,S,E={exports:{}},C={exports:{}};function O(){return k||(k=1,function(e,t,r,n,o,a,c,u,i,s,l,p,f,d,h,v,y,m,g,w,b){t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var k="default"in a?a.default:a;function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function E(e){if(Array.isArray(e))return e}function C(e,t,r){return t=B(t),T(e,A()?Reflect.construct(t,r||[],B(e).constructor):t.apply(e,r))}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V(n.key),n)}}function _(e,t,r){return t&&P(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function x(e,t,r){return(t=V(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(){return(j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)!{}.hasOwnProperty.call(n,r)||(e[r]=n[r])}return e}).apply(null,arguments)}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}function A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(A=function(){return!!e})()}function N(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function R(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function U(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)),n}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach(function(t){x(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function D(e,t){if(null==e)return{};var r,n=((e,t)=>{if(null==e)return{};var r,n={};for(r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n})(e,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(e),a=0;a<o.length;a++)r=o[a],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}function T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(t=e))throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z(e,t){return(z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function L(e,t){return E(e)||((e,t)=>{var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,c,u=[],i=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;i=!1}else for(;!(i=(n=a.call(r)).done)&&(u.push(n.value),u.length!==t);i=!0);}catch(l){s=!0,o=l}finally{try{if(!i&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(s)throw o}}return u}})(e,t)||F(e,t)||R()}function M(e){return E(e)||N(e)||F(e)||R()}function W(e){return(e=>{if(Array.isArray(e))return S(e)})(e)||N(e)||F(e)||(()=>{throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function V(e){return"symbol"==typeof(e=((e,t)=>{if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!=typeof(r=r.call(e,t)))return r;throw new TypeError("@@toPrimitive must return a primitive value.")})(e,"string"))?e:e+""}function F(e,t){var r;if(e)return"string"==typeof e?S(e,t):"Map"===(r="Object"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,v=v&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,w=w&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w,b=b&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b;var K=1073741823;function q(){var e,t,r;return c(a.useContext)?a.useContext(J)||(t=(e=L(a.useState(ne.currentContextValue),2))[0],r=e[1],a.useEffect(function(){var e=o(r);return re.on("update",e),function(){return re.off("update",e)}},[]),t):{}}function H(e){var t=e.children;return e=D(e,ae),k.createElement(Q,j({},e,{_nk:"".concat(ce,"11")}),k.createElement(ne,j({},e,{_nk:"".concat(ce,"21")}),t))}function X(e){var t=e.children;return k.createElement(Y,{_nk:"".concat(ce,"31")},function(e){return e?n(t,void 0,e):k.createElement(oe,{_nk:"".concat(ce,"41")},t)})}var G=k.createContext||function(e,t){var r="__create-react-context-"+u()+"__";return{Provider:(()=>{function e(){var t;O(this,e);for(var r,n,o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return x(t=C(this,e,[].concat(a)),"emitter",(r=t.props.value,n=[],{on:function(e){n.push(e)},off:function(e){n=n.filter(function(t){return t!==e})},get:function(){return r},set:function(e,t){r=e,n.forEach(function(e){return e(r,t)})}})),t}return I(e,a.Component),_(e,[{key:"getChildContext",value:function(){return x({},r,this.emitter)}},{key:"componentWillReceiveProps",value:function(e){var r,n;this.props.value!==e.value&&(n=this.props.value,r=e.value,n="function"==typeof t?t(n,r):K,0!=(n|=0))&&this.emitter.set(e.value,n)}},{key:"render",value:function(){return this.props.children}}])})(),Consumer:(()=>{function t(){var e;O(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return x(e=C(this,t,[].concat(n)),"observedBits",void 0),x(e,"state",{value:e.getValue()}),x(e,"onUpdate",function(t,r){(0|e.observedBits)&r&&e.setState({value:e.getValue()})}),e}return I(t,a.Component),_(t,[{key:"componentWillReceiveProps",value:function(e){e=e.observedBits,this.observedBits=null==e?K:e}},{key:"componentDidMount",value:function(){this.context[r]&&this.context[r].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=null==e?K:e}},{key:"componentWillUnmount",value:function(){this.context[r]&&this.context[r].off(this.onUpdate)}},{key:"getValue",value:function(){return this.context[r]?this.context[r].get():e}},{key:"render",value:function(){return e=this.props.children,(Array.isArray(e)?e[0]:e)(this.state.value);var e}}])})()}},J=G(),Q=J.Provider,Y=J.Consumer,Z=G(),ee=Z.Provider,te=Z.Consumer,re=new i,ne=(()=>{function e(t){var r;return O(this,e),r=C(this,e,[t]),e.currentContextValue=t.value,r}return I(e,a.Component),_(e,[{key:"shouldComponentUpdate",value:function(t){return t.value!==this.props.value&&(e.currentContextValue=t.value,re.emit("update",t.value)),t.children!==this.props.children||t.value!==this.props.value}},{key:"render",value:function(){return this.props.children}}])})(),oe=(x(ne,"eventBus",re),x(ne,"currentContextValue",void 0),(()=>{function e(t){var r;return O(this,e),x(r=C(this,e,[t]),"state",{context:ne.currentContextValue}),x(r,"updateListener",o(function(e){r.setState({context:e})})),re.on("update",r.updateListener),r}return I(e,a.PureComponent),_(e,[{key:"componentWillUnmount",value:function(){re.off("update",this.updateListener)}},{key:"render",value:function(){var e=this.props.children,t=this.state.context;return n(e,void 0,t)}}])})()),ae=["children"],ce="qj9A",ue=(()=>{function e(){var t;O(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return x(t=C(this,e,[].concat(n)),"promiseCache",{}),t}return I(e,a.Component),_(e,[{key:"render",value:function(){var e=(t=this.props).freeze,t=t.children,r=this.promiseCache;if(e&&!r.promise)throw r.promise=new Promise(function(e){r.resolve=e}),r.promise;if(e)throw r.promise;return r.promise&&(r.resolve(),r.promise=void 0),k.createElement(a.Fragment,null,t)}}])})();function ie(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(e){var t=(e=M(e))[0];e.slice(1).forEach(function(e){var n;c(r(t,e))&&!r(t,[e,"_overridden"])&&(n=t[e].bind(t),t[e]=function(e){p(e)||he(e);for(var t=arguments.length,r=new Array(1<t?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return n.apply(void 0,[e].concat(r))},t[e]._overridden=!0)})})}catch(o){}}function se(e){return e=e.children,n(e)}var le=[],pe=new Map,fe=new i,de=d(function(e){f(e)&&![J,Z].includes(e)&&(f(e.Consumer)||(e.Consumer=function(t){t=t.children;var r=n(a.useContext,void 0,e);return k.createElement(a.Fragment,null,n(t,void 0,r))}),le.push(e),setTimeout(function(){return fe.emit("update")}))}),he=d(function(e){e=r(e,"_context")||r(e,"context"),r(e,"$$typeof")===r(J,"$$typeof")&&de(e)}),ve=(ie([k,"createElement"]),(()=>{function e(t){var r,n;return O(this,e),x(r=C(this,e,[t]),"unmount",null),0===(t=t.value).length?(r.state={ctxValue:null},T(r)):((t=L(t,1)[0]).ctx,n=t.onUpdate,r.state={ctxValue:t.value},r.unmount=n(function(e){r.setState({ctxValue:e})}),r)}return I(e,a.PureComponent),_(e,[{key:"componentWillUnmount",value:function(){n(this.unmount)}},{key:"render",value:function(){var t,r,n=(o=this.props).value,o=o.children;return 0===(n=n.filter(Boolean)).length?o:(t=this.state.ctxValue,r=(n=M(n))[0].ctx,n=n.slice(1),r=r.Provider,r=h(t)?o:k.createElement(r,{value:t,_nk:"".concat("lqEk","11")},o),0<n.length?k.createElement(e,{value:n,_nk:"".concat("lqEk","21")},r):r)}}])})()),ye=(()=>{function e(t){O(this,e),x(o=C(this,e,[t]),"updateListener",null),x(o,"ctxInfo",null);var o,a=t.value,c=t.ctx;return t=t.id,h(a)?T(o):(o.updateListener=r(pe.get(c),t,new Map),n(o.updateListener,"forEach",function(e){return e(a)}),o.ctxInfo={ctx:c,value:a,onUpdate:function(e){return o.updateListener.set(e,e),function(){return o.updateListener.delete(e)}}},o)}return I(e,a.Component),_(e,[{key:"componentWillUnmount",value:function(){var e=(n=this.props).value,t=n.ctx,n=n.id;h(e)||pe.set(t,$($({},r(pe.get(t),void 0,{})),{},x({},n,this.updateListener)))}},{key:"shouldComponentUpdate",value:function(e){var t=e.value;return this.props.value!==t&&n(this.updateListener,"forEach",function(e){return e(t)}),!0}},{key:"render",value:function(){var e=this,t=this.props,r=t.value,n=t.renderWrapper,o=t.renderContent;return n(function(t){return o(h(r)?t:[].concat(W(t),[e.ctxInfo]))})}}])})(),me={},ge=(()=>{function e(t){var r;return O(this,e),x(r=C(this,e,[t]),"renderWrapper",function(e){var t=r.props.id;return me[t].reduce(function(e,r){var n=r.Consumer;return function(o){return k.createElement(n,{_nk:"".concat("SsUr","11")},function(n){return k.createElement(ye,{value:n,ctx:r,renderWrapper:e,renderContent:o,id:t,_nk:"".concat("SsUr","21")})})}},function(e){return e([])})(e)}),t=t.id,me[t]||(me[t]=W(le).filter(function(e){return f(e.Consumer)})),r}return I(e,a.PureComponent),_(e,[{key:"render",value:function(){var e=this.props.children;return this.renderWrapper(e)}}])})(),we="46lG",be=(d=c(a.lazy)&&!h(a.Suspense))?a.lazy(function(){return new Promise(function(){return null})}):function(){return null},ke=(()=>{function e(){return O(this,e),C(this,e,arguments)}return I(e,a.Component),_(e,[{key:"componentDidMount",value:function(){n(this.props,"onStart")}},{key:"componentWillUnmount",value:function(){n(this.props,"onEnd")}},{key:"render",value:function(){return null}}])})(),Se=d?(()=>{function e(){var t;O(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return x(t=C(this,e,[].concat(n)),"state",{suspense:!1}),x(t,"onSuspenseStart",function(){t.setState({suspense:!0})}),x(t,"onSuspenseEnd",function(){t.setState({suspense:!1})}),x(t,"sus$$",{onSuspenseStart:t.onSuspenseStart,onSuspenseEnd:t.onSuspenseEnd}),t}return I(e,a.Component),_(e,[{key:"render",value:function(){var e=this.props.children;return k.createElement(a.Fragment,null,n(e,void 0,this.sus$$),this.state.suspense&&k.createElement(be,{_nk:"".concat(we,"31")}))}}])})():se,Ee=d?function(e){var t=e.children;return e=e.sus$$,k.createElement(a.Suspense,{fallback:k.createElement(ke,{onStart:e.onSuspenseStart,onEnd:e.onSuspenseEnd,_nk:"".concat(we,"21")}),_nk:"".concat(we,"11")},t)}:se,Ce=(()=>{function e(){return O(this,e),C(this,e,arguments)}return I(e,a.Component),_(e,[{key:"componentDidCatch",value:function(e){var t=this.props.error$$;n(t,void 0,e,function(){n(t,void 0,null)})}},{key:"render",value:function(){return this.props.children}}])})(),Oe=(x(Ce,"getDerivedStateFromError",function(){return null}),(()=>{function e(){var t;O(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return x(t=C(this,e,[].concat(n)),"state",{error:null}),x(t,"throwError",function(e,r){return t.setState({error:e},r)}),t}return I(e,a.Component),_(e,[{key:"render",value:function(){if(this.state.error)throw this.state.error;return n(this.props.children,void 0,this.throwError)}}])})()),Pe="lajT";function _e(e){var t=e.id,r=e.children,n=(e=e.bridgeProps).sus$$,o=e.ctx$$;return k.createElement(Ce,{error$$:e.error$$,_nk:"".concat(Pe,"11")},k.createElement(Ee,{sus$$:n,_nk:"".concat(Pe,"21")},k.createElement(ve,{id:t,value:o,_nk:"".concat(Pe,"31")},r)))}function xe(e){var t=e.id,r=e.children;return k.createElement(Oe,{_nk:"".concat(Pe,"41")},function(e){return k.createElement(Se,{_nk:"".concat(Pe,"51")},function(o){return k.createElement(ge,{id:t,_nk:"".concat(Pe,"61")},function(t){return n(r,void 0,{bridgeProps:{sus$$:o,ctx$$:t,error$$:e}})})})})}function je(e){var t=(()=>{function t(){var e;O(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return x(e=C(this,t,[].concat(n)),"drop",null),e}return I(t,a.Component),_(t,[{key:"componentWillUnmount",value:function(){n(this.drop)}},{key:"render",value:function(){var t=this,o=this.props,a=o.forwardedRef,u=D(o,Ie);return k.createElement(te,{_nk:"".concat(Ae,"11")},function(){var o=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).attach;return k.createElement(e,j({ref:function(e){[Ne,Re].every(function(t){return!c(r(e,t))})||(t.drop=n(o,void 0,e),h(a))||(v(a)&&"current"in a?a.current=e:n(a,void 0,e))}},u,{_nk:"".concat(Ae,"21")}))})}}])})();return c(e.prototype.componentDidMount)&&(e.prototype._componentDidMount=e.prototype.componentDidMount,e.prototype.componentDidMount=function(){var t=this;s(function(){return e.prototype._componentDidMount.call(t)})}),c(a.forwardRef)?y(a.forwardRef(function(e,r){return k.createElement(t,j({},e,{forwardedRef:r,_nk:"".concat(Ae,"31")}))}),e):y(t,e)}function Be(e,t){var r,o;[a.useRef,a.useContext,a.useEffect].some(function(e){return!c(e)})||(o=a.useContext(Z))&&(r=a.useRef({}).current,o=o.attach,r[e]=t,r.drop=o(r),a.useEffect(function(){return function(){return n(r.drop)}},[]))}var Ie=["forwardedRef"],Ae="XKTv",Ne="componentDidActivate",Re="componentWillUnactivate",Ue=(d=Be.bind(null,Ne),Be.bind(null,Re)),$e=["id","autoFreeze","contentProps"],De="bNyU",Te=a.Suspense?function(e){var t=e.freeze,r=e.children;return e=e.placeholder,k.createElement(a.Suspense,{fallback:void 0===e?null:e,_nk:"".concat("Leb+","11")},k.createElement(ue,{freeze:t,_nk:"".concat("Leb+","21")},r))}:function(e){return e.children},ze=(()=>{function e(t){var o;O(this,e);for(var a=arguments.length,c=new Array(1<a?a-1:0),u=1;u<a;u++)c[u-1]=arguments[u];return x(o=C(this,e,[t].concat(c)),"eventBus",new i),x(o,"listeners",new Map),x(o,"wrapper",null),x(o,"cache",void 0),x(o,"unmounted",!1),x(o,"safeSetState",function(e,t){o.unmounted||o.setState(e,t)}),x(o,"freezeTimeout",null),x(o,"attach",function(e){var t=o.listeners;return e?(e.isKeepAlive&&s(function(){var t,r=(t=o.props).id;(t=t.store.get(r)).aliveNodesId=new Set([].concat(W(t.aliveNodesId),[e.id]))}),t.set(e,x(x({},Ne,function(){return n(e,Ne)}),Re,function(){return n(e,Re)})),function(){t.delete(e)}):function(){return null}}),x(o,"contextValue",{id:o.props.id,attach:o.attach}),x(o,"drop",function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=void 0===(e=t.delay)?1200:e,a=void 0===(e=t.refreshIfDropFailed)||e;return new Promise(function(e){var t,c=o.props,u=c.scope,i=c.id,s=function(){clearTimeout(t),o.eventBus.off(Re,s),o.cache.willDrop=!0,u.nodes.delete(i),u.helpers=$({},u.helpers),u.smartForceUpdate(function(){return e(!0)})};r(o.cache,"cached")||r(o.cache,"willDrop")?s():(o.eventBus.on(Re,s),t=setTimeout(function(){o.eventBus.off(Re,s),a?o.refresh().then(function(t){return e(t)}):e(!1)},n))})}),x(o,"refresh",function(){return new Promise(function(e){r(o.cache,"cached")&&e(!1),o.safeSetState({key:Math.random()},function(){return e(!0)})})}),o.state={children:t.children,bridgeProps:t.bridgeProps,key:Math.random(),freeze:!1},o}return I(e,a.PureComponent),_(e,[{key:"componentDidMount",value:function(){var e,t=this,r=(n=this.props).store,n=n.id,o=this.listeners,a=this.wrapper;if(!r.has(n)){try{e=W(a.children)}catch(c){e=[a.children]}this.cache=x(x({listeners:o,aliveNodesId:[],inited:!1,cached:!1,wrapper:a,nodes:e},Ne,function(){return t[Ne]()}),Re,function(){return t[Re]()}),r.set(n,this.cache)}}},{key:"componentWillUnmount",value:function(){var e=(r=this.props).store,t=r.keepers,r=r.id;try{var n=e.get(r);n.nodes.forEach(function(e){n.wrapper.appendChild(e)})}catch(o){}e.delete(r),t.delete(r),this.unmounted=!0}},{key:Ne,value:function(){clearTimeout(this.freezeTimeout),this.safeSetState({freeze:!1}),this.eventBus.emit(Ne),this.listeners.forEach(function(e){return n(e,[Ne])})}},{key:Re,value:function(){var e=this;this.eventBus.emit(Re),W(this.listeners).reverse().forEach(function(e){return e=L(e,2)[1],n(e,[Re])}),clearTimeout(this.freezeTimeout),this.freezeTimeout=setTimeout(function(){l.flushSync(function(){e.safeSetState({freeze:!0})})},1e3)}},{key:"render",value:function(){var e,t=this,r=(e=this.props).id,n=void 0===(n=e.autoFreeze)||n,o=void 0===(o=e.contentProps)?{}:o,a=(D(e,$e),e=this.state).children,c=e.bridgeProps,u=e.key;return k.createElement(Te,{freeze:n&&e.freeze,_nk:"".concat(De,"11")},k.createElement("div",{ref:function(e){t.wrapper=e},_nk:"".concat(De,"21")},k.createElement("div",j({},o,{key:"keeper-container",className:"ka-content ".concat(o.className||"")}),k.createElement(_e,{id:r,bridgeProps:c,_nk:"".concat(De,"31")},k.createElement(ee,{value:this.contextValue,_nk:"".concat(De,"41")},k.Children.map(a,function(e,t){return k.cloneElement(e,{key:"".concat(e.key||"",":").concat(u,":").concat(t)})}))))))}}])})(),Le=["children"],Me="UVSV",We="drop",Ve="refresh",Fe=(()=>{function e(){var a;O(this,e);for(var c=arguments.length,u=new Array(c),i=0;i<c;i++)u[i]=arguments[i];return x(a=C(this,e,[].concat(u)),"store",new Map),x(a,"nodes",new Map),x(a,"keepers",new Map),x(a,"debouncedForceUpdate",o(function(e){return a.forceUpdate(e)})),x(a,"updateCallbackList",[]),x(a,"smartForceUpdate",function(e){a.updateCallbackList.push(e),a.debouncedForceUpdate(function(){a.updateCallbackList.forEach(function(e){return n(e)}),a.updateCallbackList=[]})}),x(a,"update",function(e,t){return new Promise(function(r){var n=a.keepers.get(e),o=!n,c=Date.now(),u=a.nodes.get(e)||null;a.nodes.set(e,$($({id:e,createTime:c,updateTime:c},u),t)),o?(a.helpers=$({},a.helpers),a.forceUpdate(r)):(c=t.children,n.setState({children:c,bridgeProps:t.bridgeProps},r))})}),x(a,"keep",function(e,t){return new Promise(function(r){a.update(e,$({id:e},t)).then(function(){r(a.store.get(e))})})}),x(a,"getCachingNodesByName",function(e){return a.getCachingNodes().filter(function(t){return e instanceof RegExp?e.test(t.name):t.name===e})}),x(a,"getScopeIds",function(e){var n=function(e){var t=r(a.getCache(e),"aliveNodesId",[]);return 0<t.size?[e,W(t).map(n)]:[e].concat(W(t))};return t(e.map(function(e){return n(e)}))}),x(a,"dropById",function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return a.handleNodes.apply(a,[[e],We].concat(r))}),x(a,"dropScopeByIds",function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return a.handleNodes.apply(a,[a.getScopeIds(e),We].concat(r))}),x(a,"drop",function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return a.handleNodes.apply(a,[a.getCachingNodesByName(e).map(function(e){return e.id}),We].concat(r))}),x(a,"dropScope",function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return a.dropScopeByIds.apply(a,[a.getCachingNodesByName(e).map(function(e){return e.id})].concat(r))}),x(a,"refreshById",function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return a.handleNodes.apply(a,[[e],Ve].concat(r))}),x(a,"refreshScopeByIds",function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return a.handleNodes.apply(a,[a.getScopeIds(e),Ve].concat(r))}),x(a,"refresh",function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return a.handleNodes.apply(a,[a.getCachingNodesByName(e).map(function(e){return e.id}),Ve].concat(r))}),x(a,"refreshScope",function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return a.refreshScopeByIds.apply(a,[a.getCachingNodesByName(e).map(function(e){return e.id})].concat(r))}),x(a,"handleNodes",function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:We,r=arguments.length,o=new Array(2<r?r-2:0),c=2;c<r;c++)o[c-2]=arguments[c];return new Promise(function(r){var c=[];e.forEach(function(e){a.store.get(e)&&(e=a.keepers.get(e),c.push(e))}),0===c.length?r(!1):Promise.all(c.map(function(e){return n.apply(void 0,[e,t].concat(o))})).then(function(e){return r(e.every(Boolean))})})}),x(a,"clear",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return a.handleNodes.apply(a,[a.getCachingNodes().map(function(e){return e.id}),We].concat(t))}),x(a,"getCache",function(e){return a.store.get(e)}),x(a,"getNode",function(e){return a.nodes.get(e)}),x(a,"getCachingNodes",function(){return W(a.nodes.values())}),x(a,"helpers",{keep:a.keep,update:a.update,drop:a.drop,dropScope:a.dropScope,dropById:a.dropById,dropScopeByIds:a.dropScopeByIds,refresh:a.refresh,refreshScope:a.refreshScope,refreshById:a.refreshById,refreshScopeByIds:a.refreshScopeByIds,getScopeIds:a.getScopeIds,clear:a.clear,getCache:a.getCache,getNode:a.getNode,getCachingNodes:a.getCachingNodes}),a}return I(e,a.Component),_(e,[{key:"render",value:function(){var e=this,t=void 0===(t=this.props.children)?null:t;return k.createElement(H,{value:this.helpers,_nk:"".concat(Me,"11")},t,k.createElement("div",{style:{display:"none"},_nk:"".concat(Me,"21")},W(this.nodes.values()).map(function(t){var r=t.children,n=D(t,Le);return k.createElement(ze,j({key:n.id},n,{scope:e,store:e.store,keepers:e.keepers,ref:function(t){e.keepers.set(n.id,t)},_nk:"iAr".concat(Me,"31")}),r)})))}}])})(),Ke=["id","forwardedRef"],qe=["id","forwardedRef"],He=["forwardedRef"],Xe=["forwardedRef"],Ge="X7Aa";function Je(e){return{drop:e.drop,dropScope:e.dropScope,refresh:e.refresh,refreshScope:e.refreshScope,clear:e.clear,getCachingNodes:e.getCachingNodes,dropById:e.dropById,dropScopeByIds:e.dropScopeByIds,refreshById:e.refreshById,refreshScopeByIds:e.refreshScopeByIds}}function Qe(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return!!f(e)&&(e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight)}function Ye(e){return c(r(w,"document.querySelectorAll"))?[].concat(W(m(n(e,"querySelectorAll","*"),[])),[e]).filter(Qe):[]}var Ze,et,tt=["_helpers","id","children"],rt=["_helpers","id","name"],nt=r(w,"document.body"),ot=r(w,"document.scrollingElement",r(w,"document.documentElement",{})),at=(()=>{function e(r){var o;return O(this,e),x(o=C(this,e,[r]),"id",null),x(o,"isKeepAlive",!0),x(o,"cached",!1),x(o,"inject",function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=(a=o.props).id,r=a.saveScrollPosition,a=a._helpers.getCache(t);try{a.nodes.forEach(function(e){o.placeholder.appendChild(e)}),e&&r&&n(a.revertScrollPos)}catch(c){}}),x(o,"eject",function(){var e,r=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],a=(u=o.props).id,c=u._helpers.getCache(a),u=t(t([o.props.saveScrollPosition]).map(function(e){return!0===e?c.nodes:"screen"===e?[ot,nt]:W(m(n(w,"document.querySelectorAll",e),[]))})).filter(Boolean);try{r&&0<u.length&&(c.revertScrollPos=(e=W(new Set(W(t(u.map(Ye))))).map(function(e){return[e,{x:e.scrollLeft,y:e.scrollTop}]}),function(){e.forEach(function(e){var t=(e=L(e,2))[0],r=(e=e[1]).x;e=e.y,t.scrollLeft=r,t.scrollTop=e})})),c.nodes.forEach(function(e){r?o.placeholder.removeChild(e):c.wrapper.appendChild(e)})}catch(i){}}),x(o,"refresh",function(){var e=o.props;return e._helpers.refreshById(e.id)}),x(o,"drop",function(e){var t=o.props;return t._helpers.dropById(t.id,e)}),x(o,"init",function(){var e=(a=o.props)._helpers,t=a.id,r=a.children,a=D(a,tt);e.keep(t,$({children:r,getInstance:function(){return o}},a)).then(function(e){e&&(o.inject(),e.inited?n(o,Ne):e.inited=!0,o.cached=!1)})}),x(o,"update",function(){var e=(n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})._helpers,t=n.id,r=n.name,n=D(n,rt);e&&!o.cached&&e.update(t,$({name:r,getInstance:function(){return o}},n))}),o.id=r.id,o.init(),[Ne,Re].forEach(function(e){o[e]=function(){var t,r=(t=o.props).id,a=(t=t._helpers).getCache(r);(t=t.getNode(r))&&e===Ne&&(t.updateTime=Date.now()),r=e===Re,!a||a.willDrop?o.cached&&!r&&o.init():(n(a,e),a.cached=r,o.cached=r)}}),o}return I(e,a.Component),_(e,[{key:"shouldComponentUpdate",value:function(e){return this.update(e),!1}},{key:"componentWillUnmount",value:function(){var e=(r=this.props).id,t=r._helpers,r=void 0===(r=r.when)||r,o=t.getCache(e);r=n(r);var a=(r=L(g(r)?r:[r],2))[0];r=r[1],o&&(this.eject(),delete o.getInstance,a||(r?([o].concat(W(t.getScopeIds([e]).map(function(e){return t.getCache(e)}))).filter(Boolean).forEach(function(e){e.willDrop=!0}),s(function(){return t.dropScopeByIds([e])})):(o.willDrop=!0,s(function(){return t.dropById(e)}))),n(this,Re))}},{key:"render",value:function(){var e=this,t=void 0===(t=(this.props||{}).wrapperProps)?{}:t;return k.createElement("div",j({},t,{key:"keep-alive-placeholder",className:"ka-wrapper ".concat(t.className||""),ref:function(t){e.placeholder=t}}))}}])})();function ct(e){var t=e.idPrefix,n=e.helpers,o=e.props,a=e.forwardedRef;return(e=h(n))?r(o,"children",null):k.createElement(b,{prefix:t,key:o._nk,manualKey:o.cacheKey,_nk:"".concat(Ge,"11")},function(e){var t=o.cacheKey||e;return k.createElement(xe,{key:t,id:t,_nk:"".concat(Ge,"21")},function(e){return k.createElement(Ze,j({key:t},o,e,{id:t,ref:a,_helpers:n,_nk:"".concat(Ge,"31")}))})})}x(at,"defaultProps",{saveScrollPosition:!0}),at=c(r(w,"document.getElementById"))?(Ze=je(at),et=c(a.useContext)?function(e){var t=e.id,r=e.forwardedRef;return e=D(e,Ke),ct({idPrefix:t,helpers:q(),props:e,forwardedRef:r})}:function(e){var t=e.id,r=e.forwardedRef,n=D(e,qe);return k.createElement(X,{_nk:"".concat(Ge,"41")},function(e){return ct({idPrefix:t,helpers:e,props:n,forwardedRef:r})})},c(a.forwardRef)?y(a.forwardRef(function(e,t){return k.createElement(et,j({},e,{forwardedRef:t,_nk:"".concat(Ge,"51")}))}),Ze):y(et,Ze)):function(e){e=e.children;var t=void 0===(t=(r=this.props||{}).wrapperProps)?{}:t,r=void 0===(r=r.contentProps)?{}:r;return k.createElement("div",j({},t,{key:"keep-alive-placeholder",className:"ka-wrapper ".concat(t.className||"")}),k.createElement("div",j({},r,{key:"keeper-container",className:"ka-content ".concat(r.className||"")}),e))},e.AliveScope=Fe,e.KeepAlive=at,e.NodeKey=b,e.autoFixContext=ie,e.createContext=function(e,t){return e=G(e,t),de(e),e},e.default=at,e.fixContext=de,e.useActivate=d,e.useAliveController=function(){var e;return c(a.useContext)&&(e=q())?Je(e):{}},e.useUnactivate=Ue,e.withActivation=je,e.withAliveScope=function(e){function t(t){var r=t.helpers;return k.createElement(e,j({},t.props,r,{ref:t.forwardedRef,_nk:"".concat(Ge,"61")}))}var r=c(a.useContext)?function(e){var r=e.forwardedRef;return e=D(e,He),t({helpers:Je(q()||{}),props:e,forwardedRef:r})}:function(e){var r=e.forwardedRef,n=D(e,Xe);return k.createElement(X,{_nk:"".concat(Ge,"42")},function(){return t({helpers:Je(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),props:n,forwardedRef:r})})};return c(a.forwardRef)?y(a.forwardRef(function(e,t){return k.createElement(r,j({},e,{forwardedRef:t,_nk:"".concat(Ge,"71")}))}),e):y(r,e)},Object.defineProperty(e,"__esModule",{value:!0})}(C.exports,t(),r(),n(),o(),m(),a(),c(),u(),i(),g(),s(),l(),p(),f(),d(),w(),h(),v(),y(),b())),C.exports}function P(){return S||(S=1,E.exports=O()),E.exports}var _=P();const x=e(_);export{x as K,_ as r};
