import{K as e,d as n,p as t}from"./@rc-component_util@1.7.0_re_e38ee95702524036372f825efc96e921.ChzNieGb.js";import{c as l}from"./clsx@2.1.1.DMqMD_4V.js";import{e as o,r}from"./react@18.3.1.zoCbf7Ot.js";function a(n,t){const{disabled:r,prefixCls:a,character:c,characterRender:u,index:s,count:f,value:d,allowHalf:i,focused:p,onHover:m,onClick:v}=n,b=s+1,y=new Set([a]);0===d&&0===s&&p?y.add("".concat(a,"-focused")):i&&d+.5>=b&&d<b?(y.add("".concat(a,"-half")),y.add("".concat(a,"-active")),p&&y.add("".concat(a,"-focused"))):(b<=d?y.add("".concat(a,"-full")):y.add("".concat(a,"-zero")),b===d&&p&&y.add("".concat(a,"-focused")));const w="function"==typeof c?c(n):c;let h=o.createElement("li",{className:l(Array.from(y)),ref:t},o.createElement("div",{onClick:r?null:e=>{v(e,s)},onKeyDown:r?null:n=>{n.keyCode===e.ENTER&&v(n,s)},onMouseMove:r?null:e=>{m(e,s)},role:"radio","aria-checked":d>s?"true":"false","aria-posinset":s+1,"aria-setsize":f,tabIndex:r?-1:0},o.createElement("div",{className:"".concat(a,"-first")},w),o.createElement("div",{className:"".concat(a,"-second")},w)));return u&&(h=u(h,n)),h}const c=o.forwardRef(a);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},u.apply(this,arguments)}function s(a,s){const{prefixCls:f="rc-rate",className:d,defaultValue:i,value:p,count:m=5,allowHalf:v=!1,allowClear:b=!0,keyboard:y=!0,character:w="â˜…",characterRender:h,disabled:E,direction:C="ltr",tabIndex:R=0,autoFocus:g,onHoverChange:x,onChange:H,onFocus:k,onBlur:D,onKeyDown:L,onMouseLeave:T,...j}=a,[I,N]=function(){const e=r.useRef({});return[function(n){return e.current[n]},function(n){return t=>{e.current[n]=t}}]}(),F=o.useRef(null),O=()=>{var e;E||null==(e=F.current)||e.focus()};o.useImperativeHandle(s,()=>({focus:O,blur:()=>{var e;E||null==(e=F.current)||e.blur()}}));const[K,M]=n(i||0,p),[B,S]=n(null),X=(e,n)=>{const t="rtl"===C;let l=e+1;if(v){const o=I(e),r=function(e){const n=function(e){let n,t;const l=e.ownerDocument,{body:o}=l,r=l&&l.documentElement,a=e.getBoundingClientRect();return n=a.left,t=a.top,n-=r.clientLeft||o.clientLeft||0,t-=r.clientTop||o.clientTop||0,{left:n,top:t}}(e),t=e.ownerDocument,l=t.defaultView||t.parentWindow;return n.left+=function(e){let n=e.pageXOffset;const t="scrollLeft";if("number"!=typeof n){const l=e.document;n=l.documentElement[t],"number"!=typeof n&&(n=l.body[t])}return n}(l),n.left}(o),a=o.clientWidth;(t&&n-r>a/2||!t&&n-r<a/2)&&(l-=.5)}return l},_=e=>{M(e),null==H||H(e)},[z,A]=o.useState(!1),[G,V]=o.useState(null),W=(e,n)=>{const t=X(n,e.pageX);t!==B&&(V(t),S(null)),null==x||x(t)},P=e=>{E||(V(null),S(null),null==x||x(void 0)),e&&(null==T||T(e))},q=(e,n)=>{const t=X(n,e.pageX);let l=!1;b&&(l=t===K),P(),_(l?0:t),S(l?t:null)};o.useEffect(()=>{g&&!E&&O()},[]);const J=new Array(m).fill(0).map((e,n)=>o.createElement(c,{ref:N(n),index:n,count:m,disabled:E,prefixCls:"".concat(f,"-star"),allowHalf:v,value:null===G?K:G,onClick:q,onHover:W,key:e||n,character:w,characterRender:h,focused:z})),Q=l(f,d,{["".concat(f,"-disabled")]:E,["".concat(f,"-rtl")]:"rtl"===C});return o.createElement("ul",u({className:Q,onMouseLeave:P,tabIndex:E?-1:R,onFocus:E?null:()=>{A(!0),null==k||k()},onBlur:E?null:()=>{A(!1),null==D||D()},onKeyDown:E?null:n=>{const{keyCode:t}=n,l="rtl"===C,o=v?.5:1;y&&(t===e.RIGHT&&K<m&&!l?(_(K+o),n.preventDefault()):t===e.LEFT&&K>0&&!l||t===e.RIGHT&&K>0&&l?(_(K-o),n.preventDefault()):t===e.LEFT&&K<m&&l&&(_(K+o),n.preventDefault())),null==L||L(n)},ref:F},t(j,{aria:!0,data:!0,attr:!0})),J)}const f=o.forwardRef(s);export{f as R};
