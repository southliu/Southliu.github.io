import{r as e,j as t}from"./react@19.1.1.osUeTYwR.js";import{t as r,g as a,s,c,a as o,d as i,u as n,b as m,e as d}from"./model.BO7Siu3U.js";import{b as p,A as _,I as l,a as j,B as f,v as u,E as b,w as g}from"./index.B9u6y3-g.js";import y from"./PermissionDrawer.-Fv-Vdlc.js";import{e as h,u as x}from"./react-router@7.5.1_react-do_2a1f9500c1cf2c3d8fc9e334c1ec9521.BEZ-ZM3U.js";import{c as S,B as w}from"./BaseContent.CoOaNRfG.js";import{U as k,D as v,B as C}from"./BasePagination.DwUJjXf3.js";import{B}from"./BaseCard.DA31I7vU.js";import{B as z}from"./BaseSearch.D3NWGGEu.js";import{B as N}from"./BaseTable.DezRRcXF.js";import{B as D}from"./BaseForm.Be8cvTQq.js";import{u as F}from"./react-i18next@15.6.1_i18nex_74a7e71e4075fb517089ab3b681ca6ee.DYNCe44U.js";import{s as P,F as $,B as E}from"./antd@5.27.0_react-dom@19.1.1_react@19.1.1__react@19.1.1.BrsD73IM.js";import"./@babel_runtime@7.28.3.ESkOsrAB.js";import"./constants.5OLMXA36.js";import"./role.BzwKtCce.js";import"./react-dom@19.1.1_react@19.1.1.Bn0b59nT.js";import"./scheduler@0.26.0.6ULW7vKx.js";import"./nprogress@0.2.0.BjiZ80eS.js";import"./i18next-http-backend@3.0.2.D7vzAF-b.js";import"./@loadable_component@5.16.7_react@19.1.1.DZHYJwIw.js";import"./hoist-non-react-statics@3.3.2.AL5xWxxn.js";import"./react-is@16.13.1.yJGO6Amu.js";import"./crypto-js@4.2.0.CLg-MzEz.js";import"./axios@1.11.0.C-1G2k3o.js";import"./lodash@4.17.21.dYGZUVbZ.js";import"./zustand@5.0.7_@types_react@19.1.10_immer@9.0.21_react@19.1.1.CB9cKHSM.js";import"./@iconify_react@5.2.1_react@19.1.1.DJAH1zb9.js";import"./react-activation@0.13.4_react@19.1.1.DdkkOoQg.js";import"./szfe-tools@0.0.0-beta.7.NDKJABvB.js";import"./react-node-key@0.4.0_react@19.1.1.D7tDbVk-.js";import"./react-draggable@4.5.0_react_7212988beb4cfaf8f3481fa03e139ac2.bdY7pp9P.js";import"./prop-types@15.8.1.Bx5UHif0.js";import"./clsx@2.1.1.CVo1TNh1.js";import"./@ant-design_icons@6.0.0_rea_847732ab2d986d5c093170829ace02ec.Bt-E0ljk.js";import"./@ant-design_icons-svg@4.4.2.y_0dq8WL.js";import"./classnames@2.5.1.C0tKfs1P.js";import"./@ant-design_colors@8.0.0.fIX020g4.js";import"./@ant-design_fast-color@3.0.0.ii8f2EEn.js";import"./@rc-component_util@1.2.2_re_b297ea14683146962230a74a743c21d2.Vo-V3s_2.js";import"./react-is@18.3.1.USR0mOhp.js";import"./@dnd-kit_core@6.3.1_react-d_b2d5886cf71f55202ee000d74755b8d0.aHcWYFxe.js";import"./@dnd-kit_utilities@3.2.2_react@19.1.1.DFIFdHcJ.js";import"./@dnd-kit_accessibility@3.1.1_react@19.1.1.kFZYRF5P.js";import"./@dnd-kit_sortable@10.0.0_@d_cdf393be866ffb195b557b7b22c22bad.FazU_6mP.js";import"./@ant-design_cssinjs@1.24.0__4f73402bc59976ea4d1be835bba6fd27.ChTjcm6E.js";import"./rc-util@5.44.4_react-dom@19.1.1_react@19.1.1__react@19.1.1.BCDSZbSC.js";import"./@emotion_hash@0.8.0.DFFAhID7.js";import"./@emotion_unitless@0.7.5.BWzHn38B.js";import"./stylis@4.3.6.C44NkLFc.js";import"./i18next@25.3.6_typescript@5.9.2.BRd1ohpR.js";import"./i18next-browser-languagedetector@8.2.0.DrNbJIFn.js";import"./@ant-design_v5-patch-for-re_8850a0c3444ff6c63089a511b917c3e5.DJLt133q.js";import"./dayjs@1.11.13.IJKq6rJZ.js";import"./@ant-design_cssinjs-utils@1_251b99a69096c756db7fe7c1155d2294.DXYuDB3N.js";import"./rc-resize-observer@1.4.3_re_417e6ee79a83d8d6def766a6be83681f.tpHCh3SB.js";import"./resize-observer-polyfill@1.5.1.C7U_o75s.js";import"./rc-motion@2.9.5_react-dom@19.1.1_react@19.1.1__react@19.1.1.ClrEiIOp.js";import"./rc-overflow@1.4.1_react-dom_cc4ea89628553b129a8da50b36cb88c0.C06ZcM1G.js";import"./rc-picker@4.11.3_dayjs@1.11_8e7890ae748cf0bdee07355a167b6b48.ME1MveMt.js";import"./@rc-component_trigger@2.3.0_98a5ef371ed9a77c6843246644ee9b58.CfSqy54s.js";import"./@rc-component_portal@1.1.2__12f016ef3dd10f3f947eb4a97a9aa58d.RMRqf7sY.js";import"./@ant-design_icons@5.6.1_rea_899d4c2778da3888f3c43dea354b7ae1.CO963cwF.js";import"./@ant-design_colors@7.2.1.oVwzATcR.js";import"./@ant-design_fast-color@2.0.6.2Gr2TI-y.js";import"./rc-tabs@15.7.0_react-dom@19.1.1_react@19.1.1__react@19.1.1.ftFIZzAs.js";import"./rc-dropdown@4.2.1_react-dom_9ae5fdd736f4823df4c8a646cf12960c.DvoorD5S.js";import"./rc-menu@9.16.1_react-dom@19.1.1_react@19.1.1__react@19.1.1.CQ2S3mom.js";import"./rc-select@14.16.8_react-dom_cc80e9af85a483474ef754b96054fb57.D5CmQfNg.js";import"./rc-virtual-list@3.19.1_reac_eb17cbd247287c3a3dcc8262c7846edd.B7s6eCxr.js";import"./rc-input-number@9.5.0_react_5a7d66c6ad4701d3fcc75b24018ef2ef.Dz_67JkX.js";import"./@rc-component_mini-decimal@1.1.0.BeJpelyV.js";import"./rc-input@1.8.0_react-dom@19.1.1_react@19.1.1__react@19.1.1.q4AYqmhv.js";import"./rc-slider@11.1.8_react-dom@19.1.1_react@19.1.1__react@19.1.1.D4EZ3qyL.js";import"./@rc-component_color-picker@_44d1bf8e77ac9e0081e823e9e1f4f31e.BaDk9fcq.js";import"./rc-drawer@7.3.0_react-dom@19.1.1_react@19.1.1__react@19.1.1.DCVEeWYE.js";import"./rc-field-form@2.7.0_react-d_1c776addd2d710781814a569f88b1247.CgkEHG-2.js";import"./@rc-component_async-validator@5.0.4.CmQxGjS2.js";import"./rc-dialog@9.6.0_react-dom@19.1.1_react@19.1.1__react@19.1.1.DNs_tsna.js";import"./rc-textarea@1.10.2_react-do_9e63c3c40a7644816d7e7f4d071a8248.D1l8_z-v.js";import"./rc-notification@5.6.4_react_86f0e1391a6c86543030aa5317a3707c.hy519wng.js";import"./rc-tooltip@6.4.0_react-dom@19.1.1_react@19.1.1__react@19.1.1.DYoixGeD.js";import"./rc-rate@2.13.1_react-dom@19.1.1_react@19.1.1__react@19.1.1.C0vpb7-U.js";import"./rc-switch@4.1.0_react-dom@19.1.1_react@19.1.1__react@19.1.1.CckXC3FD.js";import"./rc-table@7.51.1_react-dom@19.1.1_react@19.1.1__react@19.1.1.BtmAj-PX.js";import"./@rc-component_context@1.4.0_de4028c8571959cb44d65adf38211715.BDDj82X8.js";import"./rc-tree@5.13.1_react-dom@19.1.1_react@19.1.1__react@19.1.1.zeN_36qv.js";import"./rc-checkbox@3.5.0_react-dom_77c36b6c47b32e0b10d14715673cddee.BnKb5vR9.js";import"./scroll-into-view-if-needed@3.1.0.B0UcSGS3.js";import"./compute-scroll-into-view@3.1.1.Cfyw3hb3.js";import"./throttle-debounce@5.0.2.w9OM8Bxz.js";import"./rc-pagination@5.1.0_react-d_c4c43808196e822d8749f5ccbede6012.CoB5OvoI.js";import"./rc-tree-select@5.27.0_react_4fcbdb7796f073dfcaa0b122f1f33194.fOLUzkNx.js";import"./rc-upload@4.9.2_react-dom@19.1.1_react@19.1.1__react@19.1.1.I_eTBWRm.js";import"./rc-progress@4.0.0_react-dom_3b0b2802317cf508b84541f1103d27e0.Dc7Mdjmx.js";import"./cookie@1.0.2.BUTH-fPQ.js";import"./componentMap.8VNaEMqc.js";import"./react-resizable@3.0.5_react_491d9cc418165db19d7b9f84b7ebd170.BMgT56dQ.js";const L={status:1};function I(){const{t:I}=F(),O=e.useRef(null),[K]=(()=>{const[,e]=h(),{pathname:t}=x(),{setTabs:r}=p(e=>e);return[a=>{const s=Object.fromEntries(Object.entries(a).filter(([,e])=>void 0!==e));let c=new URLSearchParams(s).toString();(null==c?void 0:c.length)&&(c=`?${c}`),e(s),r(t,c)}]})(),R=r(I,function(e,r){return t.jsxs("div",{className:"flex flex-wrap gap-5px",children:[!0===ve.permission&&t.jsx(E,{className:"small-btn",onClick:()=>Be(r.id),children:I("system.permissions")}),!0===ve.update&&t.jsx(k,{onClick:()=>ze(r.id)}),!0===ve.delete&&t.jsx(v,{name:r.username,handleDelete:()=>Ne(r.id)})]})}),[T,M]=P.useMessage(),[U,q]=e.useState(!1),[A,V]=e.useState(!1),[W,G]=e.useState(!1),[H,J]=e.useState(!1),[Q,X]=e.useState(_(I)),[Y,Z]=e.useState(""),[ee,te]=e.useState(L),[re,ae]=e.useState({}),[se,ce]=e.useState(l.page),[oe,ie]=e.useState(l.pageSize),[ne,me]=e.useState(0),[de,pe]=e.useState([]),[_e,le]=e.useState(""),[je,fe]=e.useState(!1),[ue,be]=e.useState([]),[ge,ye]=e.useState([]),[he,xe]=e.useState([]),[Se]=$.useForm(),{permissions:we}=j(),ke="/authority/user",ve={page:S(`${ke}/index`,we),create:S(`${ke}/create`,we),update:S(`${ke}/update`,we),delete:S(`${ke}/delete`,we),permission:S(`${ke}/authority`,we)},Ce=e.useCallback(async()=>{const e={...re,page:se,pageSize:oe};try{V(!0);const{code:t,data:r}=await a(e);if(200!==Number(t))return;const{items:s,total:c}=r;me(c||0),pe(s||[])}finally{q(!1),V(!1)}},[se,oe,re]);e.useEffect(()=>{U&&Ce()},[Ce,U]);e.useEffect(()=>{ve.page&&Ce()},[ve.page]);const Be=async e=>{try{V(!0);const t={userId:e},{code:r,data:a}=await u(t);if(200!==Number(r))return;const{defaultCheckedKeys:s,treeData:c}=a;le(e),ye(c),be(s),fe(!0)}finally{V(!1)}},ze=async e=>{try{J(!0),X(b(I,e)),Z(e),G(!0);const{code:t,data:r}=await o(e);if(200!==Number(t))return;te(r)}finally{G(!1)}},Ne=async e=>{try{V(!0);const{code:t,message:r}=await i(e);200===Number(t)&&(T.success(r||I("public.successfullyDeleted")),Ce())}finally{V(!1)}},De={selectedRowKeys:he,onChange:e=>{xe(e)}};const Fe=t.jsx(v,{isIcon:!0,isLoading:A,btnType:"batchDelete",handleDelete:async()=>{try{if(!he.length)return T.warning({content:I("public.tableSelectWarning"),key:"pleaseSelect"});V(!0);const e={ids:he},{code:t,message:r}=await d(e);200===Number(t)&&(T.success(r||I("public.successfullyDeleted")),Ce())}finally{V(!1)}}});return t.jsxs(w,{isPermission:ve.page,children:[M,t.jsx(B,{children:t.jsx(z,{list:s(I),data:re,type:"grid",isLoading:A,handleFinish:e=>{ce(1),ae(e),K(e),q(!0)}})}),t.jsxs(B,{className:"mt-10px",children:[t.jsx(N,{isLoading:A,isCreate:ve.create,columns:R,dataSource:de,rowSelection:De,leftContent:Fe,rightContent:t.jsx("div",{children:"（搜索将参数放入url）"}),getPage:Ce,onCreate:()=>{J(!0),X(_(I)),Z(""),te(L)}}),t.jsx(C,{disabled:A,current:se,pageSize:oe,total:ne,onChange:(e,t)=>{ce(e),ie(t),q(!0)}})]}),t.jsx(f,{title:Q,open:H,confirmLoading:W,onOk:()=>{var e;null==(e=O.current)||e.submit()},onCancel:()=>{J(!1)},children:t.jsx(D,{form:Se,ref:O,list:c(I,!Y),data:ee,labelCol:{span:5},wrapperCol:{span:17},handleFinish:async e=>{try{G(!0);const t=()=>Y?n(Y,e):m(e),{code:r,message:a}=await t();if(200!==Number(r))return;T.success(a||I("public.successfulOperation")),J(!1),Ce()}finally{G(!1)}}})}),t.jsx(y,{isVisible:je,treeData:ge,checkedKeys:ue,onClose:()=>{fe(!1)},onSubmit:async e=>{try{V(!0);const t={menuIds:e,userId:_e},{code:r,message:a}=await g(t);if(200!==Number(r))return;T.success(a||I("system.authorizationSuccessful")),fe(!1)}finally{V(!1)}}})]})}export{I as default};
