import{r as e}from"./react@19.2.1.BpVBN_43.js";import{e as t,b as n,d as o,h as l,m as r,p as a,K as s,E as i,A as c,u,t as p,f}from"./@rc-component_util@1.4.0_re_a8b68d4fbe51b122ded4cf0ecf2ca619.D3_e-sfJ.js";import"./react-dom@19.2.1_react@19.2.1.BLi5rGn2.js";import"./@rc-component_resize-observ_eaaccb47489da2719f35257c4ad9d3c9.BynXlAVv.js";import"./@rc-component_motion@1.1.6__0afcbe001b0ce065bd610efbbf939bf0.BsUikez1.js";import{F as m}from"./rc-overflow@1.5.0_react-dom_ed71e382df4fb2eccbb1a2ad50316608.CUEIhwYs.js";import{c as d}from"./clsx@2.1.1.BvmCeSbq.js";import{T as h}from"./@rc-component_trigger@3.7.1_9234358db6ac4d4b221fe18208ab417c.KUVSKQ8O.js";import{L as b}from"./rc-virtual-list@3.19.2_reac_96eb09879a1adfd43f893d656df94dba.D76jc0i_.js";const v=e.createContext(null);function g(){return e.useContext(v)}function y(e,t){return e.filter(e=>e).some(e=>e.contains(t)||e===t)}function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},w.apply(this,arguments)}const E=(t,n)=>{const{prefixCls:o,disabled:l,visible:r,children:a,popupElement:s,animation:i,transitionName:c,popupStyle:u,popupClassName:p,direction:f="ltr",placement:m,builtinPlacements:b,popupMatchSelectWidth:v,popupRender:g,popupAlign:y,getPopupContainer:E,empty:S,onPopupVisibleChange:C,onPopupMouseEnter:x,onPopupMouseDown:O,onPopupBlur:N,...P}=t,M=`${o}-dropdown`;let R=s;g&&(R=g(s));const I=e.useMemo(()=>b||(e=>{const t=!0===e?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:t,adjustY:1},htmlRegion:"scroll"}}})(v),[b,v]),V=i?`${M}-${i}`:c,$="number"==typeof v,D=e.useMemo(()=>$?null:!1===v?"minWidth":"width",[v,$]);let _=u;$&&(_={...u,width:v});const j=e.useRef(null);return e.useImperativeHandle(n,()=>({getPopupElement:()=>j.current?.popupElement})),e.createElement(h,w({},P,{showAction:C?["click"]:[],hideAction:C?["click"]:[],popupPlacement:m||("rtl"===f?"bottomRight":"bottomLeft"),builtinPlacements:I,prefixCls:M,popupMotion:{motionName:V},popup:e.createElement("div",{onMouseEnter:x,onMouseDown:O,onBlur:N},R),ref:j,stretch:D,popupAlign:y,popupVisible:r,getPopupContainer:E,popupClassName:d(p,{[`${M}-empty`]:S}),popupStyle:_,onPopupVisibleChange:C}),a)},S=e.forwardRef(E);function C(e,t){const{key:n}=e;let o;return"value"in e&&({value:o}=e),null!=n?n:void 0!==o?o:`rc-index-key-${t}`}function x(e){return void 0!==e&&!Number.isNaN(e)}function O(e,t){const{label:n,value:o,options:l,groupLabel:r}=e||{},a=n||(t?"children":"label");return{label:a,value:o||"value",options:l||"options",groupLabel:r||a}}function N(e){const t={...e};return"props"in t||Object.defineProperty(t,"props",{get:()=>(n(!1,"Return type is option instead of Option instance. Please read value directly instead of reading from `props`."),t)}),t}function P(t){const{visible:n,values:o}=t;if(!n)return null;return e.createElement("span",{"aria-live":"polite",style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0}},`${o.slice(0,50).map(({label:e,value:t})=>["number","string"].includes(typeof e)?e:t).join(", ")}`,o.length>50?", ...":null)}const M=(e,t=1)=>{t<=0?e():(e=>{const t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(null)})(()=>{M(e,t-1)})};function R(t){const{children:n,...o}=t;return n?e.createElement("div",o,n):null}const I=e.createContext(null);function V(){return e.useContext(I)}const $=e.forwardRef((t,n)=>{const{onChange:o,onKeyDown:a,onBlur:s,style:i,syncWidth:c,value:u,className:p,autoComplete:f,...m}=t,{prefixCls:h,mode:b,onSearch:v,onSearchSubmit:y,onInputBlur:w,autoFocus:E,tokenWithEnter:S,placeholder:C,components:{input:x="input"}}=V(),{id:O,classNames:N,styles:P,open:M,activeDescendantId:R,role:I,disabled:$}=g()||{},D=d(`${h}-input`,N?.input,p),_=e.useRef(!1),j=e.useRef(null),k=e.useRef(null);e.useImperativeHandle(n,()=>k.current);const[T,A]=e.useState(void 0);l(()=>{const e=k.current;if(c&&e){e.style.width="0px";const t=e.scrollWidth;A(t),e.style.width=""}},[c,u]);const F={id:O,type:"combobox"===b?"text":"search",...m,ref:k,style:{...P?.input,...i,"--select-input-width":T},autoFocus:E,autoComplete:f||"off",className:D,disabled:$,value:u||"",onChange:e=>{let{value:t}=e.target;if(S&&j.current&&/[\r\n]/.test(j.current)){const e=j.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");t=t.replace(e,j.current)}j.current=null,v&&v(t,!0,_.current),o?.(e)},onKeyDown:e=>{const{key:t}=e,{value:n}=e.currentTarget;"Enter"===t&&"tags"===b&&!_.current&&y&&y(n),a?.(e)},onBlur:e=>{w?.(),s?.(e)},onPaste:e=>{const{clipboardData:t}=e,n=t?.getData("text");j.current=n||""},onCompositionStart:()=>{_.current=!0},onCompositionEnd:e=>{if(_.current=!1,"combobox"!==b){const{value:t}=e.currentTarget;v?.(t,!0,!1)}},role:I||"combobox","aria-expanded":M||!1,"aria-haspopup":"listbox","aria-owns":`${O}_list`,"aria-autocomplete":"list","aria-controls":`${O}_list`,"aria-activedescendant":M?R:void 0};if(e.isValidElement(x)){const n=x.props||{},o={placeholder:t.placeholder||C,...F,...n};return Object.keys(n).forEach(e=>{const t=n[e];"function"==typeof t&&(o[e]=(...n)=>{t(...n),F[e]?.(...n)})}),o.ref=r(x.ref,F.ref),e.cloneElement(x,o)}const L=x;return e.createElement(L,F)});function D(t){const{prefixCls:n,placeholder:o,displayValues:l}=V(),{classNames:r,styles:a}=g(),{show:s=!0}=t;return l.length?null:e.createElement("div",{className:d(`${n}-placeholder`,r?.placeholder),style:{visibility:s?"visible":"hidden",...a?.placeholder}},o)}const _=e.createContext(null);function j(e){return Array.isArray(e)?e:void 0!==e?[e]:[]}function k(e){return["string","number"].includes(typeof e)}function T(e){let t;return e&&(k(e.title)?t=e.title.toString():k(e.label)&&(t=e.label.toString())),t}function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},A.apply(this,arguments)}const F=e.forwardRef(({inputProps:t},n)=>{const{prefixCls:o,searchValue:l,activeValue:r,displayValues:a,maxLength:s,mode:i}=V(),{triggerOpen:c,title:u,showSearch:p,classNames:f,styles:m}=g(),h=e.useContext(_),[b,v]=e.useState(!1),y="combobox"===i,w=a[0],E=e.useMemo(()=>y&&r&&!b&&c?r:p?l:"",[y,r,b,c,l,p]),S=e.useMemo(()=>{let e={className:`${o}-content-value`,style:{visibility:E?"hidden":"visible"}};if(w&&h?.flattenOptions){const t=h.flattenOptions.find(e=>e.value===w.value);if(t?.data){const{label:n,value:o,className:l,style:r,key:a,...s}=t.data;e={...e,...s,title:T(t.data),className:d(e.className,l),style:{...e.style,...r}}}}return w&&!e.title&&(e.title=T(w)),void 0!==u&&(e.title=u),e},[w,h?.flattenOptions,o,E,u]);return e.useEffect(()=>{y&&v(!1)},[y,r]),e.createElement("div",{className:d(`${o}-content`,f?.content),style:m?.content},w?e.createElement("div",S,w.label):e.createElement(D,{show:!E}),e.createElement($,A({ref:n},t,{value:E,maxLength:"combobox"===i?s:void 0,onChange:e=>{v(!0),t.onChange?.(e)}})))}),L=t=>{const{className:n,style:o,customizeIcon:l,customizeIconProps:r,children:a,onMouseDown:s,onClick:i}=t,c="function"==typeof l?l(r):l;return e.createElement("span",{className:n,onMouseDown:e=>{e.preventDefault(),s?.(e)},style:{userSelect:"none",WebkitUserSelect:"none",...o},unselectable:"on",onClick:i,"aria-hidden":!0},void 0!==c?c:e.createElement("span",{className:d(n.split(/\s+/).map(e=>`${e}-icon`))},a))};function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},K.apply(this,arguments)}function B(e){return e.key??e.value}const W=e=>{e.preventDefault(),e.stopPropagation()},H=e.forwardRef(function({inputProps:t},n){const{prefixCls:o,displayValues:l,searchValue:r,mode:a,onSelectorRemove:s,removeIcon:i}=V(),{disabled:c,showSearch:u,triggerOpen:p,toggleOpen:f,autoClearSearchValue:h,tagRender:b,maxTagPlaceholder:v,maxTagTextLength:y,maxTagCount:w,classNames:E,styles:S}=g(),C=`${o}-selection-item`;let x=r;p||"multiple"!==a||!1===h||(x="");const O=u&&x||"",N=u&&!c,P=i??"×",M=v??(e=>`+ ${e.length} ...`),R=b,I=(t,n,o,l,r)=>e.createElement("span",{title:T(t),className:d(C,{[`${C}-disabled`]:o},E?.item),style:S?.item},e.createElement("span",{className:d(`${C}-content`,E?.itemContent),style:S?.itemContent},n),l&&e.createElement(L,{className:d(`${C}-remove`,E?.itemRemove),style:S?.itemRemove,onMouseDown:W,onClick:r,customizeIcon:P},"×")),_=(t,n,o,l,r,a,s)=>e.createElement("span",{onMouseDown:e=>{W(e),f(!p)}},R({label:n,value:t,index:s?.index,disabled:o,closable:l,onClose:r,isMaxTag:!!a}));return e.createElement(m,{prefixCls:`${o}-content`,className:E?.content,style:S?.content,prefix:l.length||r&&p?null:e.createElement(D,null),data:l,renderItem:(e,t)=>{const{disabled:n,label:o,value:l}=e,r=!c&&!n;let a=o;if("number"==typeof y&&("string"==typeof o||"number"==typeof o)){const e=String(a);e.length>y&&(a=`${e.slice(0,y)}...`)}const i=t=>{t&&t.stopPropagation(),(e=>{s?.(e)})(e)};return"function"==typeof R?_(l,a,n,r,i,void 0,t):I(e,a,n,r,i)},renderRest:e=>{if(!l.length)return null;const t="function"==typeof M?M(e):M;return"function"==typeof R?_(void 0,t,!1,!1,void 0,!0):I({title:t},t,!1)},suffix:e.createElement($,K({ref:n,disabled:c,readOnly:!N},t,{value:O||"",syncWidth:!0})),itemKey:B,maxCount:w})}),z=e.forwardRef(function(t,n){const{multiple:o,onInputKeyDown:l,tabIndex:r}=V(),s=g(),{showSearch:i}=s,c={...a(s,{aria:!0}),onKeyDown:l,readOnly:!i,tabIndex:r};return o?e.createElement(H,{ref:n,inputProps:c}):e.createElement(F,{ref:n,inputProps:c})});function U(){return U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},U.apply(this,arguments)}const G=["value","onChange","removeIcon","placeholder","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabIndex","activeValue","onSelectorRemove","focused"],Y=e.forwardRef(function(n,o){const{prefixCls:l,className:a,style:u,prefix:p,suffix:f,clearIcon:m,children:h,multiple:b,displayValues:v,placeholder:y,mode:w,searchValue:E,onSearch:S,onSearchSubmit:C,onInputBlur:x,maxLength:O,autoFocus:N,onMouseDown:P,onClearMouseDown:M,onInputKeyDown:V,onSelectorRemove:$,tokenWithEnter:D,components:_,...j}=n,{triggerOpen:k,toggleOpen:T,showSearch:A,disabled:F,loading:L,classNames:K,styles:B}=g(),W=e.useRef(null),H=e.useRef(null),Y=t(e=>{const{which:t}=e,n=H.current instanceof HTMLTextAreaElement;var o;(n||!k||t!==s.UP&&t!==s.DOWN||e.preventDefault(),V&&V(e),n&&!k&&~[s.UP,s.DOWN,s.LEFT,s.RIGHT].indexOf(t))||(o=t)&&![s.ESC,s.SHIFT,s.BACKSPACE,s.TAB,s.WIN_KEY,s.ALT,s.META,s.WIN_KEY_RIGHT,s.CTRL,s.SEMICOLON,s.EQUALS,s.CAPS_LOCK,s.CONTEXT_MENU,s.UP,s.LEFT,s.RIGHT,s.F1,s.F2,s.F3,s.F4,s.F5,s.F6,s.F7,s.F8,s.F9,s.F10,s.F11,s.F12].includes(o)&&T(!0)});e.useImperativeHandle(o,()=>({focus:e=>{(H.current||W.current).focus?.(e)},blur:()=>{(H.current||W.current).blur?.()},nativeElement:W.current}));const X=t(e=>{if(!F){e.nativeEvent._ignore_global_close=!0;const t=i(H.current);t&&e.target!==t&&!t.contains(e.target)&&e.preventDefault();const n=k&&!b&&("combobox"===w||A);e.nativeEvent._select_lazy?k&&T(!1):(H.current?.focus(),n||T())}P?.(e)}),{root:J}=_,Q=c(j,G),q={...n,onInputKeyDown:Y};return J?e.isValidElement(J)?e.cloneElement(J,{...Q,ref:r(J.ref,W)}):e.createElement(J,U({},Q,{ref:W})):e.createElement(I.Provider,{value:q},e.createElement("div",U({},Q,{ref:W,className:a,style:u,onMouseDown:X}),e.createElement(R,{className:d(`${l}-prefix`,K?.prefix),style:B?.prefix},p),e.createElement(z,{ref:H}),e.createElement(R,{className:d(`${l}-suffix`,{[`${l}-suffix-loading`]:L},K?.suffix),style:B?.suffix},f),m&&e.createElement(R,{className:d(`${l}-clear`,K?.clear),style:B?.clear,onMouseDown:e=>{e.nativeEvent._select_lazy=!0,M?.(e)}},m),h))});function X(){return X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},X.apply(this,arguments)}const J=e=>"tags"===e||"multiple"===e,Q=e.forwardRef((n,l)=>{const{id:r,prefixCls:a,className:s,styles:c,classNames:u,showSearch:p,tagRender:f,showScrollBar:m="optional",direction:h,omitDomProps:b,displayValues:g,onDisplayValuesChange:w,emptyOptions:E,notFoundContent:C="Not Found",onClear:O,maxCount:N,placeholder:R,mode:I,disabled:V,loading:$,getInputElement:D,getRawInputElement:_,open:j,defaultOpen:k,onPopupVisibleChange:T,activeValue:A,onActiveValueChange:F,activeDescendantId:L,searchValue:K,autoClearSearchValue:B,onSearch:W,onSearchSplit:H,tokenSeparators:z,allowClear:U,prefix:G,suffix:Q,suffixIcon:q,clearIcon:Z,OptionList:ee,animation:te,transitionName:ne,popupStyle:oe,popupClassName:le,popupMatchSelectWidth:re,popupRender:ae,popupAlign:se,placement:ie,builtinPlacements:ce,getPopupContainer:ue,showAction:pe=[],onFocus:fe,onBlur:me,onKeyUp:de,onKeyDown:he,onMouseDown:be,components:ve,...ge}=n,ye=J(I),we=e.useRef(null),Ee=e.useRef(null),Se=e.useRef(null),[Ce,xe]=e.useState(!1);e.useImperativeHandle(l,()=>({focus:we.current?.focus,blur:we.current?.blur,scrollTo:e=>Se.current?.scrollTo(e),nativeElement:i(we.current)}));const Oe=function(t,n,o){return e.useMemo(()=>{let{root:e,input:l}=t||{};return o&&(e=o()),n&&(l=n()),{root:e,input:l}},[t,n,o])}(ve,D,_),Ne=e.useMemo(()=>{if("combobox"!==I)return K;const e=g[0]?.value;return"string"==typeof e||"number"==typeof e?String(e):""},[K,I,g]),Pe="combobox"===I&&"function"==typeof D&&D()||null,Me=!C&&E,[Re,Ie]=function(n,l,r){const[a,s]=e.useState(!1);e.useEffect(()=>{s(!0)},[]);const[i,c]=o(!1,n),u=r(!!a&&i),p=e.useRef(0),f=e.useRef(!1),m=t(e=>{l&&u!==e&&l(e),c(e)}),d=t((e,t={})=>{const{ignoreNext:n=!1}=t;p.current+=1;const o=p.current,l="boolean"==typeof e?e:!u;l?f.current||(m(l),n&&(f.current=n,M(()=>{f.current=!1},3))):M(()=>{o!==p.current||f.current||m(l)})});return[u,d]}(j,T,e=>!V&&!Me&&e),Ve=e.useMemo(()=>(z||[]).some(e=>["\n","\r\n"].includes(e)),[z]),$e=(e,t,n)=>{if(ye&&x(N)&&g.length>=N)return;let o=!0,l=e;F?.(null);const r=((e,t,n)=>{if(!t||!t.length)return null;let o=!1;const l=(e,[t,...n])=>{if(!t)return[e];const r=e.split(t);return o=o||r.length>1,r.reduce((e,t)=>[...e,...l(t,n)],[]).filter(Boolean)},r=l(e,t);return o?void 0!==n?r.slice(0,n):r:null})(e,z,x(N)?N-g.length:void 0),a=n?null:r;return"combobox"!==I&&a&&(l="",H?.(a),Ie(!1),o=!1),W&&Ne!==l&&W(l,{source:t?"typing":"effect"}),e&&t&&o&&Ie(!0),o};e.useEffect(()=>{Re||ye||"combobox"===I||$e("",!1,!1)},[Re]),e.useEffect(()=>{V&&(Ie(!1),xe(!1))},[V,Re]);const[De,_e]=function(t=250){const n=e.useRef(null),o=e.useRef(null);return e.useEffect(()=>()=>{window.clearTimeout(o.current)},[]),[()=>n.current,function(e){(e||null===n.current)&&(n.current=e),window.clearTimeout(o.current),o.current=window.setTimeout(()=>{n.current=null},t)}]}(),je=e.useRef(!1),ke=t(e=>{const t=g.filter(t=>t!==e);w(t,{type:"remove",values:[e]})}),Te=()=>[i(we.current),Ee.current?.getPopupElement()];!function(n,o,l,r){const a=t(e=>{if(r)return;let t=e.target;t.shadowRoot&&e.composed&&(t=e.composedPath()[0]||t),!o||e._ignore_global_close||y(n(),t)||l(!1)});e.useEffect(()=>(window.addEventListener("mousedown",a),()=>window.removeEventListener("mousedown",a)),[a])}(Te,Re,Ie,!!Oe.root);const Ae=()=>{M(()=>{y(Te(),document.activeElement)||Ie(!1)})},Fe=(e,...t)=>{const{target:n}=e,o=Ee.current?.getPopupElement();o?.contains(n)&&Ie&&Ie(!0,{ignoreNext:!0}),be?.(e,...t)},[,Le]=e.useState({});let Ke;Oe.root&&(Ke=e=>{Ie(e)});const Be=e.useMemo(()=>({...n,notFoundContent:C,open:Re,triggerOpen:Re,id:r,showSearch:p,multiple:ye,toggleOpen:Ie,showScrollBar:m,styles:c,classNames:u}),[n,C,Ie,r,p,ye,Re,m,c,u]),We=e.useMemo(()=>{const e=Q??q;return"function"==typeof e?e({searchValue:Ne,open:Re,focused:Ce,showSearch:p,loading:$}):e},[Q,q,Ne,Re,Ce,p,$]),{allowClear:He,clearIcon:ze}=((t,n,o,l,r=!1,a,s)=>{const i=e.useMemo(()=>"boolean"==typeof o?{allowClear:o}:o&&"object"==typeof o?o:{allowClear:!1},[o]);return e.useMemo(()=>{const e=!r&&!1!==i.allowClear&&(n.length||a)&&!("combobox"===s&&""===a);return{allowClear:e,clearIcon:e?i.clearIcon||l||"×":null}},[i,l,r,n.length,a,s])})(0,g,U,Z,V,Ne,I),Ue=e.createElement(ee,{ref:Se}),Ge=d(a,s,{[`${a}-focused`]:Ce,[`${a}-multiple`]:ye,[`${a}-single`]:!ye,[`${a}-allow-clear`]:He,[`${a}-show-arrow`]:null!=We,[`${a}-disabled`]:V,[`${a}-loading`]:$,[`${a}-open`]:Re,[`${a}-customize-input`]:Pe,[`${a}-show-search`]:p});let Ye=e.createElement(Y,X({},ge,{ref:we,prefixCls:a,className:Ge,focused:Ce,prefix:G,suffix:We,clearIcon:ze,multiple:ye,mode:I,displayValues:g,placeholder:R,searchValue:Ne,activeValue:A,onSearch:$e,onSearchSubmit:e=>{e&&e.trim()&&W(e,{source:"submit"})},onInputBlur:()=>{je.current=!1},onFocus:e=>{xe(!0),V||(pe.includes("focus")&&Ie(!0),fe?.(e))},onBlur:e=>{xe(!1),Ne&&("tags"===I?W(Ne,{source:"submit"}):"multiple"===I&&W("",{source:"blur"})),Ae(),V||me?.(e)},onClearMouseDown:()=>{O?.(),we.current?.focus(),w([],{type:"clear",values:g}),$e("",!1,!1)},onKeyDown:e=>{const t=De(),{key:n}=e,o="Enter"===n;if(o&&("combobox"!==I&&e.preventDefault(),Re||Ie(!0)),_e(!!Ne),"Backspace"===n&&!t&&ye&&!Ne&&g.length){const e=[...g];let t=null;for(let n=e.length-1;n>=0;n-=1){const o=e[n];if(!o.disabled){e.splice(n,1),t=o;break}}t&&w(e,{type:"remove",values:[t]})}!Re||o&&je.current||(o&&(je.current=!0),Se.current?.onKeyDown(e)),he?.(e)},onKeyUp:(e,...t)=>{Re&&Se.current?.onKeyUp(e,...t),"Enter"===e.key&&(je.current=!1),de?.(e,...t)},onSelectorRemove:ke,tokenWithEnter:Ve,onMouseDown:Fe,components:Oe}));return Ye=e.createElement(S,{ref:Ee,disabled:V,prefixCls:a,visible:Re,popupElement:Ue,animation:te,transitionName:ne,popupStyle:oe,popupClassName:le,direction:h,popupMatchSelectWidth:re,popupRender:ae,popupAlign:se,placement:ie,builtinPlacements:ce,getPopupContainer:ue,empty:E,onPopupVisibleChange:Ke,onPopupMouseEnter:function(){Le({})},onPopupMouseDown:Fe,onPopupBlur:Ae},Ye),e.createElement(v.Provider,{value:Be},e.createElement(P,{visible:Ce&&!Re,values:g}),Ye)}),q=()=>null;q.isSelectOptGroup=!0;const Z=()=>null;function ee(){return ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ee.apply(this,arguments)}function te(e){return"string"==typeof e||"number"==typeof e}Z.isSelectOption=!0;const ne=(t,n)=>{const{prefixCls:o,id:l,open:r,multiple:i,mode:p,searchValue:f,toggleOpen:m,notFoundContent:h,onPopupScroll:v,showScrollBar:y}=g(),{maxCount:w,flattenOptions:E,onActiveValue:S,defaultActiveFirstOption:C,onSelect:O,menuItemSelectedIcon:N,rawValues:P,fieldNames:M,virtual:R,direction:I,listHeight:V,listItemHeight:$,optionRender:D,classNames:j,styles:k}=e.useContext(_),T=`${o}-item`,A=u(()=>E,[r,E],(e,t)=>t[0]&&e[1]!==t[1]),F=e.useRef(null),K=e.useMemo(()=>i&&x(w)&&P?.size>=w,[i,w,P?.size]),B=e=>{e.preventDefault()},W=e=>{F.current?.scrollTo("number"==typeof e?{index:e}:e)},H=e.useCallback(e=>"combobox"!==p&&P.has(e),[p,[...P].toString(),P.size]),z=(e,t=1)=>{const n=A.length;for(let o=0;o<n;o+=1){const l=(e+o*t+n)%n,{group:r,data:a}=A[l]||{};if(!r&&!a?.disabled&&(H(a.value)||!K))return l}return-1},[U,G]=e.useState(()=>z(0)),Y=(e,t=!1)=>{G(e);const n={source:t?"keyboard":"mouse"},o=A[e];o?S(o.value,e,n):S(null,-1,n)};e.useEffect(()=>{Y(!1!==C?z(0):-1)},[A.length,f]);const X=e.useCallback(e=>"combobox"===p?String(e).toLowerCase()===f.toLowerCase():P.has(e),[p,f,[...P].toString(),P.size]);e.useEffect(()=>{let e;if(!i&&r&&1===P.size){const t=Array.from(P)[0],n=A.findIndex(({data:e})=>f?String(e.value).startsWith(f):e.value===t);-1!==n&&(Y(n),e=setTimeout(()=>{W(n)}))}return r&&F.current?.scrollTo(void 0),()=>clearTimeout(e)},[r,f]);const J=e=>{void 0!==e&&O(e,{selected:!P.has(e)}),i||m(!1)};if(e.useImperativeHandle(n,()=>({onKeyDown:e=>{const{which:t,ctrlKey:n}=e;switch(t){case s.N:case s.P:case s.UP:case s.DOWN:{let e=0;if(t===s.UP?e=-1:t===s.DOWN?e=1:/(mac\sos|macintosh)/i.test(navigator.appVersion)&&n&&(t===s.N?e=1:t===s.P&&(e=-1)),0!==e){const t=z(U+e,e);W(t),Y(t,!0)}break}case s.TAB:case s.ENTER:{const t=A[U];if(!t||t.data.disabled)return J(void 0);!K||P.has(t.value)?J(t.value):J(void 0),r&&e.preventDefault();break}case s.ESC:m(!1),r&&e.stopPropagation()}},onKeyUp:()=>{},scrollTo:e=>{W(e)}})),0===A.length)return e.createElement("div",{role:"listbox",id:`${l}_list`,className:`${T}-empty`,onMouseDown:B},h);const Q=Object.keys(M).map(e=>M[e]),q=e=>e.label;function Z(e,t){const{group:n}=e;return{role:n?"presentation":"option",id:`${l}_list_${t}`}}const ne=t=>{const n=A[t];if(!n)return null;const o=n.data||{},{value:l}=o,{group:r}=n,s=a(o,!0),i=q(n);return n?e.createElement("div",ee({"aria-label":"string"!=typeof i||r?null:i},s,{key:t},Z(n,t),{"aria-selected":X(l)}),l):null},oe={role:"listbox",id:`${l}_list`};return e.createElement(e.Fragment,null,R&&e.createElement("div",ee({},oe,{style:{height:0,width:0,overflow:"hidden"}}),ne(U-1),ne(U),ne(U+1)),e.createElement(b,{itemKey:"key",ref:F,data:A,height:V,itemHeight:$,fullHeight:!1,onMouseDown:B,onScroll:v,virtual:R,direction:I,innerProps:R?null:oe,showScrollBar:y,className:j?.popup?.list,style:k?.popup?.list},(t,n)=>{const{group:o,groupOption:l,data:r,label:s,value:i}=t,{key:u}=r;if(o){const t=r.title??(te(s)?s.toString():void 0);return e.createElement("div",{className:d(T,`${T}-group`,r.className),title:t},void 0!==s?s:u)}const{disabled:p,title:f,children:m,style:h,className:b,...v}=r,g=c(v,Q),y=H(i),w=p||!y&&K,E=`${T}-option`,S=d(T,E,b,j?.popup?.listItem,{[`${E}-grouped`]:l,[`${E}-active`]:U===n&&!w,[`${E}-disabled`]:w,[`${E}-selected`]:y}),C=q(t),x=!N||"function"==typeof N||y,O="number"==typeof C?C:C||i;let P=te(O)?O.toString():void 0;return void 0!==f&&(P=f),e.createElement("div",ee({},a(g),R?{}:Z(t,n),{"aria-selected":R?void 0:X(i),className:S,title:P,onMouseMove:()=>{U===n||w||Y(n)},onClick:()=>{w||J(i)},style:{...k?.popup?.listItem,...h}}),e.createElement("div",{className:`${E}-content`},"function"==typeof D?D(t,{index:n}):O),e.isValidElement(N)||y,x&&e.createElement(L,{className:`${T}-option-state`,customizeIcon:N,customizeIconProps:{value:i,disabled:w,isSelected:y}},y?"✓":null))}))},oe=e.forwardRef(ne);function le(e,t){return j(e).join("").toUpperCase().includes(t)}function re(t,n=!1){return p(t).map((t,o)=>{if(!e.isValidElement(t)||!t.type)return null;const{type:{isSelectOptGroup:l},key:r,props:{children:a,...s}}=t;return n||!l?function(e){const{key:t,props:{children:n,value:o,...l}}=e;return{key:t,value:void 0!==o?o:t,children:n,...l}}(t):{key:`__RC_SELECT_GRP__${null===r?o:r}__`,label:r,...s,options:re(a)}}).filter(e=>e)}const ae=(t,n,o,l,r)=>e.useMemo(()=>{let e=t;!t&&(e=re(n));const a=new Map,s=new Map,i=(e,t,n)=>{n&&"string"==typeof n&&e.set(t[n],t)},c=(e,t=!1)=>{for(let n=0;n<e.length;n+=1){const u=e[n];!u[o.options]||t?(a.set(u[o.value],u),i(s,u,o.label),i(s,u,l),i(s,u,r)):c(u[o.options],!0)}};return c(e),{options:e,valueOptions:a,labelOptions:s}},[t,n,o,l,r]);function se(t){const n=e.useRef();n.current=t;return e.useCallback((...e)=>n.current(...e),[])}function ie(){return ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ie.apply(this,arguments)}const ce=["inputValue"];const ue=e.forwardRef((t,n)=>{const{id:l,mode:r,prefixCls:a="rc-select",backfill:s,fieldNames:i,showSearch:c,searchValue:u,onSearch:p,autoClearSearchValue:m,filterOption:d,optionFilterProp:h,filterSort:b,onSelect:v,onDeselect:g,onActive:y,popupMatchSelectWidth:w=!0,optionLabelProp:E,options:S,optionRender:x,children:P,defaultActiveFirstOption:M,menuItemSelectedIcon:R,virtual:I,direction:V,listHeight:$=200,listItemHeight:D=20,labelRender:k,value:T,defaultValue:A,labelInValue:F,onChange:L,maxCount:K,classNames:B,styles:W,...H}=t,z={searchValue:u,onSearch:p,autoClearSearchValue:m,filterOption:d,optionFilterProp:h,filterSort:b},[U,G]=function(t,n,o){const{filterOption:l,searchValue:r,optionFilterProp:a,filterSort:s,onSearch:i,autoClearSearchValue:c}=n;return e.useMemo(()=>{const e="object"==typeof t,n={filterOption:l,searchValue:r,optionFilterProp:a,filterSort:s,onSearch:i,autoClearSearchValue:c,...e?t:{}};return[!!(e||"combobox"===o||"tags"===o||"multiple"===o&&void 0===t)||t,n]},[o,t,l,r,a,s,i,c])}(c,z,r),{filterOption:Y,searchValue:X,optionFilterProp:q,filterSort:Z,onSearch:ee,autoClearSearchValue:te=!0}=G,ne=f(l),re=J(r),ue=!(S||!P),pe=e.useMemo(()=>(void 0!==Y||"combobox"!==r)&&Y,[Y,r]),fe=e.useMemo(()=>O(i,ue),[JSON.stringify(i),ue]),[me,de]=o("",X),he=me||"",be=ae(S,P,fe,q,E),{valueOptions:ve,labelOptions:ge,options:ye}=be,we=e.useCallback(e=>j(e).map(e=>{let t,n,o,l;!function(e){return!e||"object"!=typeof e}(e)?(n=e.label,t=e.value):t=e;const r=ve.get(t);return r&&(void 0===n&&(n=r?.[E||fe.label]),o=r?.disabled,l=r?.title),{label:n,value:t,key:t,disabled:o,title:l}}),[fe,E,ve]),[Ee,Se]=o(A,T),Ce=e.useMemo(()=>{const e=we(re&&null===Ee?[]:Ee);return"combobox"===r&&function(e){return!e&&0!==e}(e[0]?.value)?[]:e},[Ee,we,r,re]),[xe,Oe]=((t,n)=>{const o=e.useRef({values:new Map,options:new Map});return[e.useMemo(()=>{const{values:e,options:l}=o.current,r=t.map(t=>void 0===t.label?{...t,label:e.get(t.value)?.label}:t),a=new Map,s=new Map;return r.forEach(e=>{a.set(e.value,e),s.set(e.value,n.get(e.value)||l.get(e.value))}),o.current.values=a,o.current.options=s,r},[t,n]),e.useCallback(e=>n.get(e)||o.current.options.get(e),[n])]})(Ce,ve),Ne=e.useMemo(()=>{if(!r&&1===xe.length){const e=xe[0];if(null===e.value&&(null===e.label||void 0===e.label))return[]}return xe.map(e=>({...e,label:("function"==typeof k?k(e):e.label)??e.value}))},[r,xe,k]),Pe=e.useMemo(()=>new Set(xe.map(e=>e.value)),[xe]);e.useEffect(()=>{if("combobox"===r){const e=xe[0]?.value;de(function(e){return null!=e}(e)?String(e):"")}},[xe]);const Me=se((e,t)=>{const n=t??e;return{[fe.value]:e,[fe.label]:n}}),Re=((t,n,o,l,r)=>e.useMemo(()=>{if(!o||!1===l)return t;const{options:e,label:a,value:s}=n,i=[],c="function"==typeof l,u=o.toUpperCase(),p=c?l:(t,n)=>r?le(n[r],u):n[e]?le(n["children"!==a?a:"label"],u):le(n[s],u),f=c?e=>N(e):e=>e;return t.forEach(t=>{if(t[e])if(p(o,f(t)))i.push(t);else{const n=t[e].filter(e=>p(o,f(e)));n.length&&i.push({...t,[e]:n})}else p(o,f(t))&&i.push(t)}),i},[t,l,r,o,n]))(e.useMemo(()=>{if("tags"!==r)return ye;const e=[...ye];return[...xe].sort((e,t)=>e.value<t.value?-1:1).forEach(t=>{const n=t.value;(e=>ve.has(e))(n)||e.push(Me(n,t.label))}),e},[Me,ye,ve,xe,r]),fe,he,pe,q),Ie=e.useMemo(()=>"tags"!==r||!he||Re.some(e=>e[q||"value"]===he)||Re.some(e=>e[fe.value]===he)?Re:[Me(he),...Re],[Me,q,r,Re,he,fe]),Ve=e=>[...e].sort((e,t)=>Z(e,t,{searchValue:he})).map(e=>Array.isArray(e.options)?{...e,options:e.options.length>0?Ve(e.options):e.options}:e),$e=e.useMemo(()=>Z?Ve(Ie):Ie,[Ie,Z,he]),De=e.useMemo(()=>function(e,{fieldNames:t,childrenAsData:n}={}){const o=[],{label:l,value:r,options:a,groupLabel:s}=O(t,!1);return function e(t,i){Array.isArray(t)&&t.forEach(t=>{if(i||!(a in t)){const e=t[r];o.push({key:C(t,o.length),groupOption:i,data:t,label:t[l],value:e})}else{let l=t[s];void 0===l&&n&&(l=t.label),o.push({key:C(t,o.length),group:!0,data:t,label:l}),e(t[a],!0)}})}(e,!1),o}($e,{fieldNames:fe,childrenAsData:ue}),[$e,fe,ue]),_e=e=>{const t=we(e);if(Se(t),L&&(t.length!==xe.length||t.some((e,t)=>xe[t]?.value!==e?.value))){const e=F?t.map(({label:e,value:t})=>({label:e,value:t})):t.map(e=>e.value),n=t.map(e=>N(Oe(e.value)));L(re?e:e[0],re?n:n[0])}},[je,ke]=e.useState(null),[Te,Ae]=e.useState(0),Fe=void 0!==M?M:"combobox"!==r,Le=e.useRef(),Ke=e.useCallback((e,t,{source:n="keyboard"}={})=>{Ae(t),s&&"combobox"===r&&null!==e&&"keyboard"===n&&ke(String(e));const o=Promise.resolve().then(()=>{Le.current===o&&y?.(e)});Le.current=o},[s,r,y]),Be=(e,t,n)=>{const o=()=>{const t=Oe(e);return[F?{label:t?.[fe.label],value:e}:e,N(t)]};if(t&&v){const[e,t]=o();v(e,t)}else if(!t&&g&&"clear"!==n){const[e,t]=o();g(e,t)}},We=se((e,t)=>{let n;const o=!re||t.selected;n=o?re?[...xe,e]:[e]:xe.filter(t=>t.value!==e),_e(n),Be(e,o),"combobox"===r?ke(""):J&&!te||(de(""),ke(""))}),He=e.useMemo(()=>{const e=!1!==I&&!1!==w;return{...be,flattenOptions:De,onActiveValue:Ke,defaultActiveFirstOption:Fe,onSelect:We,menuItemSelectedIcon:R,rawValues:Pe,fieldNames:fe,virtual:e,direction:V,listHeight:$,listItemHeight:D,childrenAsData:ue,maxCount:K,optionRender:x,classNames:B,styles:W}},[K,be,De,Ke,Fe,We,R,Pe,fe,I,w,V,$,D,ue,x,B,W]);return e.createElement(_.Provider,{value:He},e.createElement(Q,ie({},H,{id:ne,prefixCls:a,ref:n,omitDomProps:ce,mode:r,classNames:B,styles:W,displayValues:Ne,onDisplayValuesChange:(e,t)=>{_e(e);const{type:n,values:o}=t;"remove"!==n&&"clear"!==n||o.forEach(e=>{Be(e.value,!1,n)})},maxCount:K,direction:V,showSearch:U,searchValue:he,onSearch:(e,t)=>{if(de(e),ke(null),"submit"===t.source){const t=(e||"").trim();if(t){const e=Array.from(new Set([...Pe,t]));_e(e),Be(t,!0),de("")}return}"blur"!==t.source&&("combobox"===r&&_e(e),ee?.(e))},autoClearSearchValue:te,onSearchSplit:e=>{let t=e;"tags"!==r&&(t=e.map(e=>{const t=ge.get(e);return t?.value}).filter(e=>void 0!==e));const n=Array.from(new Set([...Pe,...t]));_e(n),n.forEach(e=>{Be(e,!0)})},popupMatchSelectWidth:w,OptionList:oe,emptyOptions:!De.length,activeValue:je,activeDescendantId:`${ne}_list_${Te}`})))});ue.Option=Z,ue.OptGroup=q;export{Q as B,Z as O,ue as T,q as a,g as u};
