import{o as e}from"./@babel_runtime@7.27.0.CgHJBUxY.js";import{r as t,a as n,b as r,c as o,d as a,e as c,f as u,g as i,h as l,i as s,j as p,k as f,l as d,m as h,n as v}from"./szfe-tools@0.0.0-beta.7.Bf-t9pxN.js";import{a as y}from"./react@19.1.0.BqYkxQ4a.js";import{r as m}from"./create-react-context@0.3.0_prop-types@15.8.1_react@19.1.0.BuKsRTan.js";import{b as g}from"./react-dom@19.1.0_react@19.1.0.DkWXDd0o.js";import{r as w}from"./hoist-non-react-statics@3.3.2.FRrFAnxy.js";import{r as b}from"./react-node-key@0.4.0_react@19.1.0.BlIbWGZt.js";var k,S,E={exports:{}},O={exports:{}};function P(){return k||(k=1,function(e,t,n,r,o,a,c,u,i,l,s,p,f,d,h,v,y,m,g,w,b){t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var k="default"in a?a.default:a;function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e){if(Array.isArray(e))return e}function O(e,t,n){return t=N(t),R(e,I()?Reflect.construct(t,n||[],N(e).constructor):t.apply(e,n))}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,V(r.key),r)}}function j(e,t,n){return t&&C(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _(e,t,n){return(t=V(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(){return(x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)!{}.hasOwnProperty.call(r,n)||(e[n]=r[n])}return e}).apply(null,arguments)}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}function I(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(I=function(){return!!e})()}function B(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function $(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function U(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)),r}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t){if(null==e)return{};var n,r=((e,t)=>{if(null==e)return{};var n,r={};for(n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r})(e,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(e),a=0;a<o.length;a++)n=o[a],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n]);return r}function R(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(t=e))throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z(e,t){return(z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function L(e,t){return E(e)||((e,t)=>{var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,c,u=[],i=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(s){l=!0,o=s}finally{try{if(!i&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw o}}return u}})(e,t)||F(e,t)||$()}function M(e){return E(e)||B(e)||F(e)||$()}function W(e){return(e=>{if(Array.isArray(e))return S(e)})(e)||B(e)||F(e)||(()=>{throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function V(e){return"symbol"==typeof(e=((e,t)=>{if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);if("object"!=typeof(n=n.call(e,t)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(e,"string"))?e:e+""}function F(e,t){var n;if(e)return"string"==typeof e?S(e,t):"Map"===(n="Object"===(n={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}function K(){var e,t,n;return c(a.useContext)?a.useContext(X)||(t=(e=L(a.useState(te.currentContextValue),2))[0],n=e[1],a.useEffect((function(){var e=o(n);return ee.on("update",e),function(){return ee.off("update",e)}}),[]),t):{}}function q(e){var t=e.children;return e=D(e,re),k.createElement(G,x({},e,{_nk:"".concat(oe,"11")}),k.createElement(te,x({},e,{_nk:"".concat(oe,"21")}),t))}function H(e){var t=e.children;return k.createElement(J,{_nk:"".concat(oe,"31")},(function(e){return e?r(t,void 0,e):k.createElement(ne,{_nk:"".concat(oe,"41")},t)}))}c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,v=v&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,w=w&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w,b=b&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b;var X=u(),G=X.Provider,J=X.Consumer,Q=u(),Y=Q.Provider,Z=Q.Consumer,ee=new i,te=(()=>{function e(t){var n;return P(this,e),n=O(this,e,[t]),e.currentContextValue=t.value,n}return A(e,a.Component),j(e,[{key:"shouldComponentUpdate",value:function(t){return t.value!==this.props.value&&(e.currentContextValue=t.value,ee.emit("update",t.value)),t.children!==this.props.children||t.value!==this.props.value}},{key:"render",value:function(){return this.props.children}}])})(),ne=(_(te,"eventBus",ee),_(te,"currentContextValue",void 0),(()=>{function e(t){var n;return P(this,e),_(n=O(this,e,[t]),"state",{context:te.currentContextValue}),_(n,"updateListener",o((function(e){n.setState({context:e})}))),ee.on("update",n.updateListener),n}return A(e,a.PureComponent),j(e,[{key:"componentWillUnmount",value:function(){ee.off("update",this.updateListener)}},{key:"render",value:function(){var e=this.props.children,t=this.state.context;return r(e,void 0,t)}}])})()),re=["children"],oe="qj9A",ae=(()=>{function e(){var t;P(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return _(t=O(this,e,[].concat(r)),"promiseCache",{}),t}return A(e,a.Component),j(e,[{key:"render",value:function(){var e=(t=this.props).freeze,t=t.children,n=this.promiseCache;if(e&&!n.promise)throw n.promise=new Promise((function(e){n.resolve=e})),n.promise;if(e)throw n.promise;return n.promise&&(n.resolve(),n.promise=void 0),k.createElement(a.Fragment,null,t)}}])})();function ce(){try{for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach((function(e){var t=(e=M(e))[0];e.slice(1).forEach((function(e){var r;c(n(t,e))&&!n(t,[e,"_overridden"])&&(r=t[e].bind(t),t[e]=function(e){p(e)||fe(e);for(var t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return r.apply(void 0,[e].concat(n))},t[e]._overridden=!0)}))}))}catch(o){}}function ue(e){return e=e.children,r(e)}var ie=[],le=new Map,se=new i,pe=d((function(e){f(e)&&![X,Q].includes(e)&&(f(e.Consumer)||(e.Consumer=function(t){t=t.children;var n=r(a.useContext,void 0,e);return k.createElement(a.Fragment,null,r(t,void 0,n))}),ie.push(e),setTimeout((function(){return se.emit("update")})))})),fe=d((function(e){e=n(e,"_context")||n(e,"context"),n(e,"$$typeof")===n(X,"$$typeof")&&pe(e)})),de=(ce([k,"createElement"]),(()=>{function e(t){var n,r;return P(this,e),_(n=O(this,e,[t]),"unmount",null),0===(t=t.value).length?(n.state={ctxValue:null},R(n)):((t=L(t,1)[0]).ctx,r=t.onUpdate,n.state={ctxValue:t.value},n.unmount=r((function(e){n.setState({ctxValue:e})})),n)}return A(e,a.PureComponent),j(e,[{key:"componentWillUnmount",value:function(){r(this.unmount)}},{key:"render",value:function(){var t,n,r=(o=this.props).value,o=o.children;return 0===(r=r.filter(Boolean)).length?o:(t=this.state.ctxValue,n=(r=M(r))[0].ctx,r=r.slice(1),n=n.Provider,n=h(t)?o:k.createElement(n,{value:t,_nk:"".concat("lqEk","11")},o),0<r.length?k.createElement(e,{value:r,_nk:"".concat("lqEk","21")},n):n)}}])})()),he=(()=>{function e(t){P(this,e),_(o=O(this,e,[t]),"updateListener",null),_(o,"ctxInfo",null);var o,a=t.value,c=t.ctx;return t=t.id,h(a)?R(o):(o.updateListener=n(le.get(c),t,new Map),r(o.updateListener,"forEach",(function(e){return e(a)})),o.ctxInfo={ctx:c,value:a,onUpdate:function(e){return o.updateListener.set(e,e),function(){return o.updateListener.delete(e)}}},o)}return A(e,a.Component),j(e,[{key:"componentWillUnmount",value:function(){var e=(r=this.props).value,t=r.ctx,r=r.id;h(e)||le.set(t,T(T({},n(le.get(t),void 0,{})),{},_({},r,this.updateListener)))}},{key:"shouldComponentUpdate",value:function(e){var t=e.value;return this.props.value!==t&&r(this.updateListener,"forEach",(function(e){return e(t)})),!0}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.renderWrapper,o=t.renderContent;return r((function(t){return o(h(n)?t:[].concat(W(t),[e.ctxInfo]))}))}}])})(),ve={},ye=(()=>{function e(t){var n;return P(this,e),_(n=O(this,e,[t]),"renderWrapper",(function(e){var t=n.props.id;return ve[t].reduce((function(e,n){var r=n.Consumer;return function(o){return k.createElement(r,{_nk:"".concat("SsUr","11")},(function(r){return k.createElement(he,{value:r,ctx:n,renderWrapper:e,renderContent:o,id:t,_nk:"".concat("SsUr","21")})}))}}),(function(e){return e([])}))(e)})),t=t.id,ve[t]||(ve[t]=W(ie).filter((function(e){return f(e.Consumer)}))),n}return A(e,a.PureComponent),j(e,[{key:"render",value:function(){var e=this.props.children;return this.renderWrapper(e)}}])})(),me="46lG",ge=(d=c(a.lazy)&&!h(a.Suspense))?a.lazy((function(){return new Promise((function(){return null}))})):function(){return null},we=(()=>{function e(){return P(this,e),O(this,e,arguments)}return A(e,a.Component),j(e,[{key:"componentDidMount",value:function(){r(this.props,"onStart")}},{key:"componentWillUnmount",value:function(){r(this.props,"onEnd")}},{key:"render",value:function(){return null}}])})(),be=d?(()=>{function e(){var t;P(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return _(t=O(this,e,[].concat(r)),"state",{suspense:!1}),_(t,"onSuspenseStart",(function(){t.setState({suspense:!0})})),_(t,"onSuspenseEnd",(function(){t.setState({suspense:!1})})),_(t,"sus$$",{onSuspenseStart:t.onSuspenseStart,onSuspenseEnd:t.onSuspenseEnd}),t}return A(e,a.Component),j(e,[{key:"render",value:function(){var e=this.props.children;return k.createElement(a.Fragment,null,r(e,void 0,this.sus$$),this.state.suspense&&k.createElement(ge,{_nk:"".concat(me,"31")}))}}])})():ue,ke=d?function(e){var t=e.children;return e=e.sus$$,k.createElement(a.Suspense,{fallback:k.createElement(we,{onStart:e.onSuspenseStart,onEnd:e.onSuspenseEnd,_nk:"".concat(me,"21")}),_nk:"".concat(me,"11")},t)}:ue,Se=(()=>{function e(){return P(this,e),O(this,e,arguments)}return A(e,a.Component),j(e,[{key:"componentDidCatch",value:function(e){var t=this.props.error$$;r(t,void 0,e,(function(){r(t,void 0,null)}))}},{key:"render",value:function(){return this.props.children}}])})(),Ee=(_(Se,"getDerivedStateFromError",(function(){return null})),(()=>{function e(){var t;P(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return _(t=O(this,e,[].concat(r)),"state",{error:null}),_(t,"throwError",(function(e,n){return t.setState({error:e},n)})),t}return A(e,a.Component),j(e,[{key:"render",value:function(){if(this.state.error)throw this.state.error;return r(this.props.children,void 0,this.throwError)}}])})()),Oe="lajT";function Pe(e){var t=e.id,n=e.children,r=(e=e.bridgeProps).sus$$,o=e.ctx$$;return k.createElement(Se,{error$$:e.error$$,_nk:"".concat(Oe,"11")},k.createElement(ke,{sus$$:r,_nk:"".concat(Oe,"21")},k.createElement(de,{id:t,value:o,_nk:"".concat(Oe,"31")},n)))}function Ce(e){var t=e.id,n=e.children;return k.createElement(Ee,{_nk:"".concat(Oe,"41")},(function(e){return k.createElement(be,{_nk:"".concat(Oe,"51")},(function(o){return k.createElement(ye,{id:t,_nk:"".concat(Oe,"61")},(function(t){return r(n,void 0,{bridgeProps:{sus$$:o,ctx$$:t,error$$:e}})}))}))}))}function je(e){var t=(()=>{function t(){var e;P(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return _(e=O(this,t,[].concat(r)),"drop",null),e}return A(t,a.Component),j(t,[{key:"componentWillUnmount",value:function(){r(this.drop)}},{key:"render",value:function(){var t=this,o=this.props,a=o.forwardedRef,u=D(o,xe);return k.createElement(Z,{_nk:"".concat(Ne,"11")},(function(){var o=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).attach;return k.createElement(e,x({ref:function(e){[Ae,Ie].every((function(t){return!c(n(e,t))}))||(t.drop=r(o,void 0,e),h(a))||(v(a)&&"current"in a?a.current=e:r(a,void 0,e))}},u,{_nk:"".concat(Ne,"21")}))}))}}])})();return c(e.prototype.componentDidMount)&&(e.prototype._componentDidMount=e.prototype.componentDidMount,e.prototype.componentDidMount=function(){var t=this;l((function(){return e.prototype._componentDidMount.call(t)}))}),c(a.forwardRef)?y(a.forwardRef((function(e,n){return k.createElement(t,x({},e,{forwardedRef:n,_nk:"".concat(Ne,"31")}))})),e):y(t,e)}function _e(e,t){var n,o;[a.useRef,a.useContext,a.useEffect].some((function(e){return!c(e)}))||(o=a.useContext(Q))&&(n=a.useRef({}).current,o=o.attach,n[e]=t,n.drop=o(n),a.useEffect((function(){return function(){return r(n.drop)}}),[]))}var xe=["forwardedRef"],Ne="XKTv",Ae="componentDidActivate",Ie="componentWillUnactivate",Be=(d=_e.bind(null,Ae),_e.bind(null,Ie)),$e=["id","autoFreeze","contentProps"],Ue="bNyU",Te=a.Suspense?function(e){var t=e.freeze,n=e.children;return e=e.placeholder,k.createElement(a.Suspense,{fallback:void 0===e?null:e,_nk:"".concat("Leb+","11")},k.createElement(ae,{freeze:t,_nk:"".concat("Leb+","21")},n))}:function(e){return e.children},De=(()=>{function e(t){var o;P(this,e);for(var a=arguments.length,c=new Array(1<a?a-1:0),u=1;u<a;u++)c[u-1]=arguments[u];return _(o=O(this,e,[t].concat(c)),"eventBus",new i),_(o,"listeners",new Map),_(o,"wrapper",null),_(o,"cache",void 0),_(o,"unmounted",!1),_(o,"safeSetState",(function(e,t){o.unmounted||o.setState(e,t)})),_(o,"freezeTimeout",null),_(o,"attach",(function(e){var t=o.listeners;return e?(e.isKeepAlive&&l((function(){var t,n=(t=o.props).id;(t=t.store.get(n)).aliveNodesId=new Set([].concat(W(t.aliveNodesId),[e.id]))})),t.set(e,_(_({},Ae,(function(){return r(e,Ae)})),Ie,(function(){return r(e,Ie)}))),function(){t.delete(e)}):function(){return null}})),_(o,"contextValue",{id:o.props.id,attach:o.attach}),_(o,"drop",(function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).delay,t=void 0===e?1200:e;return new Promise((function(e){var r,a=o.props,c=a.scope,u=a.id,i=function(){clearTimeout(r),o.eventBus.off(Ie,i),o.cache.willDrop=!0,c.nodes.delete(u),c.helpers=T({},c.helpers),c.smartForceUpdate((function(){return e(!0)}))};n(o.cache,"cached")||n(o.cache,"willDrop")?i():(o.eventBus.on(Ie,i),r=setTimeout((function(){o.eventBus.off(Ie,i),e(!1)}),t))}))})),_(o,"refresh",(function(){return new Promise((function(e){n(o.cache,"cached")&&e(!1),o.safeSetState({key:Math.random()},(function(){return e(!0)}))}))})),o.state={children:t.children,bridgeProps:t.bridgeProps,key:Math.random(),freeze:!1},o}return A(e,a.PureComponent),j(e,[{key:"componentDidMount",value:function(){var e,t=this,n=(r=this.props).store,r=r.id,o=this.listeners,a=this.wrapper;if(!n.has(r)){try{e=W(a.children)}catch(c){e=[a.children]}this.cache=_(_({listeners:o,aliveNodesId:[],inited:!1,cached:!1,wrapper:a,nodes:e},Ae,(function(){return t[Ae]()})),Ie,(function(){return t[Ie]()})),n.set(r,this.cache)}}},{key:"componentWillUnmount",value:function(){var e=(n=this.props).store,t=n.keepers,n=n.id;try{var r=e.get(n);r.nodes.forEach((function(e){r.wrapper.appendChild(e)}))}catch(o){}e.delete(n),t.delete(n),this.unmounted=!0}},{key:Ae,value:function(){clearTimeout(this.freezeTimeout),this.safeSetState({freeze:!1}),this.eventBus.emit(Ae),this.listeners.forEach((function(e){return r(e,[Ae])}))}},{key:Ie,value:function(){var e=this;this.eventBus.emit(Ie),W(this.listeners).reverse().forEach((function(e){return e=L(e,2)[1],r(e,[Ie])})),clearTimeout(this.freezeTimeout),this.freezeTimeout=setTimeout((function(){s.flushSync((function(){e.safeSetState({freeze:!0})}))}),1e3)}},{key:"render",value:function(){var e,t=this,n=(e=this.props).id,r=void 0===(r=e.autoFreeze)||r,o=void 0===(o=e.contentProps)?{}:o,a=(D(e,$e),e=this.state).children,c=e.bridgeProps,u=e.key;return k.createElement(Te,{freeze:r&&e.freeze,_nk:"".concat(Ue,"11")},k.createElement("div",{ref:function(e){t.wrapper=e},_nk:"".concat(Ue,"21")},k.createElement("div",x({},o,{key:"keeper-container",className:"ka-content ".concat(o.className||"")}),k.createElement(Pe,{id:n,bridgeProps:c,_nk:"".concat(Ue,"31")},k.createElement(Y,{value:this.contextValue,_nk:"".concat(Ue,"41")},k.Children.map(a,(function(e,t){return k.cloneElement(e,{key:"".concat(e.key||"",":").concat(u,":").concat(t)})})))))))}}])})(),Re=["children"],ze="UVSV",Le="drop",Me="refresh",We=(()=>{function e(){var a;P(this,e);for(var c=arguments.length,u=new Array(c),i=0;i<c;i++)u[i]=arguments[i];return _(a=O(this,e,[].concat(u)),"store",new Map),_(a,"nodes",new Map),_(a,"keepers",new Map),_(a,"debouncedForceUpdate",o((function(e){return a.forceUpdate(e)}))),_(a,"updateCallbackList",[]),_(a,"smartForceUpdate",(function(e){a.updateCallbackList.push(e),a.debouncedForceUpdate((function(){a.updateCallbackList.forEach((function(e){return r(e)})),a.updateCallbackList=[]}))})),_(a,"update",(function(e,t){return new Promise((function(n){var r=a.keepers.get(e),o=!r,c=Date.now(),u=a.nodes.get(e)||null;a.nodes.set(e,T(T({id:e,createTime:c,updateTime:c},u),t)),o?(a.helpers=T({},a.helpers),a.forceUpdate(n)):(c=t.children,r.setState({children:c,bridgeProps:t.bridgeProps},n))}))})),_(a,"keep",(function(e,t){return new Promise((function(n){a.update(e,T({id:e},t)).then((function(){n(a.store.get(e))}))}))})),_(a,"getCachingNodesByName",(function(e){return a.getCachingNodes().filter((function(t){return e instanceof RegExp?e.test(t.name):t.name===e}))})),_(a,"getScopeIds",(function(e){var r=function(e){var t=n(a.getCache(e),"aliveNodesId",[]);return 0<t.size?[e,W(t).map(r)]:[e].concat(W(t))};return t(e.map((function(e){return r(e)})))})),_(a,"dropById",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[[e],Le].concat(n))})),_(a,"dropScopeByIds",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[a.getScopeIds(e),Le].concat(n))})),_(a,"drop",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[a.getCachingNodesByName(e).map((function(e){return e.id})),Le].concat(n))})),_(a,"dropScope",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.dropScopeByIds.apply(a,[a.getCachingNodesByName(e).map((function(e){return e.id}))].concat(n))})),_(a,"refreshById",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[[e],Me].concat(n))})),_(a,"refreshScopeByIds",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[a.getScopeIds(e),Me].concat(n))})),_(a,"refresh",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[a.getCachingNodesByName(e).map((function(e){return e.id})),Me].concat(n))})),_(a,"refreshScope",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.refreshScopeByIds.apply(a,[a.getCachingNodesByName(e).map((function(e){return e.id}))].concat(n))})),_(a,"handleNodes",(function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Le,n=arguments.length,o=new Array(2<n?n-2:0),c=2;c<n;c++)o[c-2]=arguments[c];return new Promise((function(n){var c=[];e.forEach((function(e){a.store.get(e)&&(e=a.keepers.get(e),c.push(e))})),0===c.length?n(!1):Promise.all(c.map((function(e){return r.apply(void 0,[e,t].concat(o))}))).then((function(e){return n(e.every(Boolean))}))}))})),_(a,"clear",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.handleNodes.apply(a,[a.getCachingNodes().map((function(e){return e.id})),Le].concat(t))})),_(a,"getCache",(function(e){return a.store.get(e)})),_(a,"getNode",(function(e){return a.nodes.get(e)})),_(a,"getCachingNodes",(function(){return W(a.nodes.values())})),_(a,"helpers",{keep:a.keep,update:a.update,drop:a.drop,dropScope:a.dropScope,dropById:a.dropById,dropScopeByIds:a.dropScopeByIds,refresh:a.refresh,refreshScope:a.refreshScope,refreshById:a.refreshById,refreshScopeByIds:a.refreshScopeByIds,getScopeIds:a.getScopeIds,clear:a.clear,getCache:a.getCache,getNode:a.getNode,getCachingNodes:a.getCachingNodes}),a}return A(e,a.Component),j(e,[{key:"render",value:function(){var e=this,t=void 0===(t=this.props.children)?null:t;return k.createElement(q,{value:this.helpers,_nk:"".concat(ze,"11")},t,k.createElement("div",{style:{display:"none"},_nk:"".concat(ze,"21")},W(this.nodes.values()).map((function(t){var n=t.children,r=D(t,Re);return k.createElement(De,x({key:r.id},r,{scope:e,store:e.store,keepers:e.keepers,ref:function(t){e.keepers.set(r.id,t)},_nk:"iAr".concat(ze,"31")}),n)}))))}}])})(),Ve=["id"],Fe=["id"],Ke=["forwardedRef"],qe=["forwardedRef"],He="X7Aa";function Xe(e){return{drop:e.drop,dropScope:e.dropScope,refresh:e.refresh,refreshScope:e.refreshScope,clear:e.clear,getCachingNodes:e.getCachingNodes}}function Ge(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return!!f(e)&&(e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight)}function Je(e){return c(n(w,"document.querySelectorAll"))?[].concat(W(m(r(e,"querySelectorAll","*"),[])),[e]).filter(Ge):[]}var Qe,Ye=["_helpers","id","children"],Ze=["_helpers","id","name"],et=n(w,"document.body"),tt=n(w,"document.scrollingElement",n(w,"document.documentElement",{})),nt=(()=>{function e(n){var o;return P(this,e),_(o=O(this,e,[n]),"id",null),_(o,"isKeepAlive",!0),_(o,"cached",!1),_(o,"inject",(function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=(a=o.props).id,n=a.saveScrollPosition,a=a._helpers.getCache(t);try{a.nodes.forEach((function(e){o.placeholder.appendChild(e)})),e&&n&&r(a.revertScrollPos)}catch(c){}})),_(o,"eject",(function(){var e,n=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],a=(u=o.props).id,c=u._helpers.getCache(a),u=t(t([o.props.saveScrollPosition]).map((function(e){return!0===e?c.nodes:"screen"===e?[tt,et]:W(m(r(w,"document.querySelectorAll",e),[]))}))).filter(Boolean);try{n&&0<u.length&&(c.revertScrollPos=(e=W(new Set(W(t(u.map(Je))))).map((function(e){return[e,{x:e.scrollLeft,y:e.scrollTop}]})),function(){e.forEach((function(e){var t=(e=L(e,2))[0],n=(e=e[1]).x;e=e.y,t.scrollLeft=n,t.scrollTop=e}))})),c.nodes.forEach((function(e){n?o.placeholder.removeChild(e):c.wrapper.appendChild(e)}))}catch(i){}})),_(o,"init",(function(){var e=(a=o.props)._helpers,t=a.id,n=a.children,a=D(a,Ye);e.keep(t,T({children:n,getInstance:function(){return o}},a)).then((function(e){e&&(o.inject(),e.inited?r(o,Ae):e.inited=!0,o.cached=!1)}))})),_(o,"update",(function(){var e=(r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})._helpers,t=r.id,n=r.name,r=D(r,Ze);e&&!o.cached&&e.update(t,T({name:n,getInstance:function(){return o}},r))})),o.id=n.id,o.init(),[Ae,Ie].forEach((function(e){o[e]=function(){var t,n=(t=o.props).id,a=(t=t._helpers).getCache(n);(t=t.getNode(n))&&e===Ae&&(t.updateTime=Date.now()),n=e===Ie,!a||a.willDrop?o.cached&&!n&&o.init():(r(a,e),a.cached=n,o.cached=n)}})),o}return A(e,a.Component),j(e,[{key:"shouldComponentUpdate",value:function(e){return this.update(e),!1}},{key:"componentWillUnmount",value:function(){var e=(n=this.props).id,t=n._helpers,n=void 0===(n=n.when)||n,o=t.getCache(e);n=r(n);var a=(n=L(g(n)?n:[n],2))[0];n=n[1],o&&(this.eject(),delete o.getInstance,a||(n?([o].concat(W(t.getScopeIds([e]).map((function(e){return t.getCache(e)})))).filter(Boolean).forEach((function(e){e.willDrop=!0})),l((function(){return t.dropScopeByIds([e])}))):(o.willDrop=!0,l((function(){return t.dropById(e)})))),r(this,Ie))}},{key:"render",value:function(){var e=this,t=void 0===(t=(this.props||{}).wrapperProps)?{}:t;return k.createElement("div",x({},t,{key:"keep-alive-placeholder",className:"ka-wrapper ".concat(t.className||""),ref:function(t){e.placeholder=t}}))}}])})();function rt(e){var t=e.idPrefix,r=e.helpers,o=e.props;return(e=h(r))?n(o,"children",null):k.createElement(b,{prefix:t,key:o._nk,manualKey:o.cacheKey,_nk:"".concat(He,"11")},(function(e){var t=o.cacheKey||e;return k.createElement(Ce,{key:t,id:t,_nk:"".concat(He,"21")},(function(e){return k.createElement(Qe,x({key:t},o,e,{id:t,_helpers:r,_nk:"".concat(He,"31")}))}))}))}_(nt,"defaultProps",{saveScrollPosition:!0}),nt=c(n(w,"document.getElementById"))?(Qe=je(nt),c(a.useContext)?function(e){var t=e.id;return e=D(e,Ve),rt({idPrefix:t,helpers:K(),props:e})}:function(e){var t=e.id,n=D(e,Fe);return k.createElement(H,{_nk:"".concat(He,"41")},(function(e){return rt({idPrefix:t,helpers:e,props:n})}))}):function(e){e=e.children;var t=void 0===(t=(n=this.props||{}).wrapperProps)?{}:t,n=void 0===(n=n.contentProps)?{}:n;return k.createElement("div",x({},t,{key:"keep-alive-placeholder",className:"ka-wrapper ".concat(t.className||"")}),k.createElement("div",x({},n,{key:"keeper-container",className:"ka-content ".concat(n.className||"")}),e))},e.AliveScope=We,e.KeepAlive=nt,e.NodeKey=b,e.autoFixContext=ce,e.createContext=function(e,t){return e=u(e,t),pe(e),e},e.default=nt,e.fixContext=pe,e.useActivate=d,e.useAliveController=function(){var e;return c(a.useContext)&&(e=K())?Xe(e):{}},e.useUnactivate=Be,e.withActivation=je,e.withAliveScope=function(e){function t(t){var n=t.helpers;return k.createElement(e,x({},t.props,n,{ref:t.forwardedRef,_nk:"".concat(He,"51")}))}var n=c(a.useContext)?function(e){var n=e.forwardedRef;return e=D(e,Ke),t({helpers:Xe(K()||{}),props:e,forwardedRef:n})}:function(e){var n=e.forwardedRef,r=D(e,qe);return k.createElement(H,{_nk:"".concat(He,"42")},(function(){return t({helpers:Xe(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),props:r,forwardedRef:n})}))};return c(a.forwardRef)?y(a.forwardRef((function(e,t){return k.createElement(n,x({},e,{forwardedRef:t,_nk:"".concat(He,"61")}))})),e):y(n,e)},Object.defineProperty(e,"__esModule",{value:!0})}(O.exports,t(),n(),r(),o(),y(),a(),m(),c(),u(),g(),i(),l(),s(),p(),f(),w(),d(),h(),v(),b())),O.exports}function C(){return S||(S=1,E.exports=P()),E.exports}var j=C();const _=e(j);export{_ as K,j as r};
