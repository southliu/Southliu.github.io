import{A as e,d as n,u as t,e as r,K as a,f as l}from"./rc-util@5.44.4_react-dom@19.1.1_react@19.1.1__react@19.1.1.Cptqj8wH.js";import{g as o,j as u,i,d as c,f as d,h as s,k as f,r as v}from"./@babel_runtime@7.28.3.BsXYqacS.js";import{u as p,b as h,B as m}from"./rc-select@14.16.8_react-dom_cc80e9af85a483474ef754b96054fb57.D3oyo4EZ.js";import{r as g}from"./react@19.1.1.DFOJwFPq.js";import{a as b,c as y,U as C,T as k}from"./rc-tree@5.13.1_react-dom@19.1.1_react@19.1.1__react@19.1.1.BaGGq7yS.js";import"./classnames@2.5.1.DzaQuX-8.js";import"./rc-overflow@1.4.1_react-dom_cc4ea89628553b129a8da50b36cb88c0.BA4GRIeX.js";import"./react-dom@19.1.1_react@19.1.1.DEXqxQ-g.js";import"./rc-resize-observer@1.4.3_re_417e6ee79a83d8d6def766a6be83681f.C5AGUuAA.js";import"./rc-motion@2.9.5_react-dom@19.1.1_react@19.1.1__react@19.1.1.DpBCifG8.js";var E=function(e){return!e||e.disabled||e.disableCheckbox||!1===e.checkable},S=function(e){return null==e};var w=function(){return null},x=["children","value"];function D(n){return e(n).map(function(e){if(!g.isValidElement(e)||!e.type)return null;var n=e,t=n.key,r=n.props,a=r.children,l=r.value,u=i(r,x),c=o({key:t,value:l},u),d=D(a);return d.length&&(c.children=d),c}).filter(function(e){return e})}function M(e){if(!e)return e;var t=o({},e);return"props"in t||Object.defineProperty(t,"props",{get:function(){return n(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),t}}),t}function I(e){var n=g.useRef();n.current=e;var t=g.useCallback(function(){return n.current.apply(n,arguments)},[]);return t}function N(e,n,t){return g.useMemo(function(){if(e){if(t){var r=o({id:"id",pId:"pId",rootPId:null},"object"===d(t)?t:{});return function(e,n){var t=n.id,r=n.pId,a=n.rootPId,l=new Map,u=[];return e.forEach(function(e){var n=e[t],r=o(o({},e),{},{key:e.key||n});l.set(n,r)}),l.forEach(function(e){var n=e[r],t=l.get(n);t?(t.children=t.children||[],t.children.push(e)):n!==a&&null!==a||u.push(e)}),u}(e,r)}return e}return D(n)},[n,t,e])}var T=g.createContext(null),L=g.createContext(null),K={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},_=function(e,n){var l=p(),o=l.prefixCls,i=l.multiple,c=l.searchValue,d=l.toggleOpen,h=l.open,m=l.notFoundContent,b=g.useContext(L),y=b.virtual,S=b.listHeight,w=b.listItemHeight,x=b.listItemScrollOffset,D=b.treeData,M=b.fieldNames,I=b.onSelect,N=b.dropdownMatchSelectWidth,_=b.treeExpandAction,V=b.treeTitleRender,P=b.onPopupScroll,O=b.leftMaxCount,H=b.leafCountOnly,A=b.valueEntities,R=g.useContext(T),j=R.checkable,W=R.checkedKeys,F=R.halfCheckedKeys,U=R.treeExpandedKeys,G=R.treeDefaultExpandAll,z=R.treeDefaultExpandedKeys,B=R.onTreeExpand,J=R.treeIcon,q=R.showTreeIcon,Q=R.switcherIcon,X=R.treeLine,Y=R.treeNodeFilterProp,Z=R.loadData,$=R.treeLoadedKeys,ee=R.treeMotion,ne=R.onTreeLoad,te=R.keyEntities,re=g.useRef(),ae=t(function(){return D},[h,D],function(e,n){return n[0]&&e[1]!==n[1]}),le=g.useMemo(function(){return j?{checked:W,halfChecked:F}:null},[j,W,F]);g.useEffect(function(){var e;h&&!i&&W.length&&(null===(e=re.current)||void 0===e||e.scrollTo({key:W[0]}))},[h]);var oe=function(e){e.preventDefault()},ue=function(e,n){var t=n.node;j&&E(t)||(I(t.key,{selected:!W.includes(t.key)}),i||d(!1))},ie=g.useState(z),ce=s(ie,2),de=ce[0],se=ce[1],fe=g.useState(null),ve=s(fe,2),pe=ve[0],he=ve[1],me=g.useMemo(function(){return U?u(U):c?pe:de},[de,pe,U,c]),ge=String(c).toLowerCase(),be=function(e){return!!ge&&String(e[Y]).toLowerCase().includes(ge)};g.useEffect(function(){c&&he(function(e,n){var t=[];return function e(r){r.forEach(function(r){var a=r[n.children];a&&(t.push(r[n.value]),e(a))})}(e),t}(D,M))},[c]);var ye=g.useState(function(){return new Map}),Ce=s(ye,2),ke=Ce[0],Ee=Ce[1];g.useEffect(function(){O&&Ee(new Map)},[O]);var Se=r(function(e){var n=e[M.value];return!W.includes(n)&&(null!==O&&(O<=0||!(!H||!O)&&function(e){var n=e[M.value];if(!ke.has(n)){var t=A.get(n);if(0===(t.children||[]).length)ke.set(n,!1);else{var r=t.children.filter(function(e){return!e.node.disabled&&!e.node.disableCheckbox&&!W.includes(e.node[M.value])}).length;ke.set(n,r>O)}}return ke.get(n)}(e)))}),we=function e(n){var t,r=v(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(!a.disabled&&!1!==a.selectable){if(!c)return a;if(be(a))return a;if(a[M.children]){var l=e(a[M.children]);if(l)return l}}}}catch(o){r.e(o)}finally{r.f()}return null},xe=g.useState(null),De=s(xe,2),Me=De[0],Ie=De[1],Ne=te[Me];g.useEffect(function(){if(h){var e,n=null;n=i||!W.length||c?(e=we(ae))?e[M.value]:null:W[0],Ie(n)}},[h,c]),g.useImperativeHandle(n,function(){var e;return{scrollTo:null===(e=re.current)||void 0===e?void 0:e.scrollTo,onKeyDown:function(e){var n;switch(e.which){case a.UP:case a.DOWN:case a.LEFT:case a.RIGHT:null===(n=re.current)||void 0===n||n.onKeyDown(e);break;case a.ENTER:if(Ne){var t=Se(Ne.node),r=(null==Ne?void 0:Ne.node)||{},l=r.selectable,o=r.value,u=r.disabled;!1===l||u||t||ue(0,{node:{key:Me},selected:!W.includes(o)})}break;case a.ESC:d(!1)}},onKeyUp:function(){}}});var Te=t(function(){return!c},[c,U||de],function(e,n){var t=s(e,1)[0],r=s(n,2),a=r[0],l=r[1];return t!==a&&!(!a&&!l)})?Z:null;if(0===ae.length)return g.createElement("div",{role:"listbox",className:"".concat(o,"-empty"),onMouseDown:oe},m);var Le={fieldNames:M};return $&&(Le.loadedKeys=$),me&&(Le.expandedKeys=me),g.createElement("div",{onMouseDown:oe},Ne&&h&&g.createElement("span",{style:K,"aria-live":"assertive"},Ne.node.value),g.createElement(C.Provider,{value:{nodeDisabled:Se}},g.createElement(k,f({ref:re,focusable:!1,prefixCls:"".concat(o,"-tree"),treeData:ae,height:S,itemHeight:w,itemScrollOffset:x,virtual:!1!==y&&!1!==N,multiple:i,icon:J,showIcon:q,switcherIcon:Q,showLine:X,loadData:Te,motion:ee,activeKey:Me,checkable:j,checkStrictly:!0,checkedKeys:le,selectedKeys:j?[]:W,defaultExpandAll:G,titleRender:V},Le,{onActiveChange:Ie,onSelect:ue,onCheck:ue,onExpand:function(e){se(e),he(e),B&&B(e)},onLoad:ne,filterTreeNode:be,expandAction:_,onScroll:P}))))},V=g.forwardRef(_),P="SHOW_ALL",O="SHOW_PARENT",H="SHOW_CHILD";function A(e,n,t,r){var a=new Set(e);return n===H?e.filter(function(e){var n=t[e];return!(n&&n.children&&n.children.some(function(e){var n=e.node;return a.has(n[r.value])})&&n.children.every(function(e){var n=e.node;return E(n)||a.has(n[r.value])}))}):n===O?e.filter(function(e){var n=t[e],r=n?n.parent:null;return!r||E(r.node)||!a.has(r.key)}):e}var R=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","maxCount","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","listItemScrollOffset","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion","treeTitleRender","onPopupScroll"];var j=g.forwardRef(function(e,t){var r,a,v=e.id,p=e.prefixCls,C=void 0===p?"rc-tree-select":p,k=e.value,E=e.defaultValue,x=e.onChange,D=e.onSelect,K=e.onDeselect,_=e.searchValue,O=e.inputValue,j=e.onSearch,W=e.autoClearSearchValue,F=void 0===W||W,U=e.filterTreeNode,G=e.treeNodeFilterProp,z=void 0===G?"value":G,B=e.showCheckedStrategy,J=e.treeNodeLabelProp,q=e.multiple,Q=e.treeCheckable,X=e.treeCheckStrictly,Y=e.labelInValue,Z=e.maxCount,$=e.fieldNames,ee=e.treeDataSimpleMode,ne=e.treeData,te=e.children,re=e.loadData,ae=e.treeLoadedKeys,le=e.onTreeLoad,oe=e.treeDefaultExpandAll,ue=e.treeExpandedKeys,ie=e.treeDefaultExpandedKeys,ce=e.onTreeExpand,de=e.treeExpandAction,se=e.virtual,fe=e.listHeight,ve=void 0===fe?200:fe,pe=e.listItemHeight,he=void 0===pe?20:pe,me=e.listItemScrollOffset,ge=void 0===me?0:me,be=e.onDropdownVisibleChange,ye=e.dropdownMatchSelectWidth,Ce=void 0===ye||ye,ke=e.treeLine,Ee=e.treeIcon,Se=e.showTreeIcon,we=e.switcherIcon,xe=e.treeMotion,De=e.treeTitleRender,Me=e.onPopupScroll,Ie=i(e,R),Ne=h(v),Te=Q&&!X,Le=Q||X,Ke=X||Y,_e=Le||q,Ve=l(E,{value:k}),Pe=s(Ve,2),Oe=Pe[0],He=Pe[1],Ae=g.useMemo(function(){return Q?B||H:P},[B,Q]),Re=g.useMemo(function(){return function(e){var n=e||{},t=n.label,r=n.value;return{_title:t?[t]:["title","label"],value:r||"value",key:r||"value",children:n.children||"children"}}($)},[JSON.stringify($)]),je=l("",{value:void 0!==_?_:O,postState:function(e){return e||""}}),We=s(je,2),Fe=We[0],Ue=We[1],Ge=N(ne,te,ee),ze=function(e,n){return g.useMemo(function(){return y(e,{fieldNames:n,initWrapper:function(e){return o(o({},e),{},{valueEntities:new Map})},processEntity:function(e,t){var r=e.node[n.value];t.valueEntities.set(r,e)}})},[e,n])}(Ge,Re),Be=ze.keyEntities,Je=ze.valueEntities,qe=g.useCallback(function(e){var n=[],t=[];return e.forEach(function(e){Je.has(e)?t.push(e):n.push(e)}),{missingRawValues:n,existRawValues:t}},[Je]),Qe=function(e,n,t){var r=t.fieldNames,a=t.treeNodeFilterProp,l=t.filterTreeNode,u=r.children;return g.useMemo(function(){if(!n||!1===l)return e;var t="function"==typeof l?l:function(e,t){return String(t[a]).toUpperCase().includes(n.toUpperCase())};return function e(r){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.reduce(function(r,l){var i=l[u],d=a||t(n,M(l)),s=e(i||[],d);return(d||s.length)&&r.push(o(o({},l),{},c({isLeaf:void 0},u,s))),r},[])}(e)},[e,n,u,a,l])}(Ge,Fe,{fieldNames:Re,treeNodeFilterProp:z,filterTreeNode:U}),Xe=g.useCallback(function(e){if(e){if(J)return e[J];for(var n=Re._title,t=0;t<n.length;t+=1){var r=e[n[t]];if(void 0!==r)return r}}},[Re,J]),Ye=g.useCallback(function(e){var n=function(e){return Array.isArray(e)?e:void 0!==e?[e]:[]}(e);return n.map(function(e){return function(e){return!e||"object"!==d(e)}(e)?{value:e}:e})},[]),Ze=g.useCallback(function(e){return Ye(e).map(function(e){var n,t,r=e.label,a=e.value,l=e.halfChecked,o=Je.get(a);if(o)r=De?De(o.node):null!==(t=r)&&void 0!==t?t:Xe(o.node),n=o.node.disabled;else if(void 0===r){r=Ye(Oe).find(function(e){return e.value===a}).label}return{label:r,value:a,halfChecked:l,disabled:n}})},[Je,Xe,Ye,Oe]),$e=g.useMemo(function(){return Ye(null===Oe?[]:Oe)},[Ye,Oe]),en=g.useMemo(function(){var e=[],n=[];return $e.forEach(function(t){t.halfChecked?n.push(t):e.push(t)}),[e,n]},[$e]),nn=s(en,2),tn=nn[0],rn=nn[1],an=g.useMemo(function(){return tn.map(function(e){return e.value})},[tn]),ln=function(e,n,t,r){return g.useMemo(function(){var a=function(e){return e.map(function(e){return e.value})},l=a(e),o=a(n),i=l.filter(function(e){return!r[e]}),c=l,d=o;if(t){var s=b(l,!0,r);c=s.checkedKeys,d=s.halfCheckedKeys}return[Array.from(new Set([].concat(u(i),u(c)))),d]},[e,n,t,r])}(tn,rn,Te,Be),on=s(ln,2),un=on[0],cn=on[1],dn=g.useMemo(function(){var e=A(un,Ae,Be,Re).map(function(e){var n,t;return null!==(n=null===(t=Be[e])||void 0===t||null===(t=t.node)||void 0===t?void 0:t[Re.value])&&void 0!==n?n:e}).map(function(e){var n=tn.find(function(n){return n.value===e}),t=Y?null==n?void 0:n.label:null==De?void 0:De(n);return{value:e,label:t}}),n=Ze(e),t=n[0];return!_e&&t&&S(t.value)&&S(t.label)?[]:n.map(function(e){var n;return o(o({},e),{},{label:null!==(n=e.label)&&void 0!==n?n:e.value})})},[Re,_e,un,tn,Ze,Ae,Be]),sn=(r=dn,a=g.useRef({valueLabels:new Map}),g.useMemo(function(){var e=a.current.valueLabels,n=new Map,t=r.map(function(t){var r=t.value,a=t.label,l=null!=a?a:e.get(r);return n.set(r,l),o(o({},t),{},{label:l})});return a.current.valueLabels=n,[t]},[r])),fn=s(sn,1)[0],vn=g.useMemo(function(){return!_e||"SHOW_CHILD"!==Ae&&!X&&Q?null:Z},[Z,_e,X,Ae,Q]),pn=I(function(e,t,r){var a=A(e,Ae,Be,Re);if(!(vn&&a.length>vn)){var l=Ze(e);if(He(l),F&&Ue(""),x){var o=e;Te&&(o=a.map(function(e){var n=Je.get(e);return n?n.node[Re.value]:e}));var i=t||{triggerValue:void 0,selected:void 0},c=i.triggerValue,d=i.selected,s=o;if(X){var f=rn.filter(function(e){return!o.includes(e.value)});s=[].concat(u(s),u(f))}var v=Ze(s),p={preValue:tn,triggerValue:c},h=!0;(X||"selection"===r&&!d)&&(h=!1),function(e,t,r,a,l,o){var u=null,i=null;function c(){i||(i=[],function e(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n.map(function(n,c){var d="".concat(a,"-").concat(c),s=n[o.value],f=r.includes(s),v=e(n[o.children]||[],d,f),p=g.createElement(w,n,v.map(function(e){return e.node}));if(t===s&&(u=p),f){var h={pos:d,node:p,children:v};return l||i.push(h),h}return null}).filter(function(e){return e})}(a),i.sort(function(e,n){var t=e.node.props.value,a=n.node.props.value;return r.indexOf(t)-r.indexOf(a)}))}Object.defineProperty(e,"triggerNode",{get:function(){return n(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),c(),u}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return n(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),c(),l?i:i.map(function(e){return e.node})}})}(p,c,e,Ge,h,Re),Le?p.checked=d:p.selected=d;var m=Ke?v:v.map(function(e){return e.value});x(_e?m:m[0],Ke?null:v.map(function(e){return e.label}),p)}}}),hn=g.useCallback(function(e,n){var t,r=n.selected,a=n.source,l=Be[e],o=null==l?void 0:l.node,i=null!==(t=null==o?void 0:o[Re.value])&&void 0!==t?t:e;if(_e){var c=r?[].concat(u(an),[i]):un.filter(function(e){return e!==i});if(Te){var d,s=qe(c),f=s.missingRawValues,v=s.existRawValues.map(function(e){return Je.get(e).key});if(r)d=b(v,!0,Be).checkedKeys;else d=b(v,{halfCheckedKeys:cn},Be).checkedKeys;c=[].concat(u(f),u(d.map(function(e){return Be[e].node[Re.value]})))}pn(c,{selected:r,triggerValue:i},a||"option")}else pn([i],{selected:!0,triggerValue:i},"option");r||!_e?null==D||D(i,M(o)):null==K||K(i,M(o))},[qe,Je,Be,Re,_e,an,pn,Te,D,K,un,cn,Z]),mn=g.useCallback(function(e){if(be){var t={};Object.defineProperty(t,"documentClickClose",{get:function(){return n(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),be(e,t)}},[be]),gn=I(function(e,n){var t=e.map(function(e){return e.value});"clear"!==n.type?n.values.length&&hn(n.values[0].value,{selected:!1,source:"selection"}):pn(t,{},"selection")}),bn=g.useMemo(function(){return{virtual:se,dropdownMatchSelectWidth:Ce,listHeight:ve,listItemHeight:he,listItemScrollOffset:ge,treeData:Qe,fieldNames:Re,onSelect:hn,treeExpandAction:de,treeTitleRender:De,onPopupScroll:Me,leftMaxCount:void 0===Z?null:Z-fn.length,leafCountOnly:"SHOW_CHILD"===Ae&&!X&&!!Q,valueEntities:Je}},[se,Ce,ve,he,ge,Qe,Re,hn,de,De,Me,Z,fn.length,Ae,X,Q,Je]),yn=g.useMemo(function(){return{checkable:Le,loadData:re,treeLoadedKeys:ae,onTreeLoad:le,checkedKeys:un,halfCheckedKeys:cn,treeDefaultExpandAll:oe,treeExpandedKeys:ue,treeDefaultExpandedKeys:ie,onTreeExpand:ce,treeIcon:Ee,treeMotion:xe,showTreeIcon:Se,switcherIcon:we,treeLine:ke,treeNodeFilterProp:z,keyEntities:Be}},[Le,re,ae,le,un,cn,oe,ue,ie,ce,Ee,xe,Se,we,ke,z,Be]);return g.createElement(L.Provider,{value:bn},g.createElement(T.Provider,{value:yn},g.createElement(m,f({ref:t},Ie,{id:Ne,prefixCls:C,mode:_e?"multiple":void 0,displayValues:fn,onDisplayValuesChange:gn,searchValue:Fe,onSearch:function(e){Ue(e),null==j||j(e)},OptionList:V,emptyOptions:!Ge.length,onDropdownVisibleChange:mn,dropdownMatchSelectWidth:Ce}))))});j.TreeNode=w,j.SHOW_ALL=P,j.SHOW_PARENT=O,j.SHOW_CHILD=H;export{j as G,P as S,w as T,O as a,H as b};
