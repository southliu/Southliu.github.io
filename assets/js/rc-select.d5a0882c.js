import{r as e,e as n}from"./react.a7da97a2.js";import"./react-is.90ab392a.js";import{w as t,m as o,C as r,K as a,d as i,o as u,h as l,b as c,A as s,c as d,x as p,u as f,y as v}from"./rc-util.b2252098.js";import{c as m}from"./classnames.71976509.js";import{e as h,d as g,f as b,b as w,h as y,c as C,s as E,g as S}from"./@babel_runtime.d775819b.js";import{F as I}from"./rc-overflow.08e2f92e.js";import{T as x}from"./@rc-component_trigger.52678524.js";import{L as D}from"./rc-virtual-list.e4d0feea.js";var N=e.createContext(null);function M(){return e.useContext(N)}function P(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250,t=e.useRef(null),o=e.useRef(null);return e.useEffect((function(){return function(){window.clearTimeout(o.current)}}),[]),[function(){return t.current},function(e){(e||null===t.current)&&(t.current=e),window.clearTimeout(o.current),o.current=window.setTimeout((function(){t.current=null}),n)}]}var R=function(n){var t,o=n.className,r=n.customizeIcon,a=n.customizeIconProps,i=n.onMouseDown,u=n.onClick,l=n.children;return t="function"==typeof r?r(a):r,e.createElement("span",{className:o,onMouseDown:function(e){e.preventDefault(),i&&i(e)},style:{userSelect:"none",WebkitUserSelect:"none"},unselectable:"on",onClick:u,"aria-hidden":!0},void 0!==t?t:e.createElement("span",{className:m(o.split(/\s+/).map((function(e){return"".concat(e,"-icon")})))},l))},O=function(n,r){var a,i,u=n.prefixCls,l=n.id,c=n.inputElement,s=n.disabled,d=n.tabIndex,p=n.autoFocus,f=n.autoComplete,v=n.editable,h=n.activeDescendantId,b=n.value,w=n.maxLength,y=n.onKeyDown,C=n.onMouseDown,E=n.onChange,S=n.onPaste,I=n.onCompositionStart,x=n.onCompositionEnd,D=n.open,N=n.attrs,M=c||e.createElement("input",null),P=M,R=P.ref,O=P.props,V=O.onKeyDown,T=O.onChange,k=O.onMouseDown,A=O.onCompositionStart,F=O.onCompositionEnd,K=O.style;return t(!("maxLength"in M.props)),M=e.cloneElement(M,g(g(g({type:"search"},O),{},{id:l,ref:o(r,R),disabled:s,tabIndex:d,autoComplete:f||"off",autoFocus:p,className:m("".concat(u,"-selection-search-input"),null===(a=M)||void 0===a||null===(i=a.props)||void 0===i?void 0:i.className),role:"combobox","aria-label":"Search","aria-expanded":D,"aria-haspopup":"listbox","aria-owns":"".concat(l,"_list"),"aria-autocomplete":"list","aria-controls":"".concat(l,"_list"),"aria-activedescendant":D?h:void 0},N),{},{value:v?b:"",maxLength:w,readOnly:!v,unselectable:v?null:"on",style:g(g({},K),{},{opacity:v?null:0}),onKeyDown:function(e){y(e),V&&V(e)},onMouseDown:function(e){C(e),k&&k(e)},onChange:function(e){E(e),T&&T(e)},onCompositionStart:function(e){I(e),A&&A(e)},onCompositionEnd:function(e){x(e),F&&F(e)},onPaste:S}))},V=e.forwardRef(O);function T(e){return Array.isArray(e)?e:void 0!==e?[e]:[]}V.displayName="Input";var k="undefined"!=typeof window&&window.document&&window.document.documentElement;function A(e){return["string","number"].includes(b(e))}function F(e){var n=void 0;return e&&(A(e.title)?n=e.title.toString():A(e.label)&&(n=e.label.toString())),n}function K(e){var n;return null!==(n=e.key)&&void 0!==n?n:e.value}var L=function(e){e.preventDefault(),e.stopPropagation()},_=function(n){var t,o,a=n.id,i=n.prefixCls,u=n.values,l=n.open,c=n.searchValue,s=n.autoClearSearchValue,d=n.inputRef,p=n.placeholder,f=n.disabled,v=n.mode,g=n.showSearch,b=n.autoFocus,y=n.autoComplete,C=n.activeDescendantId,E=n.tabIndex,S=n.removeIcon,x=n.maxTagCount,D=n.maxTagTextLength,N=n.maxTagPlaceholder,M=void 0===N?function(e){return"+ ".concat(e.length," ...")}:N,P=n.tagRender,O=n.onToggleOpen,T=n.onRemove,A=n.onInputChange,_=n.onInputPaste,j=n.onInputKeyDown,W=n.onInputMouseDown,H=n.onInputCompositionStart,z=n.onInputCompositionEnd,U=e.useRef(null),B=e.useState(0),X=h(B,2),Y=X[0],G=X[1],J=e.useState(!1),Q=h(J,2),$=Q[0],q=Q[1],Z="".concat(i,"-selection"),ee=l||"multiple"===v&&!1===s||"tags"===v?c:"",ne="tags"===v||"multiple"===v&&!1===s||g&&(l||$);function te(n,t,o,r,a){return e.createElement("span",{className:m("".concat(Z,"-item"),w({},"".concat(Z,"-item-disabled"),o)),title:F(n)},e.createElement("span",{className:"".concat(Z,"-item-content")},t),r&&e.createElement(R,{className:"".concat(Z,"-item-remove"),onMouseDown:L,onClick:a,customizeIcon:S},"×"))}t=function(){G(U.current.scrollWidth)},o=[ee],k?e.useLayoutEffect(t,o):e.useEffect(t,o);var oe=e.createElement("div",{className:"".concat(Z,"-search"),style:{width:Y},onFocus:function(){q(!0)},onBlur:function(){q(!1)}},e.createElement(V,{ref:d,open:l,prefixCls:i,id:a,inputElement:null,disabled:f,autoFocus:b,autoComplete:y,editable:ne,activeDescendantId:C,value:ee,onKeyDown:j,onMouseDown:W,onChange:A,onPaste:_,onCompositionStart:H,onCompositionEnd:z,tabIndex:E,attrs:r(n,!0)}),e.createElement("span",{ref:U,className:"".concat(Z,"-search-mirror"),"aria-hidden":!0},ee," ")),re=e.createElement(I,{prefixCls:"".concat(Z,"-overflow"),data:u,renderItem:function(n){var t=n.disabled,o=n.label,r=n.value,a=!f&&!t,i=o;if("number"==typeof D&&("string"==typeof o||"number"==typeof o)){var u=String(i);u.length>D&&(i="".concat(u.slice(0,D),"..."))}var c=function(e){e&&e.stopPropagation(),T(n)};return"function"==typeof P?function(n,t,o,r,a){return e.createElement("span",{onMouseDown:function(e){L(e),O(!l)}},P({label:t,value:n,disabled:o,closable:r,onClose:a}))}(r,i,t,a,c):te(n,i,t,a,c)},renderRest:function(e){var n="function"==typeof M?M(e):M;return te({title:n},n,!1)},suffix:oe,itemKey:K,maxCount:x});return e.createElement(e.Fragment,null,re,!u.length&&!ee&&e.createElement("span",{className:"".concat(Z,"-placeholder")},p))},j=function(n){var t=n.inputElement,o=n.prefixCls,a=n.id,i=n.inputRef,u=n.disabled,l=n.autoFocus,c=n.autoComplete,s=n.activeDescendantId,d=n.mode,p=n.open,f=n.values,v=n.placeholder,m=n.tabIndex,g=n.showSearch,b=n.searchValue,w=n.activeValue,y=n.maxLength,C=n.onInputKeyDown,E=n.onInputMouseDown,S=n.onInputChange,I=n.onInputPaste,x=n.onInputCompositionStart,D=n.onInputCompositionEnd,N=n.title,M=e.useState(!1),P=h(M,2),R=P[0],O=P[1],T="combobox"===d,k=T||g,A=f[0],K=b||"";T&&w&&!R&&(K=w),e.useEffect((function(){T&&O(!1)}),[T,w]);var L=!("combobox"!==d&&!p&&!g)&&!!K,_=void 0===N?F(A):N;return e.createElement(e.Fragment,null,e.createElement("span",{className:"".concat(o,"-selection-search")},e.createElement(V,{ref:i,prefixCls:o,id:a,open:p,inputElement:t,disabled:u,autoFocus:l,autoComplete:c,editable:k,activeDescendantId:s,value:K,onKeyDown:C,onMouseDown:E,onChange:function(e){O(!0),S(e)},onPaste:I,onCompositionStart:x,onCompositionEnd:D,tabIndex:m,attrs:r(n,!0),maxLength:T?y:void 0})),!T&&A?e.createElement("span",{className:"".concat(o,"-selection-item"),title:_,style:L?{visibility:"hidden"}:void 0},A.label):null,function(){if(A)return null;var n=L?{visibility:"hidden"}:void 0;return e.createElement("span",{className:"".concat(o,"-selection-placeholder"),style:n},v)}())};var W=function(n,t){var o=e.useRef(null),r=e.useRef(!1),i=n.prefixCls,u=n.open,l=n.mode,c=n.showSearch,s=n.tokenWithEnter,d=n.autoClearSearchValue,p=n.onSearch,f=n.onSearchSubmit,v=n.onToggleOpen,m=n.onInputKeyDown,g=n.domRef;e.useImperativeHandle(t,(function(){return{focus:function(){o.current.focus()},blur:function(){o.current.blur()}}}));var b=P(0),w=h(b,2),C=w[0],E=w[1],S=e.useRef(null),I=function(e){!1!==p(e,!0,r.current)&&v(!0)},x={inputRef:o,onInputKeyDown:function(e){var n,t=e.which;t!==a.UP&&t!==a.DOWN||e.preventDefault(),m&&m(e),t!==a.ENTER||"tags"!==l||r.current||u||null==f||f(e.target.value),n=t,[a.ESC,a.SHIFT,a.BACKSPACE,a.TAB,a.WIN_KEY,a.ALT,a.META,a.WIN_KEY_RIGHT,a.CTRL,a.SEMICOLON,a.EQUALS,a.CAPS_LOCK,a.CONTEXT_MENU,a.F1,a.F2,a.F3,a.F4,a.F5,a.F6,a.F7,a.F8,a.F9,a.F10,a.F11,a.F12].includes(n)||v(!0)},onInputMouseDown:function(){E(!0)},onInputChange:function(e){var n=e.target.value;if(s&&S.current&&/[\r\n]/.test(S.current)){var t=S.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");n=n.replace(t,S.current)}S.current=null,I(n)},onInputPaste:function(e){var n=e.clipboardData.getData("text");S.current=n},onInputCompositionStart:function(){r.current=!0},onInputCompositionEnd:function(e){r.current=!1,"combobox"!==l&&I(e.target.value)}},D="multiple"===l||"tags"===l?e.createElement(_,y({},n,x)):e.createElement(j,y({},n,x));return e.createElement("div",{ref:g,className:"".concat(i,"-selector"),onClick:function(e){e.target!==o.current&&(void 0!==document.body.style.msTouchAction?setTimeout((function(){o.current.focus()})):o.current.focus())},onMouseDown:function(e){var n=C();e.target===o.current||n||"combobox"===l||e.preventDefault(),("combobox"===l||c&&n)&&u||(u&&!1!==d&&p("",!0,!1),v())}},D)},H=e.forwardRef(W);H.displayName="Selector";var z=["prefixCls","disabled","visible","children","popupElement","containerWidth","animation","transitionName","dropdownStyle","dropdownClassName","direction","placement","builtinPlacements","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","getPopupContainer","empty","getTriggerDOMNode","onPopupVisibleChange","onPopupMouseEnter"],U=function(n,t){var o=n.prefixCls;n.disabled;var r=n.visible,a=n.children,i=n.popupElement,u=n.containerWidth,l=n.animation,c=n.transitionName,s=n.dropdownStyle,d=n.dropdownClassName,p=n.direction,f=void 0===p?"ltr":p,v=n.placement,h=n.builtinPlacements,b=n.dropdownMatchSelectWidth,E=n.dropdownRender,S=n.dropdownAlign,I=n.getPopupContainer,D=n.empty,N=n.getTriggerDOMNode,M=n.onPopupVisibleChange,P=n.onPopupMouseEnter,R=C(n,z),O="".concat(o,"-dropdown"),V=i;E&&(V=E(i));var T=e.useMemo((function(){return h||function(e){var n=!0===e?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:n,adjustY:1},htmlRegion:"scroll"}}}(b)}),[h,b]),k=l?"".concat(O,"-").concat(l):c,A=e.useRef(null);e.useImperativeHandle(t,(function(){return{getPopupElement:function(){return A.current}}}));var F=g({minWidth:u},s);return"number"==typeof b?F.width=b:b&&(F.width=u),e.createElement(x,y({},R,{showAction:M?["click"]:[],hideAction:M?["click"]:[],popupPlacement:v||("rtl"===f?"bottomRight":"bottomLeft"),builtinPlacements:T,prefixCls:O,popupTransitionName:k,popup:e.createElement("div",{ref:A,onMouseEnter:P},V),popupAlign:S,popupVisible:r,getPopupContainer:I,popupClassName:m(d,w({},"".concat(O,"-empty"),D)),popupStyle:F,getTriggerDOMNode:N,onPopupVisibleChange:M}),a)},B=e.forwardRef(U);function X(e,n){var t,o=e.key;return"value"in e&&(t=e.value),null!=o?o:void 0!==t?t:"rc-index-key-".concat(n)}function Y(e,n){var t=e||{},o=t.label||(n?"children":"label");return{label:o,value:t.value||"value",options:t.options||"options",groupLabel:t.groupLabel||o}}function G(e){var n=g({},e);return"props"in n||Object.defineProperty(n,"props",{get:function(){return i(!1,"Return type is option instead of Option instance. Please read value directly instead of reading from `props`."),n}}),n}B.displayName="SelectTrigger";var J=["id","prefixCls","className","showSearch","tagRender","direction","omitDomProps","displayValues","onDisplayValuesChange","emptyOptions","notFoundContent","onClear","mode","disabled","loading","getInputElement","getRawInputElement","open","defaultOpen","onDropdownVisibleChange","activeValue","onActiveValueChange","activeDescendantId","searchValue","autoClearSearchValue","onSearch","onSearchSplit","tokenSeparators","allowClear","suffixIcon","clearIcon","OptionList","animation","transitionName","dropdownStyle","dropdownClassName","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","placement","builtinPlacements","getPopupContainer","showAction","onFocus","onBlur","onKeyUp","onKeyDown","onMouseDown"],Q=["value","onChange","removeIcon","placeholder","autoFocus","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabIndex"];function $(e){return"tags"===e||"multiple"===e}var q=e.forwardRef((function(t,o){var r,i,d=t.id,p=t.prefixCls,f=t.className,v=t.showSearch,I=t.tagRender,x=t.direction,D=t.omitDomProps,M=t.displayValues,O=t.onDisplayValuesChange,V=t.emptyOptions,T=t.notFoundContent,k=void 0===T?"Not Found":T,A=t.onClear,F=t.mode,K=t.disabled,L=t.loading,_=t.getInputElement,j=t.getRawInputElement,W=t.open,z=t.defaultOpen,U=t.onDropdownVisibleChange,X=t.activeValue,Y=t.onActiveValueChange,G=t.activeDescendantId,q=t.searchValue,Z=t.autoClearSearchValue,ee=t.onSearch,ne=t.onSearchSplit,te=t.tokenSeparators,oe=t.allowClear,re=t.suffixIcon,ae=t.clearIcon,ie=t.OptionList,ue=t.animation,le=t.transitionName,ce=t.dropdownStyle,se=t.dropdownClassName,de=t.dropdownMatchSelectWidth,pe=t.dropdownRender,fe=t.dropdownAlign,ve=t.placement,me=t.builtinPlacements,he=t.getPopupContainer,ge=t.showAction,be=void 0===ge?[]:ge,we=t.onFocus,ye=t.onBlur,Ce=t.onKeyUp,Ee=t.onKeyDown,Se=t.onMouseDown,Ie=C(t,J),xe=$(F),De=(void 0!==v?v:xe)||"combobox"===F,Ne=g({},Ie);Q.forEach((function(e){delete Ne[e]})),null==D||D.forEach((function(e){delete Ne[e]}));var Me=e.useState(!1),Pe=h(Me,2),Re=Pe[0],Oe=Pe[1];e.useEffect((function(){Oe(u())}),[]);var Ve=e.useRef(null),Te=e.useRef(null),ke=e.useRef(null),Ae=e.useRef(null),Fe=e.useRef(null),Ke=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=e.useState(!1),o=h(t,2),r=o[0],a=o[1],i=e.useRef(null),u=function(){window.clearTimeout(i.current)};return e.useEffect((function(){return u}),[]),[r,function(e,t){u(),i.current=window.setTimeout((function(){a(e),t&&t()}),n)},u]}(),Le=h(Ke,3),_e=Le[0],je=Le[1],We=Le[2];e.useImperativeHandle(o,(function(){var e,n;return{focus:null===(e=Ae.current)||void 0===e?void 0:e.focus,blur:null===(n=Ae.current)||void 0===n?void 0:n.blur,scrollTo:function(e){var n;return null===(n=Fe.current)||void 0===n?void 0:n.scrollTo(e)}}}));var He=e.useMemo((function(){var e;if("combobox"!==F)return q;var n=null===(e=M[0])||void 0===e?void 0:e.value;return"string"==typeof n||"number"==typeof n?String(n):""}),[q,F,M]),ze="combobox"===F&&"function"==typeof _&&_()||null,Ue="function"==typeof j&&j(),Be=l(Te,null==Ue||null===(r=Ue.props)||void 0===r?void 0:r.ref),Xe=e.useState(!1),Ye=h(Xe,2),Ge=Ye[0],Je=Ye[1];c((function(){Je(!0)}),[]);var Qe=s(!1,{defaultValue:z,value:W}),$e=h(Qe,2),qe=$e[0],Ze=$e[1],en=!!Ge&&qe,nn=!k&&V;(K||nn&&en&&"combobox"===F)&&(en=!1);var tn=!nn&&en,on=e.useCallback((function(e){var n=void 0!==e?e:!en;K||(Ze(n),en!==n&&(null==U||U(n)))}),[K,en,Ze,U]),rn=e.useMemo((function(){return(te||[]).some((function(e){return["\n","\r\n"].includes(e)}))}),[te]),an=function(e,n,t){var o=!0,r=e;null==Y||Y(null);var a=t?null:function(e,n){if(!n||!n.length)return null;var t=!1,o=function e(n,o){var r=E(o),a=r[0],i=r.slice(1);if(!a)return[n];var u=n.split(a);return t=t||u.length>1,u.reduce((function(n,t){return[].concat(S(n),S(e(t,i)))}),[]).filter((function(e){return e}))}(e,n);return t?o:null}(e,te);return"combobox"!==F&&a&&(r="",null==ne||ne(a),on(!1),o=!1),ee&&He!==r&&ee(r,{source:n?"typing":"effect"}),o};e.useEffect((function(){en||xe||"combobox"===F||an("",!1,!1)}),[en]),e.useEffect((function(){qe&&K&&Ze(!1),K&&je(!1)}),[K]);var un=P(),ln=h(un,2),cn=ln[0],sn=ln[1],dn=e.useRef(!1),pn=[];e.useEffect((function(){return function(){pn.forEach((function(e){return clearTimeout(e)})),pn.splice(0,pn.length)}}),[]);var fn,vn=e.useState(null),mn=h(vn,2),hn=mn[0],gn=mn[1],bn=e.useState({}),wn=h(bn,2)[1];c((function(){if(tn){var e,n=Math.ceil(null===(e=Ve.current)||void 0===e?void 0:e.getBoundingClientRect().width);hn===n||Number.isNaN(n)||gn(n)}}),[tn]),Ue&&(fn=function(e){on(e)}),function(n,t,o,r){var a=e.useRef(null);a.current={open:t,triggerOpen:o,customizedTrigger:r},e.useEffect((function(){function e(e){var t;if(null===(t=a.current)||void 0===t||!t.customizedTrigger){var o=e.target;o.shadowRoot&&e.composed&&(o=e.composedPath()[0]||o),a.current.open&&n().filter((function(e){return e})).every((function(e){return!e.contains(o)&&e!==o}))&&a.current.triggerOpen(!1)}}return window.addEventListener("mousedown",e),function(){return window.removeEventListener("mousedown",e)}}),[])}((function(){var e;return[Ve.current,null===(e=ke.current)||void 0===e?void 0:e.getPopupElement()]}),tn,on,!!Ue);var yn,Cn=e.useMemo((function(){return g(g({},t),{},{notFoundContent:k,open:en,triggerOpen:tn,id:d,showSearch:De,multiple:xe,toggleOpen:on})}),[t,k,tn,en,d,De,xe,on]),En=!!re||L;En&&(yn=e.createElement(R,{className:m("".concat(p,"-arrow"),w({},"".concat(p,"-arrow-loading"),L)),customizeIcon:re,customizeIconProps:{loading:L,searchValue:He,open:en,focused:_e,showSearch:De}}));var Sn,In=function(e,t,o,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,c=n.useMemo((function(){return"object"===b(r)?r.clearIcon:a||void 0}),[r,a]);return{allowClear:n.useMemo((function(){return!(i||!r||!o.length&&!u||"combobox"===l&&""===u)}),[r,i,o.length,u,l]),clearIcon:n.createElement(R,{className:"".concat(e,"-clear"),onMouseDown:t,customizeIcon:c},"×")}}(p,(function(){var e;null==A||A(),null===(e=Ae.current)||void 0===e||e.focus(),O([],{type:"clear",values:M}),an("",!1,!1)}),M,oe,ae,K,He,F),xn=In.allowClear,Dn=In.clearIcon,Nn=e.createElement(ie,{ref:Fe}),Mn=m(p,f,(w(i={},"".concat(p,"-focused"),_e),w(i,"".concat(p,"-multiple"),xe),w(i,"".concat(p,"-single"),!xe),w(i,"".concat(p,"-allow-clear"),oe),w(i,"".concat(p,"-show-arrow"),En),w(i,"".concat(p,"-disabled"),K),w(i,"".concat(p,"-loading"),L),w(i,"".concat(p,"-open"),en),w(i,"".concat(p,"-customize-input"),ze),w(i,"".concat(p,"-show-search"),De),i)),Pn=e.createElement(B,{ref:ke,disabled:K,prefixCls:p,visible:tn,popupElement:Nn,containerWidth:hn,animation:ue,transitionName:le,dropdownStyle:ce,dropdownClassName:se,direction:x,dropdownMatchSelectWidth:de,dropdownRender:pe,dropdownAlign:fe,placement:ve,builtinPlacements:me,getPopupContainer:he,empty:V,getTriggerDOMNode:function(){return Te.current},onPopupVisibleChange:fn,onPopupMouseEnter:function(){wn({})}},Ue?e.cloneElement(Ue,{ref:Be}):e.createElement(H,y({},t,{domRef:Te,prefixCls:p,inputElement:ze,ref:Ae,id:d,showSearch:De,autoClearSearchValue:Z,mode:F,activeDescendantId:G,tagRender:I,values:M,open:en,onToggleOpen:on,activeValue:X,searchValue:He,onSearch:an,onSearchSubmit:function(e){e&&e.trim()&&ee(e,{source:"submit"})},onRemove:function(e){var n=M.filter((function(n){return n!==e}));O(n,{type:"remove",values:[e]})},tokenWithEnter:rn})));return Sn=Ue?Pn:e.createElement("div",y({className:Mn},Ne,{ref:Ve,onMouseDown:function(e){var n,t=e.target,o=null===(n=ke.current)||void 0===n?void 0:n.getPopupElement();if(o&&o.contains(t)){var r=setTimeout((function(){var e,n=pn.indexOf(r);-1!==n&&pn.splice(n,1),We(),Re||o.contains(document.activeElement)||null===(e=Ae.current)||void 0===e||e.focus()}));pn.push(r)}for(var a=arguments.length,i=new Array(a>1?a-1:0),u=1;u<a;u++)i[u-1]=arguments[u];null==Se||Se.apply(void 0,[e].concat(i))},onKeyDown:function(e){var n,t=cn(),o=e.which;if(o===a.ENTER&&("combobox"!==F&&e.preventDefault(),en||on(!0)),sn(!!He),o===a.BACKSPACE&&!t&&xe&&!He&&M.length){for(var r=S(M),i=null,u=r.length-1;u>=0;u-=1){var l=r[u];if(!l.disabled){r.splice(u,1),i=l;break}}i&&O(r,{type:"remove",values:[i]})}for(var c=arguments.length,s=new Array(c>1?c-1:0),d=1;d<c;d++)s[d-1]=arguments[d];en&&Fe.current&&(n=Fe.current).onKeyDown.apply(n,[e].concat(s)),null==Ee||Ee.apply(void 0,[e].concat(s))},onKeyUp:function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];var r;en&&Fe.current&&(r=Fe.current).onKeyUp.apply(r,[e].concat(t)),null==Ce||Ce.apply(void 0,[e].concat(t))},onFocus:function(){je(!0),K||(we&&!dn.current&&we.apply(void 0,arguments),be.includes("focus")&&on(!0)),dn.current=!0},onBlur:function(){je(!1,(function(){dn.current=!1,on(!1)})),K||(He&&("tags"===F?ee(He,{source:"submit"}):"multiple"===F&&ee("",{source:"blur"})),ye&&ye.apply(void 0,arguments))}}),_e&&!en&&e.createElement("span",{style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0},"aria-live":"polite"},"".concat(M.map((function(e){var n=e.label,t=e.value;return["number","string"].includes(b(n))?n:t})).join(", "))),Pn,yn,xn&&Dn),e.createElement(N.Provider,{value:Cn},Sn)}));function Z(e,n){return T(e).join("").toUpperCase().includes(n)}var ee=0,ne=d();function te(n){var t=e.useState(),o=h(t,2),r=o[0],a=o[1];return e.useEffect((function(){var e;a("rc_select_".concat((ne?(e=ee,ee+=1):e="TEST_OR_SSR",e)))}),[]),n||r}var oe=["children","value"],re=["children"];function ae(n){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return p(n).map((function(n,o){if(!e.isValidElement(n)||!n.type)return null;var r=n,a=r.type.isSelectOptGroup,i=r.key,u=r.props,l=u.children,c=C(u,re);return t||!a?function(e){var n=e,t=n.key,o=n.props,r=o.children,a=o.value,i=C(o,oe);return g({key:t,value:void 0!==a?a:t,children:r},i)}(n):g(g({key:"__RC_SELECT_GRP__".concat(null===i?o:i,"__"),label:i},c),{},{options:ae(l)})})).filter((function(e){return e}))}function ie(n){var t=e.useRef();t.current=n;var o=e.useCallback((function(){return t.current.apply(t,arguments)}),[]);return o}var ue=function(){return null};ue.isSelectOptGroup=!0;var le=function(){return null};le.isSelectOption=!0;var ce=e.createContext(null);var se=["disabled","title","children","style","className"];function de(e){return"string"==typeof e||"number"==typeof e}var pe=function(n,t){var o=M(),i=o.prefixCls,u=o.id,l=o.open,c=o.multiple,s=o.mode,d=o.searchValue,p=o.toggleOpen,g=o.notFoundContent,b=o.onPopupScroll,E=e.useContext(ce),I=E.flattenOptions,x=E.onActiveValue,N=E.defaultActiveFirstOption,P=E.onSelect,O=E.menuItemSelectedIcon,V=E.rawValues,T=E.fieldNames,k=E.virtual,A=E.direction,F=E.listHeight,K=E.listItemHeight,L="".concat(i,"-item"),_=f((function(){return I}),[l,I],(function(e,n){return n[0]&&e[1]!==n[1]})),j=e.useRef(null),W=function(e){e.preventDefault()},H=function(e){j.current&&j.current.scrollTo("number"==typeof e?{index:e}:e)},z=function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=_.length,o=0;o<t;o+=1){var r=(e+o*n+t)%t,a=_[r],i=a.group,u=a.data;if(!i&&!u.disabled)return r}return-1},U=e.useState((function(){return z(0)})),B=h(U,2),X=B[0],Y=B[1],G=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Y(e);var t={source:n?"keyboard":"mouse"},o=_[e];o?x(o.value,e,t):x(null,-1,t)};e.useEffect((function(){G(!1!==N?z(0):-1)}),[_.length,d]);var J=e.useCallback((function(e){return V.has(e)&&"combobox"!==s}),[s,S(V).toString(),V.size]);e.useEffect((function(){var e,n=setTimeout((function(){if(!c&&l&&1===V.size){var e=Array.from(V)[0],n=_.findIndex((function(n){return n.data.value===e}));-1!==n&&(G(n),H(n))}}));l&&(null===(e=j.current)||void 0===e||e.scrollTo(void 0));return function(){return clearTimeout(n)}}),[l,d,I.length]);var Q=function(e){void 0!==e&&P(e,{selected:!V.has(e)}),c||p(!1)};if(e.useImperativeHandle(t,(function(){return{onKeyDown:function(e){var n=e.which,t=e.ctrlKey;switch(n){case a.N:case a.P:case a.UP:case a.DOWN:var o=0;if(n===a.UP?o=-1:n===a.DOWN?o=1:/(mac\sos|macintosh)/i.test(navigator.appVersion)&&t&&(n===a.N?o=1:n===a.P&&(o=-1)),0!==o){var r=z(X+o,o);H(r),G(r,!0)}break;case a.ENTER:var i=_[X];i&&!i.data.disabled?Q(i.value):Q(void 0),l&&e.preventDefault();break;case a.ESC:p(!1),l&&e.stopPropagation()}},onKeyUp:function(){},scrollTo:function(e){H(e)}}})),0===_.length)return e.createElement("div",{role:"listbox",id:"".concat(u,"_list"),className:"".concat(L,"-empty"),onMouseDown:W},g);var $=Object.keys(T).map((function(e){return T[e]})),q=function(e){return e.label};function Z(e,n){return{role:e.group?"presentation":"option",id:"".concat(u,"_list_").concat(n)}}var ee=function(n){var t=_[n];if(!t)return null;var o=t.data||{},a=o.value,i=t.group,u=r(o,!0),l=q(t);return t?e.createElement("div",y({"aria-label":"string"!=typeof l||i?null:l},u,{key:n},Z(t,n),{"aria-selected":J(a)}),a):null},ne={role:"listbox",id:"".concat(u,"_list")};return e.createElement(e.Fragment,null,k&&e.createElement("div",y({},ne,{style:{height:0,width:0,overflow:"hidden"}}),ee(X-1),ee(X),ee(X+1)),e.createElement(D,{itemKey:"key",ref:j,data:_,height:F,itemHeight:K,fullHeight:!1,onMouseDown:W,onScroll:b,virtual:k,direction:A,innerProps:k?null:ne},(function(n,t){var o,a=n.group,i=n.groupOption,u=n.data,l=n.label,c=n.value,s=u.key;if(a){var d,p=null!==(d=u.title)&&void 0!==d?d:de(l)?l.toString():void 0;return e.createElement("div",{className:m(L,"".concat(L,"-group")),title:p},void 0!==l?l:s)}var f=u.disabled,h=u.title;u.children;var g=u.style,b=u.className,E=C(u,se),S=v(E,$),I=J(c),x="".concat(L,"-option"),D=m(L,x,b,(w(o={},"".concat(x,"-grouped"),i),w(o,"".concat(x,"-active"),X===t&&!f),w(o,"".concat(x,"-disabled"),f),w(o,"".concat(x,"-selected"),I),o)),N=q(n),M=!O||"function"==typeof O||I,P="number"==typeof N?N:N||c,V=de(P)?P.toString():void 0;return void 0!==h&&(V=h),e.createElement("div",y({},r(S),k?{}:Z(n,t),{"aria-selected":I,className:D,title:V,onMouseMove:function(){X===t||f||G(t)},onClick:function(){f||Q(c)},style:g}),e.createElement("div",{className:"".concat(x,"-content")},P),e.isValidElement(O)||I,M&&e.createElement(R,{className:"".concat(L,"-option-state"),customizeIcon:O,customizeIconProps:{isSelected:I}},I?"✓":null))})))},fe=e.forwardRef(pe);fe.displayName="OptionList";var ve=["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","direction","listHeight","listItemHeight","value","defaultValue","labelInValue","onChange"],me=["inputValue"];var he=e.forwardRef((function(n,t){var o=n.id,r=n.mode,a=n.prefixCls,i=void 0===a?"rc-select":a,u=n.backfill,l=n.fieldNames,c=n.inputValue,d=n.searchValue,p=n.onSearch,f=n.autoClearSearchValue,v=void 0===f||f,m=n.onSelect,E=n.onDeselect,I=n.dropdownMatchSelectWidth,x=void 0===I||I,D=n.filterOption,N=n.filterSort,M=n.optionFilterProp,P=n.optionLabelProp,R=n.options,O=n.children,V=n.defaultActiveFirstOption,k=n.menuItemSelectedIcon,A=n.virtual,F=n.direction,K=n.listHeight,L=void 0===K?200:K,_=n.listItemHeight,j=void 0===_?20:_,W=n.value,H=n.defaultValue,z=n.labelInValue,U=n.onChange,B=C(n,ve),J=te(o),Q=$(r),ee=!(R||!O),ne=e.useMemo((function(){return(void 0!==D||"combobox"!==r)&&D}),[D,r]),oe=e.useMemo((function(){return Y(l,ee)}),[JSON.stringify(l),ee]),re=s("",{value:void 0!==d?d:c,postState:function(e){return e||""}}),ue=h(re,2),le=ue[0],se=ue[1],de=function(n,t,o,r,a){return e.useMemo((function(){var e=n;!n&&(e=ae(t));var i=new Map,u=new Map,l=function(e,n,t){t&&"string"==typeof t&&e.set(n[t],n)};return function e(n){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=0;c<n.length;c+=1){var s=n[c];!s[o.options]||t?(i.set(s[o.value],s),l(u,s,o.label),l(u,s,r),l(u,s,a)):e(s[o.options],!0)}}(e),{options:e,valueOptions:i,labelOptions:u}}),[n,t,o,r,a])}(R,O,oe,M,P),pe=de.valueOptions,he=de.labelOptions,ge=de.options,be=e.useCallback((function(e){return T(e).map((function(e){var n,t,o,r,a,i;(function(e){return!e||"object"!==b(e)})(e)?n=e:(o=e.key,t=e.label,n=null!==(i=e.value)&&void 0!==i?i:o);var u,l=pe.get(n);l&&(void 0===t&&(t=null==l?void 0:l[P||oe.label]),void 0===o&&(o=null!==(u=null==l?void 0:l.key)&&void 0!==u?u:n),r=null==l?void 0:l.disabled,a=null==l?void 0:l.title);return{label:t,value:n,key:o,disabled:r,title:a}}))}),[oe,P,pe]),we=s(H,{value:W}),ye=h(we,2),Ce=ye[0],Ee=ye[1],Se=e.useMemo((function(){var e,n=be(Ce);return"combobox"===r&&function(e){return!e&&0!==e}(null===(e=n[0])||void 0===e?void 0:e.value)?[]:n}),[Ce,be,r]),Ie=function(n,t){var o=e.useRef({values:new Map,options:new Map});return[e.useMemo((function(){var e=o.current,r=e.values,a=e.options,i=n.map((function(e){var n;return void 0===e.label?g(g({},e),{},{label:null===(n=r.get(e.value))||void 0===n?void 0:n.label}):e})),u=new Map,l=new Map;return i.forEach((function(e){u.set(e.value,e),l.set(e.value,t.get(e.value)||a.get(e.value))})),o.current.values=u,o.current.options=l,i}),[n,t]),e.useCallback((function(e){return t.get(e)||o.current.options.get(e)}),[t])]}(Se,pe),xe=h(Ie,2),De=xe[0],Ne=xe[1],Me=e.useMemo((function(){if(!r&&1===De.length){var e=De[0];if(null===e.value&&(null===e.label||void 0===e.label))return[]}return De.map((function(e){var n;return g(g({},e),{},{label:null!==(n=e.label)&&void 0!==n?n:e.value})}))}),[r,De]),Pe=e.useMemo((function(){return new Set(De.map((function(e){return e.value})))}),[De]);e.useEffect((function(){if("combobox"===r){var e,n=null===(e=De[0])||void 0===e?void 0:e.value;se(function(e){return null!=e}(n)?String(n):"")}}),[De]);var Re=ie((function(e,n){var t,o=null!=n?n:e;return w(t={},oe.value,e),w(t,oe.label,o),t})),Oe=function(n,t,o,r,a){return e.useMemo((function(){if(!o||!1===r)return n;var e=t.options,i=t.label,u=t.value,l=[],c="function"==typeof r,s=o.toUpperCase(),d=c?r:function(n,t){return a?Z(t[a],s):t[e]?Z(t["children"!==i?i:"label"],s):Z(t[u],s)},p=c?function(e){return G(e)}:function(e){return e};return n.forEach((function(n){if(n[e])if(d(o,p(n)))l.push(n);else{var t=n[e].filter((function(e){return d(o,p(e))}));t.length&&l.push(g(g({},n),{},w({},e,t)))}else d(o,p(n))&&l.push(n)})),l}),[n,r,a,o,t])}(e.useMemo((function(){if("tags"!==r)return ge;var e=S(ge);return S(De).sort((function(e,n){return e.value<n.value?-1:1})).forEach((function(n){var t=n.value;(function(e){return pe.has(e)})(t)||e.push(Re(t,n.label))})),e}),[Re,ge,pe,De,r]),oe,le,ne,M),Ve=e.useMemo((function(){return"tags"!==r||!le||Oe.some((function(e){return e[M||"value"]===le}))||Oe.some((function(e){return e[oe.value]===le}))?Oe:[Re(le)].concat(S(Oe))}),[Re,M,r,Oe,le,oe]),Te=e.useMemo((function(){return N?S(Ve).sort((function(e,n){return N(e,n)})):Ve}),[Ve,N]),ke=e.useMemo((function(){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.fieldNames,o=n.childrenAsData,r=[],a=Y(t,!1),i=a.label,u=a.value,l=a.options,c=a.groupLabel;return function e(n,t){n.forEach((function(n){if(t||!(l in n)){var a=n[u];r.push({key:X(n,r.length),groupOption:t,data:n,label:n[i],value:a})}else{var s=n[c];void 0===s&&o&&(s=n.label),r.push({key:X(n,r.length),group:!0,data:n,label:s}),e(n[l],!0)}}))}(e,!1),r}(Te,{fieldNames:oe,childrenAsData:ee})}),[Te,oe,ee]),Ae=function(e){var n=be(e);if(Ee(n),U&&(n.length!==De.length||n.some((function(e,n){var t;return(null===(t=De[n])||void 0===t?void 0:t.value)!==(null==e?void 0:e.value)})))){var t=z?n:n.map((function(e){return e.value})),o=n.map((function(e){return G(Ne(e.value))}));U(Q?t:t[0],Q?o:o[0])}},Fe=e.useState(null),Ke=h(Fe,2),Le=Ke[0],_e=Ke[1],je=e.useState(0),We=h(je,2),He=We[0],ze=We[1],Ue=void 0!==V?V:"combobox"!==r,Be=e.useCallback((function(e,n){var t=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).source,o=void 0===t?"keyboard":t;ze(n),u&&"combobox"===r&&null!==e&&"keyboard"===o&&_e(String(e))}),[u,r]),Xe=function(e,n,t){var o=function(){var n,t=Ne(e);return[z?{label:null==t?void 0:t[oe.label],value:e,key:null!==(n=null==t?void 0:t.key)&&void 0!==n?n:e}:e,G(t)]};if(n&&m){var r=o(),a=h(r,2),i=a[0],u=a[1];m(i,u)}else if(!n&&E&&"clear"!==t){var l=o(),c=h(l,2),s=c[0],d=c[1];E(s,d)}},Ye=ie((function(e,n){var t,o=!Q||n.selected;t=o?Q?[].concat(S(De),[e]):[e]:De.filter((function(n){return n.value!==e})),Ae(t),Xe(e,o),"combobox"===r?_e(""):$&&!v||(se(""),_e(""))})),Ge=e.useMemo((function(){var e=!1!==A&&!1!==x;return g(g({},de),{},{flattenOptions:ke,onActiveValue:Be,defaultActiveFirstOption:Ue,onSelect:Ye,menuItemSelectedIcon:k,rawValues:Pe,fieldNames:oe,virtual:e,direction:F,listHeight:L,listItemHeight:j,childrenAsData:ee})}),[de,ke,Be,Ue,Ye,k,Pe,oe,A,x,L,j,ee]);return e.createElement(ce.Provider,{value:Ge},e.createElement(q,y({},B,{id:J,prefixCls:i,ref:t,omitDomProps:me,mode:r,displayValues:Me,onDisplayValuesChange:function(e,n){Ae(e);var t=n.type,o=n.values;"remove"!==t&&"clear"!==t||o.forEach((function(e){Xe(e.value,!1,t)}))},direction:F,searchValue:le,onSearch:function(e,n){if(se(e),_e(null),"submit"!==n.source)"blur"!==n.source&&("combobox"===r&&Ae(e),null==p||p(e));else{var t=(e||"").trim();if(t){var o=Array.from(new Set([].concat(S(Pe),[t])));Ae(o),Xe(t,!0),se("")}}},autoClearSearchValue:v,onSearchSplit:function(e){var n=e;"tags"!==r&&(n=e.map((function(e){var n=he.get(e);return null==n?void 0:n.value})).filter((function(e){return void 0!==e})));var t=Array.from(new Set([].concat(S(Pe),S(n))));Ae(t),t.forEach((function(e){Xe(e,!0)}))},dropdownMatchSelectWidth:x,OptionList:fe,emptyOptions:!ke.length,activeValue:Le,activeDescendantId:"".concat(J,"_list_").concat(He)})))}));he.Option=le,he.OptGroup=ue;export{q as B,le as O,he as T,ue as a,te as b,M as u};
