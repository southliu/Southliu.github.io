import{r as e,j as t}from"./react@19.2.3.D3o_8b5j.js";import{H as s}from"./keepalive-for-react@5.0.7_r_33100828a8f90b61e9967b46b3101fcd.Cc1K-x6F.js";import{tableColumns as r,searchList as o,createList as a}from"./model.BgL56MCb.js";import{b as c,z as i,A as n,I as m,a as p,h as d,E as b,B as f,C as _,G as l,H as j,J as u}from"./index.BTHqHx39.js";import g from"./PermissionDrawer.CpQ0Bpvx.js";import{e as y,u as h}from"./react-router@7.11.0_react-d_9bf5140e9212b7cc8e1e4977b49a16e8.Dqvwovqb.js";import{c as x,B as S}from"./BaseContent.CTHwsCdk.js";import{U as w}from"./UpdateBtn._raPnc22.js";import{D as k,B as v}from"./BasePagination.ByCwu8Dw.js";import{B}from"./BaseCard.3VCo4Tro.js";import{B as C}from"./BaseSearch.C984Avy1.js";import{B as F}from"./BaseTable.J_PgG8vk.js";import{B as z}from"./BaseModal.6-mAQpl3.js";import{B as D}from"./BaseForm.C0ywEtsB.js";import{u as N}from"./react-i18next@16.5.1_i18nex_e0732ae603aefaca3ccb08379955d50d.CFoO-yg_.js";import{s as E,F as L,B as O}from"./antd@6.1.3_react-dom@19.2.3_react@19.2.3__react@19.2.3.B59SJbiP.js";import"./@babel_runtime@7.28.4.Ck1afGla.js";import"./react-dom@19.2.3_react@19.2.3.CIkYuaQ_.js";import"./scheduler@0.27.0.6ULW7vKx.js";import"./constants.5OLMXA36.js";import"./role.B9WoHJ9l.js";import"./nprogress@0.2.0.CMcGCMLp.js";import"./i18next-http-backend@3.0.2.BBsYoZ-e.js";import"./crypto-js@4.2.0.DDQhaveQ.js";import"./axios@1.13.2.DDVHPqWP.js";import"./lodash@4.17.21.BUwJ2jlQ.js";import"./zustand@5.0.9_@types_react@_5454f66ab05067d144a1abef0fde1e8c.DQpm8-Mc.js";import"./@iconify_react@6.0.2_react@19.2.3.DNJK3b9P.js";import"./@ant-design_cssinjs@2.0.1_r_52ebc5f68c5d55a7b1a8f8a117b18eba.Dgwj0KgC.js";import"./@rc-component_util@1.7.0_re_97ed4941f5d27d044aa2ecbc4a75f304.OytLLzRX.js";import"./react-is@18.3.1.USR0mOhp.js";import"./is-mobile@5.0.0.CY4BSRfs.js";import"./@emotion_hash@0.8.0.DFFAhID7.js";import"./@emotion_unitless@0.7.5.BWzHn38B.js";import"./stylis@4.3.6.CDtraqjp.js";import"./i18next@25.7.3_typescript@5.9.3.oPH98fpq.js";import"./i18next-browser-languagedetector@8.2.0.q5bUM8v9.js";import"./dayjs@1.11.19.makcgq1Y.js";import"./web-vitals@5.1.0.C9lpl2zp.js";import"./@sentry_react@10.38.0_react@19.2.3.pAyv9avm.js";import"./@sentry_core@10.38.0.B-bj8hQP.js";import"./@sentry_browser@10.38.0.DJM_bMq3.js";import"./@sentry-internal_browser-utils@10.38.0.Bc5JQQFT.js";import"./@sentry-internal_replay@10.38.0.4OC3EoWI.js";import"./@ant-design_cssinjs-utils@2_9cdeccd52263af62f34dd9f213f921e5.C3Lt3TZs.js";import"./@rc-component_resize-observ_a5d141e3de655ef602de0c6d9e51ffb4.DTkZgLwN.js";import"./clsx@2.1.1.BvmCeSbq.js";import"./@ant-design_fast-color@3.0.0.Bv-idf8E.js";import"./@ant-design_colors@8.0.0.C_9FKw7I.js";import"./@ant-design_icons@6.1.0_rea_578d967b89ca52aedd84b4dfb2c6cf72.CojizEej.js";import"./@ant-design_icons-svg@4.4.2.CjW3sjtx.js";import"./@rc-component_motion@1.1.6__75bed58c5aa0279623e804b6e3100d82.Dp7kHckh.js";import"./scroll-into-view-if-needed@3.1.0.B0UcSGS3.js";import"./compute-scroll-into-view@3.1.1.Cfyw3hb3.js";import"./@rc-component_pagination@1._c8c3dfc82534658d6c7c4054f0d2f69c.QfqcjsW9.js";import"./@rc-component_picker@1.9.0__52a8cb63fe1d91d00305622cb5380f6e.vl6gWHvl.js";import"./@rc-component_trigger@3.7.2_b5d51e27885fcdc381f6db89cb94580b.7SPRIdKI.js";import"./@rc-component_portal@2.2.0__23d0e188c8e59a845be2370f4ba3b141.DMGK87O5.js";import"./@rc-component_overflow@1.0._000e3b789f0a378ea10d91c90289e484.BRgGt9x2.js";import"./@rc-component_notification@_6b5601d366b139db646993c6d2b44fe7.C7nN-HsR.js";import"./@rc-component_color-picker@_b31871ba6e7583d0e0030156daa2c231.QY1FkQwD.js";import"./@rc-component_collapse@1.1._228d3773bbed33f966bd3893dbe8729d.DosGPEFu.js";import"./@rc-component_dialog@1.5.1__3a9190aeba7b200bd9ee7697ebc43c96.l5-BrUq2.js";import"./@rc-component_form@1.6.0_re_b998db7a1757bdc2c2d6e65b57d3d80e.CWwDr9vK.js";import"./@rc-component_async-validator@5.0.4.BVisLF_3.js";import"./@rc-component_select@1.4.0__72937b420adc00cfcd381e86fe79d4ff.6I8X_RNY.js";import"./@rc-component_virtual-list@_eab7c240f5d5dcfc3960e23bede0b5bd.BMbuch9V.js";import"./@rc-component_tooltip@1.4.0_24ce817bfa5749bd0e3c36dde530a97c._z6uvGl3.js";import"./@rc-component_dropdown@1.0._53032f4203d2df29a251177758ef8582.B3FO_i_C.js";import"./@rc-component_menu@1.2.0_re_22c4d0f32307dedeae1bf96beb63120f.BDHAA7SK.js";import"./@rc-component_checkbox@1.0._e8e0ff7b3fc71b270e8f41769fdc08ef.Cmiu7vdT.js";import"./@rc-component_tabs@1.7.0_re_2e2b6a6e8158979ca118318443a5e725.CLUJuviN.js";import"./@ant-design_react-slick@2.0_7e7eaf031d783e1bf442b33d4a0ab896.D3OZPMUD.js";import"./throttle-debounce@5.0.2.w9OM8Bxz.js";import"./json2mq@0.2.0.GZzr-Vnx.js";import"./string-convert@0.2.1.CCzxSb8Y.js";import"./@rc-component_cascader@1.10_6ebff9b01a4e20f17bf5315b0fdf89e4.Cv_wPsB6.js";import"./@rc-component_tree@1.1.0_re_16b118318364c8e3af872a05fdf7f126.Bhs1Ff4Q.js";import"./@rc-component_segmented@1.3_21ca68187e5dbc0fdd04919b00514bb2.L2ciIQTn.js";import"./@rc-component_input-number@_8344498727e4684fb6e2c8a86fda3337.NAEoLZ75.js";import"./@rc-component_mini-decimal@1.1.0.BqhSKEoY.js";import"./@rc-component_input@1.1.2_r_6672dd2a1daa1d4fb8167692335bdc32.CKElcDuT.js";import"./@rc-component_slider@1.0.1__528977580e75fd5a617258a02a5eb89f.DjUV2ucq.js";import"./@rc-component_drawer@1.3.0__a3d615bbff00e7f3d4a92805dfb7be48.Cv2tZrDL.js";import"./@rc-component_image@1.5.3_r_dcb3ab75ae693752d40558f143f9ffbd.B9bahJpA.js";import"./@rc-component_textarea@1.1._509480b13cbc5aaa7fb930d30d5446b8.BoMpu7IK.js";import"./@rc-component_mentions@1.6._78da067fea4317b9a061ddd8114d8e2c.BAM0LhZ5.js";import"./@rc-component_progress@1.0._690d9711439beca726bc73677291eda2.BNi-Wz6j.js";import"./@rc-component_qrcode@1.1.1__0f9c8c9acd773e58dc69db4d81fa0587.CH883Cbj.js";import"./@rc-component_rate@1.0.1_re_607aeea99259c177b103a2159d2187ff.soQhfRl0.js";import"./@rc-component_steps@1.2.2_r_676c9cf2ee63b15ecfba1a57f7fa461f.B_2Z_9jR.js";import"./@rc-component_switch@1.0.3__79f884f0de666becb31c50b27a07c8e0.Bw1xoSKH.js";import"./@rc-component_table@1.9.0_r_af629d240898c7fe2c8824967839d777.BaOL_bFk.js";import"./@rc-component_context@2.0.1_9fe36d481fc46b168d9be8c7e1532bb4.7OSEexam.js";import"./@rc-component_tour@2.2.1_re_c814a7862157707785c7770d3c2b3347.BR9_y0mu.js";import"./@rc-component_tree-select@1_ca468fe32827d69ce4681fdcb142e602.DeUxcAbA.js";import"./@rc-component_upload@1.1.0__a6e83aac22b2c573f173681e85b72b7b.Bx4CpChZ.js";import"./@rc-component_mutate-observ_e6130eca8f32f9ca6ca6e4795e1097a7.D8T_g6R9.js";import"./use-sync-external-store@1.6.0_react@19.2.3.DaiN_xOC.js";import"./MenuAuthorize.jrn8RLEq.js";import"./403.CRK0PhRI.js";import"./helper.DLYd-0o8.js";import"./BaseTimeRangePicker.aOhtiKaN.js";import"./react-resizable@3.1.2_react_5d246e7116c7c3f8eee3a59a08959a6f.Berd6xPz.js";import"./react-draggable@4.5.0_react_38b3ec0b5b5ffe2dfcce8c9bab4916d1.Dud5E6Od.js";import"./prop-types@15.8.1.Bx5UHif0.js";import"./is.BeBpkxAQ.js";import"./@dnd-kit_core@6.3.1_react-d_faeaa4ec592555ff24d378ec7b025ac6.DiSRDP3z.js";import"./@dnd-kit_utilities@3.2.2_react@19.2.3.BZP7gbL7.js";import"./@dnd-kit_accessibility@3.1.1_react@19.2.3.CGuEI72d.js";import"./@dnd-kit_sortable@10.0.0_@d_bb9a87c2c20c367037e96a5cfbc9db8c.ClQorwyP.js";const P={status:1};function M(){const{t:M}=N(),R=e.useRef(null),[T,q]=E.useMessage(),[A,H]=e.useState(!1),[U,I]=e.useState(!1),[V,G]=e.useState(!1),[J,K]=e.useState(!1),[W,Q]=e.useState(n(M)),[X,Y]=e.useState(""),[Z,$]=e.useState(P),[ee,te]=e.useState({}),[se,re]=e.useState(m.page),[oe,ae]=e.useState(m.pageSize),[ce,ie]=e.useState(0),[ne,me]=e.useState([]),[pe,de]=e.useState(""),[be,fe]=e.useState(!1),[_e,le]=e.useState([]),[je]=L.useForm(),[ue]=L.useForm(),[ge]=(t=>{const[,s]=y(),{pathname:r,search:o}=h(),{setTabs:a}=c(e=>e),n=e.useCallback(()=>{const e=i(o);null==t||t.setFieldsValue({...null==t?void 0:t.getFieldsValue(),...e})},[]);return e.useEffect(()=>{n()},[]),[e=>{const t=Object.fromEntries(Object.entries(e).filter(([,e])=>void 0!==e));let o=new URLSearchParams(t).toString();(null==o?void 0:o.length)&&(o="?".concat(o)),s(t),a(r,o)}]})(ue),{permissions:ye}=p(),he="/authority/user",xe={page:x(he,ye),create:x("".concat(he,"/create"),ye),update:x("".concat(he,"/update"),ye),delete:x("".concat(he,"/delete"),ye),permission:x("".concat(he,"/authority"),ye)},Se=e.useCallback(async()=>{const e={...ee,page:se,pageSize:oe};try{I(!0);const{code:t,data:s}=await d(e);if(200!==Number(t))return;const{items:r,total:o}=s;ie(o||0),me(r||[])}finally{H(!1),I(!1)}},[se,oe,ee]);e.useEffect(()=>{A&&Se()},[Se,A]),e.useEffect(()=>{xe.page&&Se()},[xe.page]),s(()=>{Se()},[]);const we=async e=>{de(e),fe(!0)},ke=async e=>{try{K(!0),Q(b(M,e)),Y(e),G(!0);const{code:t,data:s}=await f(e);if(200!==Number(t))return;$(s)}finally{G(!1)}},ve=async e=>{try{I(!0);const{code:t,message:s}=await _(e);200===Number(t)&&(T.success(s||M("public.successfullyDeleted")),Se())}finally{I(!1)}},Be={selectedRowKeys:_e,onChange:e=>{le(e)}},Ce=e.useCallback((e,s)=>t.jsxs("div",{className:"flex flex-wrap gap-5px",children:[!0===xe.permission&&t.jsx(O,{className:"small-btn",onClick:()=>we(s.id),children:M("system.permissions")}),!0===xe.update&&t.jsx(w,{onClick:()=>ke(s.id)}),!0===xe.delete&&t.jsx(k,{name:s.username,handleDelete:()=>ve(s.id)})]}),[xe.permission,xe.update,xe.delete,M,we,ke,ve]),Fe=e.useMemo(()=>r(M,Ce),[M,Ce]),ze=t.jsx(k,{isIcon:!0,isLoading:U,btnType:"batchDelete",handleDelete:async()=>{try{if(!_e.length)return T.warning({content:M("public.tableSelectWarning"),key:"pleaseSelect"});I(!0);const e={ids:_e},{code:t,message:s}=await u(e);200===Number(t)&&(T.success(s||M("public.successfullyDeleted")),Se())}finally{I(!1)}}});return t.jsxs(S,{isPermission:xe.page,children:[q,t.jsx(B,{children:t.jsx(C,{list:o(M),searchForm:ue,data:ee,type:"grid",isLoading:U,handleFinish:e=>{re(1),te(e),ge(e),H(!0)}})}),t.jsxs(B,{className:"mt-10px",children:[t.jsx(F,{isLoading:U,isCreate:xe.create,columns:Fe,dataSource:ne,rowSelection:Be,leftContent:ze,rightContent:t.jsx("div",{children:"（搜索将参数放入url）"}),getPage:Se,onCreate:()=>{K(!0),Q(n(M)),Y(""),$(P)}}),t.jsx(v,{disabled:U,current:se,pageSize:oe,total:ce,onChange:(e,t)=>{re(e),ae(t),H(!0)}})]}),t.jsx(z,{title:W,open:J,confirmLoading:V,onOk:()=>{var e;null==(e=R.current)||e.submit()},onCancel:()=>{K(!1)},children:t.jsx(D,{form:je,ref:R,list:a(M,!X),labelCol:{span:4},data:Z,handleFinish:async e=>{try{G(!0);const t=()=>X?l(X,e):j(e),{code:s,message:r}=await t();if(200!==Number(s))return;T.success(r||M("public.successfulOperation")),K(!1),Se()}finally{G(!1)}}})}),t.jsx(g,{isOpen:be,id:pe,onClose:()=>{fe(!1)}})]})}export{M as default};
