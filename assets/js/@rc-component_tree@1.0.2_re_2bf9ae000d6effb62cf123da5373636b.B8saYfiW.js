var e=Object.defineProperty,t=(t,n,o)=>((t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o)(t,"symbol"!=typeof n?n+"":n,o);import{c as n}from"./clsx@2.1.1.BvmCeSbq.js";import{t as o,b as s,A as r,p as d,h as a,K as i}from"./@rc-component_util@1.4.0_re_a8b68d4fbe51b122ded4cf0ecf2ca619.D3_e-sfJ.js";import{r as l,e as c}from"./react@19.2.1.BpVBN_43.js";import{L as h}from"./rc-virtual-list@3.19.2_reac_96eb09879a1adfd43f893d656df94dba.D76jc0i_.js";import{C as p}from"./@rc-component_motion@1.1.6__0afcbe001b0ce065bd610efbbf939bf0.BsUikez1.js";function y(e,t){return e[t]}function u(e,t){return`${e}-${t}`}function f(e,t){return null!=e?e:t}function g(e){const{title:t,_title:n,key:o,children:s}=e||{},r=t||"title";return{title:r,_title:n||[r],key:o||"key",children:s||"children"}}function v(e){return function e(t){return o(t).map(t=>{if(!function(e){return e&&e.type&&e.type.isTreeNode}(t))return s(!t,"Tree/TreeNode can only accept TreeNode as children."),null;const{key:n}=t,{children:o,...r}=t.props,d={key:n,...r},a=e(o);return a.length&&(d.children=a),d}).filter(e=>e)}(e)}function k(e,t,n){const{_title:o,key:s,children:d}=g(n),a=new Set(!0===t?[]:t),i=[];return function e(n,l=null){return n.map((c,h)=>{const p=u(l?l.pos:"0",h),y=f(c[s],p);let g;for(let e=0;e<o.length;e+=1){const t=o[e];if(void 0!==c[t]){g=c[t];break}}const v=Object.assign(r(c,[...o,s,d]),{title:g,key:y,parent:l,pos:p,children:null,data:c,isStart:[...l?l.isStart:[],0===h],isEnd:[...l?l.isEnd:[],h===n.length-1]});return i.push(v),!0===t||a.has(y)?v.children=e(c[d]||[],v):v.children=[],v})}(e),i}function K(e,{initWrapper:t,processEntity:n,onProcessFinished:o,externalGetKey:s,childrenPropName:r,fieldNames:d}={},a){const i=s||a,l={},c={};let h={posEntities:l,keyEntities:c};return t&&(h=t(h)||h),function(e,t,n){let o={};o="object"==typeof n?n:{externalGetKey:n},o=o||{};const{childrenPropName:s,externalGetKey:r,fieldNames:d}=o,{key:a,children:i}=g(d),l=s||i;let c;r?"string"==typeof r?c=e=>e[r]:"function"==typeof r&&(c=e=>r(e)):c=(e,t)=>f(e[a],t),function n(o,s,r,d){const a=o?o[l]:e,i=o?u(r.pos,s):"0",h=o?[...d,o]:[];if(o){const e=c(o,i),n={node:o,index:s,pos:i,key:e,parentPos:r.node?r.pos:null,level:r.level+1,nodes:h};t(n)}a&&a.forEach((e,t)=>{n(e,t,{node:o,pos:i,level:r?r.level+1:-1},h)})}(null)}(e,e=>{const{node:t,index:o,pos:s,key:r,parentPos:d,level:a,nodes:i}=e,p={node:t,nodes:i,index:o,key:r,pos:s,level:a},y=f(r,s);l[s]=p,c[y]=p,p.parent=l[d],p.parent&&(p.parent.children=p.parent.children||[],p.parent.children.push(p)),n&&n(p,h)},{externalGetKey:i,childrenPropName:r,fieldNames:d}),o&&o(h),h}function N(e,{expandedKeys:t,selectedKeys:n,loadedKeys:o,loadingKeys:s,checkedKeys:r,halfCheckedKeys:d,dragOverNodeKey:a,dropPosition:i,keyEntities:l}){const c=y(l,e);return{eventKey:e,expanded:-1!==t.indexOf(e),selected:-1!==n.indexOf(e),loaded:-1!==o.indexOf(e),loading:-1!==s.indexOf(e),checked:-1!==r.indexOf(e),halfChecked:-1!==d.indexOf(e),pos:String(c?c.pos:""),dragOver:a===e&&0===i,dragOverGapTop:a===e&&-1===i,dragOverGapBottom:a===e&&1===i}}function m(e){const{data:t,expanded:n,selected:o,checked:r,loaded:d,loading:a,halfChecked:i,dragOver:l,dragOverGapTop:c,dragOverGapBottom:h,pos:p,active:y,eventKey:u}=e,f={...t,expanded:n,selected:o,checked:r,loaded:d,loading:a,halfChecked:i,dragOver:l,dragOverGapTop:c,dragOverGapBottom:h,pos:p,active:y,key:u};return"props"in f||Object.defineProperty(f,"props",{get:()=>(s(!1,"Second param return from event is node data instead of TreeNode instance. Please read value directly instead of reading from `props`."),e)}),f}function x(e,t){const n=new Set;return e.forEach(e=>{t.has(e)||n.add(e)}),n}function E(e){const{disabled:t,disableCheckbox:n,checkable:o}=e||{};return!(!t&&!n)||!1===o}function b(e,t,n,o){const r=[];let d;d=o||E;const a=new Set(e.filter(e=>{const t=!!y(n,e);return t||r.push(e),t})),i=new Map;let l,c=0;return Object.keys(n).forEach(e=>{const t=n[e],{level:o}=t;let s=i.get(o);s||(s=new Set,i.set(o,s)),s.add(t),c=Math.max(c,o)}),s(!r.length,`Tree missing follow keys: ${r.slice(0,100).map(e=>`'${e}'`).join(", ")}`),l=!0===t?function(e,t,n,o){const s=new Set(e),r=new Set;for(let a=0;a<=n;a+=1)(t.get(a)||new Set).forEach(e=>{const{key:t,node:n,children:r=[]}=e;s.has(t)&&!o(n)&&r.filter(e=>!o(e.node)).forEach(e=>{s.add(e.key)})});const d=new Set;for(let a=n;a>=0;a-=1)(t.get(a)||new Set).forEach(e=>{const{parent:t,node:n}=e;if(o(n)||!e.parent||d.has(e.parent.key))return;if(o(e.parent.node))return void d.add(t.key);let a=!0,i=!1;(t.children||[]).filter(e=>!o(e.node)).forEach(({key:e})=>{const t=s.has(e);a&&!t&&(a=!1),i||!t&&!r.has(e)||(i=!0)}),a&&s.add(t.key),i&&r.add(t.key),d.add(t.key)});return{checkedKeys:Array.from(s),halfCheckedKeys:Array.from(x(r,s))}}(a,i,c,d):function(e,t,n,o,s){const r=new Set(e);let d=new Set(t);for(let i=0;i<=o;i+=1)(n.get(i)||new Set).forEach(e=>{const{key:t,node:n,children:o=[]}=e;r.has(t)||d.has(t)||s(n)||o.filter(e=>!s(e.node)).forEach(e=>{r.delete(e.key)})});d=new Set;const a=new Set;for(let i=o;i>=0;i-=1)(n.get(i)||new Set).forEach(e=>{const{parent:t,node:n}=e;if(s(n)||!e.parent||a.has(e.parent.key))return;if(s(e.parent.node))return void a.add(t.key);let o=!0,i=!1;(t.children||[]).filter(e=>!s(e.node)).forEach(({key:e})=>{const t=r.has(e);o&&!t&&(o=!1),i||!t&&!d.has(e)||(i=!0)}),o||r.delete(t.key),i&&d.add(t.key),a.add(t.key)});return{checkedKeys:Array.from(r),halfCheckedKeys:Array.from(x(d,r))}}(a,t.halfCheckedKeys,i,c,d),l}const C=l.createContext(null),D=l.createContext({}),S=({prefixCls:e,level:t,isStart:o,isEnd:s})=>{const r=`${e}-indent-unit`,d=[];for(let a=0;a<t;a+=1)d.push(l.createElement("span",{key:a,className:n(r,{[`${r}-start`]:o[a],[`${r}-end`]:s[a]})}));return l.createElement("span",{"aria-hidden":"true",className:`${e}-indent`},d)},P=l.memo(S);function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},O.apply(this,arguments)}const w="open",T="close",L="---",M=e=>{const{eventKey:t,className:o,style:s,dragOver:r,dragOverGapTop:a,dragOverGapBottom:i,isLeaf:l,isStart:h,isEnd:p,expanded:u,selected:f,checked:g,halfChecked:v,loading:k,domRef:K,active:N,data:x,onMouseMove:E,selectable:b,...S}=e,M=c.useContext(C),{classNames:$,styles:A}=M||{},R=c.useContext(D),I=c.useRef(null),[j,_]=c.useState(!1),U=!!(M.disabled||e.disabled||R.nodeDisabled?.(x)),B=c.useMemo(()=>!(!M.checkable||!1===e.checkable)&&M.checkable,[M.checkable,e.checkable]),W=t=>{U||B&&!e.disableCheckbox&&M.onNodeCheck(t,m(e),!g)},G=c.useMemo(()=>"boolean"==typeof b?b:M.selectable,[b,M.selectable]),F=t=>{M.onNodeClick(t,m(e)),G?(t=>{U||M.onNodeSelect(t,m(e))})(t):W(t)},q=t=>{M.onNodeDoubleClick(t,m(e))},H=t=>{M.onNodeMouseEnter(t,m(e))},V=t=>{M.onNodeMouseLeave(t,m(e))},X=t=>{M.onNodeContextMenu(t,m(e))},Y=c.useMemo(()=>!(!M.draggable||M.draggable.nodeDraggable&&!M.draggable.nodeDraggable(x)),[M.draggable,x]),z=t=>{k||M.onNodeExpand(t,m(e))},J=c.useMemo(()=>{const{children:e}=y(M.keyEntities,t)||{};return Boolean((e||[]).length)},[M.keyEntities,t]),Q=c.useMemo(()=>!1!==l&&(l||!M.loadData&&!J||M.loadData&&e.loaded&&!J),[l,M.loadData,J,e.loaded]);c.useEffect(()=>{k||"function"!=typeof M.loadData||!u||Q||e.loaded||M.onNodeLoad(m(e))},[k,M.loadData,M.onNodeLoad,u,Q,e]);const Z=c.useMemo(()=>M.draggable?.icon?c.createElement("span",{className:`${M.prefixCls}-draggable-icon`},M.draggable.icon):null,[M.draggable]),ee=t=>{const n=e.switcherIcon||M.switcherIcon;return"function"==typeof n?n({...e,isLeaf:t}):n},te=c.useMemo(()=>{if(!B)return null;const t="boolean"!=typeof B?B:null;return c.createElement("span",{className:n(`${M.prefixCls}-checkbox`,{[`${M.prefixCls}-checkbox-checked`]:g,[`${M.prefixCls}-checkbox-indeterminate`]:!g&&v,[`${M.prefixCls}-checkbox-disabled`]:U||e.disableCheckbox}),onClick:W,role:"checkbox","aria-checked":v?"mixed":g,"aria-disabled":U||e.disableCheckbox,"aria-label":`Select ${"string"==typeof e.title?e.title:"tree node"}`},t)},[B,g,v,U,e.disableCheckbox,e.title]),ne=c.useMemo(()=>Q?null:u?w:T,[Q,u]),oe=c.useMemo(()=>c.createElement("span",{className:n($?.itemIcon,`${M.prefixCls}-iconEle`,`${M.prefixCls}-icon__${ne||"docu"}`,{[`${M.prefixCls}-icon_loading`]:k}),style:A?.itemIcon}),[M.prefixCls,ne,k]),se=c.useMemo(()=>{const n=Boolean(M.draggable);return!e.disabled&&n&&M.dragOverNodeKey===t?M.dropIndicatorRender({dropPosition:M.dropPosition,dropLevelOffset:M.dropLevelOffset,indent:M.indent,prefixCls:M.prefixCls,direction:M.direction}):null},[M.dropPosition,M.dropLevelOffset,M.indent,M.prefixCls,M.direction,M.draggable,M.dragOverNodeKey,M.dropIndicatorRender]),re=c.useMemo(()=>{const{title:t=L}=e,o=`${M.prefixCls}-node-content-wrapper`;let s,r;if(M.showIcon){const t=e.icon||M.icon;s=t?c.createElement("span",{className:n($?.itemIcon,`${M.prefixCls}-iconEle`,`${M.prefixCls}-icon__customize`),style:A?.itemIcon},"function"==typeof t?t(e):t):oe}else M.loadData&&k&&(s=oe);return r="function"==typeof t?t(x):M.titleRender?M.titleRender(x):t,c.createElement("span",{ref:I,title:"string"==typeof t?t:"",className:n(o,`${o}-${ne||"normal"}`,{[`${M.prefixCls}-node-selected`]:!U&&(f||j)}),onMouseEnter:H,onMouseLeave:V,onContextMenu:X,onClick:F,onDoubleClick:q},s,c.createElement("span",{className:n(`${M.prefixCls}-title`,$?.itemTitle),style:A?.itemTitle},r),se)},[M.prefixCls,M.showIcon,e,M.icon,oe,M.titleRender,x,ne,H,V,X,F,q]),de=d(S,{aria:!0,data:!0}),{level:ae}=y(M.keyEntities,t)||{},ie=p[p.length-1],le=!U&&Y,ce=M.draggingNodeKey===t,he=void 0!==b?{"aria-selected":!!b}:void 0;return c.createElement("div",O({ref:K,role:"treeitem","aria-expanded":l?void 0:u,className:n(o,`${M.prefixCls}-treenode`,$?.item,{[`${M.prefixCls}-treenode-disabled`]:U,[`${M.prefixCls}-treenode-switcher-${u?"open":"close"}`]:!l,[`${M.prefixCls}-treenode-checkbox-checked`]:g,[`${M.prefixCls}-treenode-checkbox-indeterminate`]:v,[`${M.prefixCls}-treenode-selected`]:f,[`${M.prefixCls}-treenode-loading`]:k,[`${M.prefixCls}-treenode-active`]:N,[`${M.prefixCls}-treenode-leaf-last`]:ie,[`${M.prefixCls}-treenode-draggable`]:Y,dragging:ce,"drop-target":M.dropTargetKey===t,"drop-container":M.dropContainerKey===t,"drag-over":!U&&r,"drag-over-gap-top":!U&&a,"drag-over-gap-bottom":!U&&i,"filter-node":M.filterTreeNode?.(m(e)),[`${M.prefixCls}-treenode-leaf`]:Q}),style:{...s,...A?.item},draggable:le,onDragStart:le?t=>{t.stopPropagation(),_(!0),M.onNodeDragStart(t,e);try{t.dataTransfer.setData("text/plain","")}catch{}}:void 0,onDragEnter:Y?t=>{t.preventDefault(),t.stopPropagation(),M.onNodeDragEnter(t,e)}:void 0,onDragOver:Y?t=>{t.preventDefault(),t.stopPropagation(),M.onNodeDragOver(t,e)}:void 0,onDragLeave:Y?t=>{t.stopPropagation(),M.onNodeDragLeave(t,e)}:void 0,onDrop:Y?t=>{t.preventDefault(),t.stopPropagation(),_(!1),M.onNodeDrop(t,e)}:void 0,onDragEnd:Y?t=>{t.stopPropagation(),_(!1),M.onNodeDragEnd(t,e)}:void 0,onMouseMove:E},he,de),c.createElement(P,{prefixCls:M.prefixCls,level:ae,isStart:h,isEnd:p}),Z,(()=>{if(Q){const e=ee(!0);return!1!==e?c.createElement("span",{className:n(`${M.prefixCls}-switcher`,`${M.prefixCls}-switcher-noop`)},e):null}const e=ee(!1);return!1!==e?c.createElement("span",{onClick:z,className:n(`${M.prefixCls}-switcher`,`${M.prefixCls}-switcher_${u?w:T}`)},e):null})(),te,re)};function $(e,t){if(!e)return[];const n=e.slice(),o=n.indexOf(t);return o>=0&&n.splice(o,1),n}function A(e,t){const n=(e||[]).slice();return-1===n.indexOf(t)&&n.push(t),n}function R(e){return e.split("-")}function I(e,t){const n=[];return function e(t=[]){t.forEach(({key:t,children:o})=>{n.push(t),e(o)})}(y(t,e).children),n}function j(e){if(e.parent){const t=R(e.pos);return Number(t[t.length-1])===e.parent.children.length-1}return!1}function _(e,t,n,o,s,r,d,a,i,l){const{clientX:c,clientY:h}=e,{top:p,height:u}=e.target.getBoundingClientRect(),f=(("rtl"===l?-1:1)*((s?.x||0)-c)-12)/o,g=i.filter(e=>a[e]?.children?.length);let v=y(a,n.eventKey);if(h<p+u/2){const e=d.findIndex(e=>e.key===v.key),t=d[e<=0?0:e-1].key;v=y(a,t)}const k=v.key,K=v,N=v.key;let m=0,x=0;if(!g.includes(k))for(let y=0;y<f&&j(v);y+=1)v=v.parent,x+=1;const E=t.data,b=v.node;let C=!0;return function(e){const t=R(e.pos);return 0===Number(t[t.length-1])}(v)&&0===v.level&&h<p+u/2&&r({dragNode:E,dropNode:b,dropPosition:-1})&&v.key===n.eventKey?m=-1:(K.children||[]).length&&g.includes(N)?r({dragNode:E,dropNode:b,dropPosition:0})?m=0:C=!1:0===x?f>-1.5?r({dragNode:E,dropNode:b,dropPosition:1})?m=1:C=!1:r({dragNode:E,dropNode:b,dropPosition:0})?m=0:r({dragNode:E,dropNode:b,dropPosition:1})?m=1:C=!1:r({dragNode:E,dropNode:b,dropPosition:1})?m=1:C=!1,{dropPosition:m,dropLevelOffset:x,dropTargetKey:v.key,dropTargetPos:v.pos,dragOverNodeKey:N,dropContainerKey:0===m?null:v.parent?.key||null,dropAllowed:C}}function U(e,t){if(!e)return;const{multiple:n}=t;return n?e.slice():e.length?[e[0]]:e}function B(e){if(!e)return null;let t;if(Array.isArray(e))t={checkedKeys:e,halfCheckedKeys:void 0};else{if("object"!=typeof e)return s(!1,"`checkedKeys` is not an array or an object"),null;t={checkedKeys:e.checked||void 0,halfCheckedKeys:e.halfChecked||void 0}}return t}function W(e,t){const n=new Set;function o(e){if(n.has(e))return;const s=y(t,e);if(!s)return;n.add(e);const{parent:r,node:d}=s;d.disabled||r&&o(r.key)}return(e||[]).forEach(e=>{o(e)}),[...n]}M.isTreeNode=1;function G(){return G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},G.apply(this,arguments)}const F=l.forwardRef((e,t)=>{const{className:o,style:s,motion:r,motionNodes:d,motionType:i,onMotionStart:c,onMotionEnd:h,active:y,treeNodeRequiredProps:u,...f}=e,[g,v]=l.useState(!0),{prefixCls:k}=l.useContext(C),K=d&&"hide"!==i;a(()=>{d&&K!==g&&v(K)},[d]);const m=l.useRef(!1),x=()=>{d&&!m.current&&(m.current=!0,h())};!function(e,t){const[n,o]=l.useState(!1);a(()=>{if(n)return e(),()=>{t()}},[n]),a(()=>(o(!0),()=>{o(!1)}),[])}(()=>{d&&c()},x);const E=e=>{K===e&&x()};return d?l.createElement(p,G({ref:t,visible:g},r,{motionAppear:"show"===i,onVisibleChanged:E}),({className:e,style:t},o)=>l.createElement("div",{ref:o,className:n(`${k}-treenode-motion`,e),style:t},d.map(e=>{const{data:{...t},title:n,key:o,isStart:s,isEnd:r}=e;delete t.children;const d=N(o,u);return l.createElement(M,G({},t,d,{title:n,active:y,data:e.data,key:o,isStart:s,isEnd:r}))}))):l.createElement(M,G({domRef:t,className:o,style:s},f,{active:y}))});function q(e,t,n){const o=e.findIndex(e=>e.key===n),s=e[o+1],r=t.findIndex(e=>e.key===n);if(s){const e=t.findIndex(e=>e.key===s.key);return t.slice(r+1,e)}return t.slice(r+1)}function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},H.apply(this,arguments)}const V={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},X=()=>{},Y=`RC_TREE_MOTION_${Math.random()}`,z={key:Y},J={key:Y,level:0,index:0,pos:"0",node:z,nodes:[z]},Q={parent:null,children:[],pos:J.pos,data:z,title:null,key:Y,isStart:[],isEnd:[]};function Z(e,t,n,o){return!1!==t&&n?e.slice(0,Math.ceil(n/o)+1):e}function ee(e){const{key:t,pos:n}=e;return f(t,n)}const te=l.forwardRef((e,t)=>{const{prefixCls:n,data:o,selectable:s,checkable:r,expandedKeys:d,selectedKeys:i,checkedKeys:c,loadedKeys:p,loadingKeys:y,halfCheckedKeys:u,keyEntities:g,disabled:v,dragging:k,dragOverNodeKey:K,dropPosition:m,motion:x,height:E,itemHeight:b,virtual:C,scrollWidth:D,focusable:S,activeItem:P,focused:O,tabIndex:w,onKeyDown:T,onFocus:L,onBlur:M,onActiveChange:$,onListChangeStart:A,onListChangeEnd:R,...I}=e,j=l.useRef(null),_=l.useRef(null);l.useImperativeHandle(t,()=>({scrollTo:e=>{j.current.scrollTo(e)},getIndentWidth:()=>_.current.offsetWidth}));const[U,B]=l.useState(d),[W,G]=l.useState(o),[z,J]=l.useState(o),[te,ne]=l.useState([]),[oe,se]=l.useState(null),re=l.useRef(o);function de(){const e=re.current;G(e),J(e),ne([]),se(null),R()}re.current=o,a(()=>{B(d);const e=function(e=[],t=[]){const n=e.length,o=t.length;if(1!==Math.abs(n-o))return{add:!1,key:null};function s(e,t){const n=new Map;e.forEach(e=>{n.set(e,!0)});const o=t.filter(e=>!n.has(e));return 1===o.length?o[0]:null}return n<o?{add:!0,key:s(e,t)}:{add:!1,key:s(t,e)}}(U,d);if(null!==e.key)if(e.add){const t=W.findIndex(({key:t})=>t===e.key),n=Z(q(W,o,e.key),C,E,b),s=W.slice();s.splice(t+1,0,Q),J(s),ne(n),se("show")}else{const t=o.findIndex(({key:t})=>t===e.key),n=Z(q(o,W,e.key),C,E,b),s=o.slice();s.splice(t+1,0,Q),J(s),ne(n),se("hide")}else W!==o&&(G(o),J(o))},[d,o]),l.useEffect(()=>{k||de()},[k]);const ae=x?z:o,ie={expandedKeys:d,selectedKeys:i,loadedKeys:p,loadingKeys:y,checkedKeys:c,halfCheckedKeys:u,dragOverNodeKey:K,dropPosition:m,keyEntities:g};return l.createElement(l.Fragment,null,O&&P&&l.createElement("span",{style:V,"aria-live":"assertive"},function(e){let t=String(e.data.key),n=e;for(;n.parent;)n=n.parent,t=`${n.data.key} > ${t}`;return t}(P)),l.createElement("div",null,l.createElement("input",{style:V,disabled:!1===S||v,tabIndex:!1!==S?w:null,onKeyDown:T,onFocus:L,onBlur:M,value:"",onChange:X,"aria-label":"for screen reader"})),l.createElement("div",{className:`${n}-treenode`,"aria-hidden":!0,style:{position:"absolute",pointerEvents:"none",visibility:"hidden",height:0,overflow:"hidden",border:0,padding:0}},l.createElement("div",{className:`${n}-indent`},l.createElement("div",{ref:_,className:`${n}-indent-unit`}))),l.createElement(h,H({},I,{data:ae,itemKey:ee,height:E,fullHeight:!1,virtual:C,itemHeight:b,scrollWidth:D,prefixCls:`${n}-list`,ref:j,role:"tree",onVisibleChange:e=>{e.every(e=>ee(e)!==Y)&&de()}}),e=>{const{pos:t,data:{...n},title:o,key:s,isStart:r,isEnd:d}=e,a=f(s,t);delete n.key,delete n.children;const i=N(a,ie);return l.createElement(F,H({},n,i,{title:o,active:!!P&&s===P.key,pos:t,data:e.data,isStart:r,isEnd:d,motion:x,motionNodes:s===Y?te:null,motionType:oe,onMotionStart:A,onMotionEnd:de,treeNodeRequiredProps:ie,onMouseMove:()=>{$(null)}}))}))});function ne(){return ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},ne.apply(this,arguments)}class oe extends l.Component{constructor(){super(...arguments),t(this,"destroyed",!1),t(this,"delayedDragEnterLogic"),t(this,"loadingRetryTimes",{}),t(this,"state",{keyEntities:{},indent:null,selectedKeys:[],checkedKeys:[],halfCheckedKeys:[],loadedKeys:[],loadingKeys:[],expandedKeys:[],draggingNodeKey:null,dragChildrenKeys:[],dropTargetKey:null,dropPosition:null,dropContainerKey:null,dropLevelOffset:null,dropTargetPos:null,dropAllowed:!0,dragOverNodeKey:null,treeData:[],flattenNodes:[],focused:!1,activeKey:null,listChanging:!1,prevProps:null,fieldNames:g()}),t(this,"dragStartMousePosition",null),t(this,"dragNodeProps",null),t(this,"currentMouseOverDroppableNodeKey",null),t(this,"listRef",l.createRef()),t(this,"onNodeDragStart",(e,t)=>{const{expandedKeys:n,keyEntities:o}=this.state,{onDragStart:s}=this.props,{eventKey:r}=t;this.dragNodeProps=t,this.dragStartMousePosition={x:e.clientX,y:e.clientY};const d=$(n,r);this.setState({draggingNodeKey:r,dragChildrenKeys:I(r,o),indent:this.listRef.current.getIndentWidth()}),this.setExpandedKeys(d),window.addEventListener("dragend",this.onWindowDragEnd),s?.({event:e,node:m(t)})}),t(this,"onNodeDragEnter",(e,t)=>{const{expandedKeys:n,keyEntities:o,dragChildrenKeys:s,flattenNodes:r,indent:d}=this.state,{onDragEnter:a,onExpand:i,allowDrop:l,direction:c}=this.props,{pos:h,eventKey:p}=t;if(this.currentMouseOverDroppableNodeKey!==p&&(this.currentMouseOverDroppableNodeKey=p),!this.dragNodeProps)return void this.resetDragState();const{dropPosition:u,dropLevelOffset:f,dropTargetKey:g,dropContainerKey:v,dropTargetPos:k,dropAllowed:K,dragOverNodeKey:N}=_(e,this.dragNodeProps,t,d,this.dragStartMousePosition,l,r,o,n,c);!s.includes(g)&&K?(this.delayedDragEnterLogic||(this.delayedDragEnterLogic={}),Object.keys(this.delayedDragEnterLogic).forEach(e=>{clearTimeout(this.delayedDragEnterLogic[e])}),this.dragNodeProps.eventKey!==t.eventKey&&(e.persist(),this.delayedDragEnterLogic[h]=window.setTimeout(()=>{if(null===this.state.draggingNodeKey)return;let s=[...n];const r=y(o,t.eventKey);r&&(r.children||[]).length&&(s=A(n,t.eventKey)),this.props.hasOwnProperty("expandedKeys")||this.setExpandedKeys(s),i?.(s,{node:m(t),expanded:!0,nativeEvent:e.nativeEvent})},800)),this.dragNodeProps.eventKey!==g||0!==f?(this.setState({dragOverNodeKey:N,dropPosition:u,dropLevelOffset:f,dropTargetKey:g,dropContainerKey:v,dropTargetPos:k,dropAllowed:K}),a?.({event:e,node:m(t),expandedKeys:n})):this.resetDragState()):this.resetDragState()}),t(this,"onNodeDragOver",(e,t)=>{const{dragChildrenKeys:n,flattenNodes:o,keyEntities:s,expandedKeys:r,indent:d}=this.state,{onDragOver:a,allowDrop:i,direction:l}=this.props;if(!this.dragNodeProps)return;const{dropPosition:c,dropLevelOffset:h,dropTargetKey:p,dropContainerKey:y,dropTargetPos:u,dropAllowed:f,dragOverNodeKey:g}=_(e,this.dragNodeProps,t,d,this.dragStartMousePosition,i,o,s,r,l);!n.includes(p)&&f&&(this.dragNodeProps.eventKey===p&&0===h?null===this.state.dropPosition&&null===this.state.dropLevelOffset&&null===this.state.dropTargetKey&&null===this.state.dropContainerKey&&null===this.state.dropTargetPos&&!1===this.state.dropAllowed&&null===this.state.dragOverNodeKey||this.resetDragState():c===this.state.dropPosition&&h===this.state.dropLevelOffset&&p===this.state.dropTargetKey&&y===this.state.dropContainerKey&&u===this.state.dropTargetPos&&f===this.state.dropAllowed&&g===this.state.dragOverNodeKey||this.setState({dropPosition:c,dropLevelOffset:h,dropTargetKey:p,dropContainerKey:y,dropTargetPos:u,dropAllowed:f,dragOverNodeKey:g}),a?.({event:e,node:m(t)}))}),t(this,"onNodeDragLeave",(e,t)=>{this.currentMouseOverDroppableNodeKey!==t.eventKey||e.currentTarget.contains(e.relatedTarget)||(this.resetDragState(),this.currentMouseOverDroppableNodeKey=null);const{onDragLeave:n}=this.props;n?.({event:e,node:m(t)})}),t(this,"onWindowDragEnd",e=>{this.onNodeDragEnd(e,null,!0),window.removeEventListener("dragend",this.onWindowDragEnd)}),t(this,"onNodeDragEnd",(e,t)=>{const{onDragEnd:n}=this.props;this.setState({dragOverNodeKey:null}),this.cleanDragState(),n?.({event:e,node:m(t)}),this.dragNodeProps=null,window.removeEventListener("dragend",this.onWindowDragEnd)}),t(this,"onNodeDrop",(e,t,n=!1)=>{const{dragChildrenKeys:o,dropPosition:r,dropTargetKey:d,dropTargetPos:a,dropAllowed:i}=this.state;if(!i)return;const{onDrop:l}=this.props;if(this.setState({dragOverNodeKey:null}),this.cleanDragState(),null===d)return;const c={...N(d,this.getTreeNodeRequiredProps()),active:this.getActiveItem()?.key===d,data:y(this.state.keyEntities,d).node},h=o.includes(d);s(!h,"Can not drop to dragNode's children node. This is a bug of rc-tree. Please report an issue.");const p=R(a),u={event:e,node:m(c),dragNode:this.dragNodeProps?m(this.dragNodeProps):null,dragNodesKeys:[this.dragNodeProps.eventKey].concat(o),dropToGap:0!==r,dropPosition:r+Number(p[p.length-1])};n||l?.(u),this.dragNodeProps=null}),t(this,"cleanDragState",()=>{const{draggingNodeKey:e}=this.state;null!==e&&this.setState({draggingNodeKey:null,dropPosition:null,dropContainerKey:null,dropTargetKey:null,dropLevelOffset:null,dropAllowed:!0,dragOverNodeKey:null}),this.dragStartMousePosition=null,this.currentMouseOverDroppableNodeKey=null}),t(this,"triggerExpandActionExpand",(e,t)=>{const{expandedKeys:n,flattenNodes:o}=this.state,{expanded:s,key:r,isLeaf:d}=t;if(d||e.shiftKey||e.metaKey||e.ctrlKey)return;const a=o.filter(e=>e.key===r)[0],i=m({...N(r,this.getTreeNodeRequiredProps()),data:a.data});this.setExpandedKeys(s?$(n,r):A(n,r)),this.onNodeExpand(e,i)}),t(this,"onNodeClick",(e,t)=>{const{onClick:n,expandAction:o}=this.props;"click"===o&&this.triggerExpandActionExpand(e,t),n?.(e,t)}),t(this,"onNodeDoubleClick",(e,t)=>{const{onDoubleClick:n,expandAction:o}=this.props;"doubleClick"===o&&this.triggerExpandActionExpand(e,t),n?.(e,t)}),t(this,"onNodeSelect",(e,t)=>{let{selectedKeys:n}=this.state;const{keyEntities:o,fieldNames:s}=this.state,{onSelect:r,multiple:d}=this.props,{selected:a}=t,i=t[s.key],l=!a;n=l?d?A(n,i):[i]:$(n,i);const c=n.map(e=>{const t=y(o,e);return t?t.node:null}).filter(Boolean);this.setUncontrolledState({selectedKeys:n}),r?.(n,{event:"select",selected:l,node:t,selectedNodes:c,nativeEvent:e.nativeEvent})}),t(this,"onNodeCheck",(e,t,n)=>{const{keyEntities:o,checkedKeys:s,halfCheckedKeys:r}=this.state,{checkStrictly:d,onCheck:a}=this.props,{key:i}=t;let l;const c={event:"check",node:t,checked:n,nativeEvent:e.nativeEvent};if(d){const e=n?A(s,i):$(s,i);l={checked:e,halfChecked:$(r,i)},c.checkedNodes=e.map(e=>y(o,e)).filter(Boolean).map(e=>e.node),this.setUncontrolledState({checkedKeys:e})}else{let{checkedKeys:e,halfCheckedKeys:t}=b([...s,i],!0,o);if(!n){const n=new Set(e);n.delete(i),({checkedKeys:e,halfCheckedKeys:t}=b(Array.from(n),{halfCheckedKeys:t},o))}l=e,c.checkedNodes=[],c.checkedNodesPositions=[],c.halfCheckedKeys=t,e.forEach(e=>{const t=y(o,e);if(!t)return;const{node:n,pos:s}=t;c.checkedNodes.push(n),c.checkedNodesPositions.push({node:n,pos:s})}),this.setUncontrolledState({checkedKeys:e},!1,{halfCheckedKeys:t})}a?.(l,c)}),t(this,"onNodeLoad",e=>{const{key:t}=e,{keyEntities:n}=this.state,o=y(n,t);if(o?.children?.length)return;const r=new Promise((n,o)=>{this.setState(({loadedKeys:r=[],loadingKeys:d=[]})=>{const{loadData:a,onLoad:i}=this.props;if(!a||r.includes(t)||d.includes(t))return null;return a(e).then(()=>{const{loadedKeys:o}=this.state,s=A(o,t);i?.(s,{event:"load",node:e}),this.setUncontrolledState({loadedKeys:s}),this.setState(e=>({loadingKeys:$(e.loadingKeys,t)})),n()}).catch(e=>{if(this.setState(e=>({loadingKeys:$(e.loadingKeys,t)})),this.loadingRetryTimes[t]=(this.loadingRetryTimes[t]||0)+1,this.loadingRetryTimes[t]>=10){const{loadedKeys:e}=this.state;s(!1,"Retry for `loadData` many times but still failed. No more retry."),this.setUncontrolledState({loadedKeys:A(e,t)}),n()}o(e)}),{loadingKeys:A(d,t)}})});return r.catch(()=>{}),r}),t(this,"onNodeMouseEnter",(e,t)=>{const{onMouseEnter:n}=this.props;n?.({event:e,node:t})}),t(this,"onNodeMouseLeave",(e,t)=>{const{onMouseLeave:n}=this.props;n?.({event:e,node:t})}),t(this,"onNodeContextMenu",(e,t)=>{const{onRightClick:n}=this.props;n&&(e.preventDefault(),n({event:e,node:t}))}),t(this,"onFocus",(...e)=>{const{onFocus:t}=this.props;this.setState({focused:!0}),t?.(...e)}),t(this,"onBlur",(...e)=>{const{onBlur:t}=this.props;this.setState({focused:!1}),this.onActiveChange(null),t?.(...e)}),t(this,"getTreeNodeRequiredProps",()=>{const{expandedKeys:e,selectedKeys:t,loadedKeys:n,loadingKeys:o,checkedKeys:s,halfCheckedKeys:r,dragOverNodeKey:d,dropPosition:a,keyEntities:i}=this.state;return{expandedKeys:e||[],selectedKeys:t||[],loadedKeys:n||[],loadingKeys:o||[],checkedKeys:s||[],halfCheckedKeys:r||[],dragOverNodeKey:d,dropPosition:a,keyEntities:i}}),t(this,"setExpandedKeys",e=>{const{treeData:t,fieldNames:n}=this.state,o=k(t,e,n);this.setUncontrolledState({expandedKeys:e,flattenNodes:o},!0)}),t(this,"onNodeExpand",(e,t)=>{let{expandedKeys:n}=this.state;const{listChanging:o,fieldNames:r}=this.state,{onExpand:d,loadData:a}=this.props,{expanded:i}=t,l=t[r.key];if(o)return;const c=n.includes(l),h=!i;if(s(i&&c||!i&&!c,"Expand state not sync with index check"),n=h?A(n,l):$(n,l),this.setExpandedKeys(n),d?.(n,{node:t,expanded:h,nativeEvent:e.nativeEvent}),h&&a){const e=this.onNodeLoad(t);e&&e.then(()=>{const e=k(this.state.treeData,n,r);this.setUncontrolledState({flattenNodes:e})}).catch(()=>{const{expandedKeys:e}=this.state,t=$(e,l);this.setExpandedKeys(t)})}}),t(this,"onListChangeStart",()=>{this.setUncontrolledState({listChanging:!0})}),t(this,"onListChangeEnd",()=>{setTimeout(()=>{this.setUncontrolledState({listChanging:!1})})}),t(this,"onActiveChange",e=>{const{activeKey:t}=this.state,{onActiveChange:n,itemScrollOffset:o=0}=this.props;t!==e&&(this.setState({activeKey:e}),null!==e&&this.scrollTo({key:e,offset:o}),n?.(e))}),t(this,"getActiveItem",()=>{const{activeKey:e,flattenNodes:t}=this.state;return null===e?null:t.find(({key:t})=>t===e)||null}),t(this,"offsetActiveKey",e=>{const{flattenNodes:t,activeKey:n}=this.state;let o=t.findIndex(({key:e})=>e===n);-1===o&&e<0&&(o=t.length),o=(o+e+t.length)%t.length;const s=t[o];if(s){const{key:e}=s;this.onActiveChange(e)}else this.onActiveChange(null)}),t(this,"onKeyDown",e=>{const{activeKey:t,expandedKeys:n,checkedKeys:o,fieldNames:s}=this.state,{onKeyDown:r,checkable:d,selectable:a}=this.props;switch(e.which){case i.UP:this.offsetActiveKey(-1),e.preventDefault();break;case i.DOWN:this.offsetActiveKey(1),e.preventDefault()}const l=this.getActiveItem();if(l&&l.data){const r=this.getTreeNodeRequiredProps(),c=!1===l.data.isLeaf||!!(l.data[s.children]||[]).length,h=m({...N(t,r),data:l.data,active:!0});switch(e.which){case i.LEFT:c&&n.includes(t)?this.onNodeExpand({},h):l.parent&&this.onActiveChange(l.parent.key),e.preventDefault();break;case i.RIGHT:c&&!n.includes(t)?this.onNodeExpand({},h):l.children&&l.children.length&&this.onActiveChange(l.children[0].key),e.preventDefault();break;case i.ENTER:case i.SPACE:!d||h.disabled||!1===h.checkable||h.disableCheckbox?d||!a||h.disabled||!1===h.selectable||this.onNodeSelect({},h):this.onNodeCheck({},h,!o.includes(t))}}r?.(e)}),t(this,"setUncontrolledState",(e,t=!1,n=null)=>{if(!this.destroyed){let o=!1,s=!0;const r={};Object.keys(e).forEach(t=>{this.props.hasOwnProperty(t)?s=!1:(o=!0,r[t]=e[t])}),!o||t&&!s||this.setState({...r,...n})}}),t(this,"scrollTo",e=>{this.listRef.current.scrollTo(e)})}componentDidMount(){this.destroyed=!1,this.onUpdated()}componentDidUpdate(){this.onUpdated()}onUpdated(){const{activeKey:e,itemScrollOffset:t=0}=this.props;void 0!==e&&e!==this.state.activeKey&&(this.setState({activeKey:e}),null!==e&&this.scrollTo({key:e,offset:t}))}componentWillUnmount(){window.removeEventListener("dragend",this.onWindowDragEnd),this.destroyed=!0}static getDerivedStateFromProps(e,t){const{prevProps:n}=t,o={prevProps:e};function r(t){return!n&&e.hasOwnProperty(t)||n&&n[t]!==e[t]}let d,{fieldNames:a}=t;if(r("fieldNames")&&(a=g(e.fieldNames),o.fieldNames=a),r("treeData")?({treeData:d}=e):r("children")&&(s(!1,"`children` of Tree is deprecated. Please use `treeData` instead."),d=v(e.children)),d){o.treeData=d;const e=K(d,{fieldNames:a});o.keyEntities={[Y]:J,...e.keyEntities}}const i=o.keyEntities||t.keyEntities;if(r("expandedKeys")||n&&r("autoExpandParent"))o.expandedKeys=e.autoExpandParent||!n&&e.defaultExpandParent?W(e.expandedKeys,i):e.expandedKeys;else if(!n&&e.defaultExpandAll){const e={...i};delete e[Y];const t=[];Object.keys(e).forEach(n=>{const o=e[n];o.children&&o.children.length&&t.push(o.key)}),o.expandedKeys=t}else!n&&e.defaultExpandedKeys&&(o.expandedKeys=e.autoExpandParent||e.defaultExpandParent?W(e.defaultExpandedKeys,i):e.defaultExpandedKeys);if(o.expandedKeys||delete o.expandedKeys,d||o.expandedKeys){const e=k(d||t.treeData,o.expandedKeys||t.expandedKeys,a);o.flattenNodes=e}if(e.selectable&&(r("selectedKeys")?o.selectedKeys=U(e.selectedKeys,e):!n&&e.defaultSelectedKeys&&(o.selectedKeys=U(e.defaultSelectedKeys,e))),e.checkable){let s;if(r("checkedKeys")?s=B(e.checkedKeys)||{}:!n&&e.defaultCheckedKeys?s=B(e.defaultCheckedKeys)||{}:d&&(s=B(e.checkedKeys)||{checkedKeys:t.checkedKeys,halfCheckedKeys:t.halfCheckedKeys}),s){let{checkedKeys:t=[],halfCheckedKeys:n=[]}=s;if(!e.checkStrictly){const e=b(t,!0,i);({checkedKeys:t,halfCheckedKeys:n}=e)}o.checkedKeys=t,o.halfCheckedKeys=n}}return r("loadedKeys")&&(o.loadedKeys=e.loadedKeys),o}resetDragState(){this.setState({dragOverNodeKey:null,dropPosition:null,dropLevelOffset:null,dropTargetKey:null,dropContainerKey:null,dropTargetPos:null,dropAllowed:!1})}render(){const{focused:e,flattenNodes:t,keyEntities:o,draggingNodeKey:s,activeKey:r,dropLevelOffset:a,dropContainerKey:i,dropTargetKey:c,dropPosition:h,dragOverNodeKey:p,indent:y}=this.state,{prefixCls:u,className:f,style:g,styles:v,classNames:k,showLine:K,focusable:N,tabIndex:m=0,selectable:x,showIcon:E,icon:b,switcherIcon:D,draggable:S,checkable:P,checkStrictly:O,disabled:w,motion:T,loadData:L,filterTreeNode:M,height:$,itemHeight:A,scrollWidth:R,virtual:I,titleRender:j,dropIndicatorRender:_,onContextMenu:U,onScroll:B,direction:W,rootClassName:G,rootStyle:F}=this.props,q=d(this.props,{aria:!0,data:!0});let H;S&&(H="object"==typeof S?S:"function"==typeof S?{nodeDraggable:S}:{});const V={styles:v,classNames:k,prefixCls:u,selectable:x,showIcon:E,icon:b,switcherIcon:D,draggable:H,draggingNodeKey:s,checkable:P,checkStrictly:O,disabled:w,keyEntities:o,dropLevelOffset:a,dropContainerKey:i,dropTargetKey:c,dropPosition:h,dragOverNodeKey:p,indent:y,direction:W,dropIndicatorRender:_,loadData:L,filterTreeNode:M,titleRender:j,onNodeClick:this.onNodeClick,onNodeDoubleClick:this.onNodeDoubleClick,onNodeExpand:this.onNodeExpand,onNodeSelect:this.onNodeSelect,onNodeCheck:this.onNodeCheck,onNodeLoad:this.onNodeLoad,onNodeMouseEnter:this.onNodeMouseEnter,onNodeMouseLeave:this.onNodeMouseLeave,onNodeContextMenu:this.onNodeContextMenu,onNodeDragStart:this.onNodeDragStart,onNodeDragEnter:this.onNodeDragEnter,onNodeDragOver:this.onNodeDragOver,onNodeDragLeave:this.onNodeDragLeave,onNodeDragEnd:this.onNodeDragEnd,onNodeDrop:this.onNodeDrop};return l.createElement(C.Provider,{value:V},l.createElement("div",{className:n(u,f,G,{[`${u}-show-line`]:K,[`${u}-focused`]:e,[`${u}-active-focused`]:null!==r}),style:F},l.createElement(te,ne({ref:this.listRef,prefixCls:u,style:g,data:t,disabled:w,selectable:x,checkable:!!P,motion:T,dragging:null!==s,height:$,itemHeight:A,virtual:I,focusable:N,focused:e,tabIndex:m,activeItem:this.getActiveItem(),onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onActiveChange:this.onActiveChange,onListChangeStart:this.onListChangeStart,onListChangeEnd:this.onListChangeEnd,onContextMenu:U,onScroll:B,scrollWidth:R},this.getTreeNodeRequiredProps(),q))))}}t(oe,"defaultProps",{prefixCls:"rc-tree",showLine:!1,showIcon:!0,selectable:!0,multiple:!1,checkable:!1,disabled:!1,checkStrictly:!1,draggable:!1,defaultExpandParent:!0,autoExpandParent:!1,defaultExpandAll:!1,defaultExpandedKeys:[],defaultCheckedKeys:[],defaultSelectedKeys:[],dropIndicatorRender:e=>{const{dropPosition:t,dropLevelOffset:n,indent:o}=e,s={pointerEvents:"none",position:"absolute",right:0,backgroundColor:"red",height:2};switch(t){case-1:s.top=0,s.left=-n*o;break;case 1:s.bottom=0,s.left=-n*o;break;case 0:s.bottom=0,s.left=o}return c.createElement("div",{style:s})},allowDrop:()=>!0,expandAction:!1}),t(oe,"TreeNode",M);export{oe as T,D as U,b as a,$ as b,K as c,A as d,W as e,g as f,v as g,M as h};
