import{r as e,e as t}from"./react@18.3.1.zoCbf7Ot.js";import{r as n}from"./react-dom@18.3.1_react@18.3.1.BHWKb6f6.js";import{c as o}from"./clsx@2.1.1.DMqMD_4V.js";import{a as s}from"./@rc-component_motion@1.1.6__dd380705019fc1f37cb412b879364c7d.CnAyZ8EB.js";import{p as c,K as l,e as r}from"./@rc-component_util@1.7.0_re_e38ee95702524036372f825efc96e921.ChzNieGb.js";function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a.apply(this,arguments)}const i=e.forwardRef((t,n)=>{var s;const{prefixCls:r,style:i,className:u,duration:f=4.5,showProgress:m,pauseOnHover:d=!0,eventKey:p,content:y,closable:v,props:h,onClick:g,onNoticeClose:k,times:E,hovering:N}=t,[b,C]=e.useState(!1),[x,j]=e.useState(0),[w,O]=e.useState(0),R=N||b,S="number"==typeof f?f:0,A=S>0&&m,M=()=>{k(p)};e.useEffect(()=>{if(!R&&S>0){const e=Date.now()-w,t=setTimeout(()=>{M()},1e3*S-w);return()=>{d&&clearTimeout(t),O(Date.now()-e)}}},[S,R,E]),e.useEffect(()=>{if(!R&&A&&(d||0===w)){const e=performance.now();let t;const n=()=>{cancelAnimationFrame(t),t=requestAnimationFrame(t=>{const o=t+w-e,s=Math.min(o/(1e3*S),1);j(100*s),s<1&&n()})};return n(),()=>{d&&cancelAnimationFrame(t)}}},[S,w,R,A,E]);const _=e.useMemo(()=>"object"==typeof v&&null!==v?v:{},[v]),P=c(_,!0),H=100-(!x||x<0?0:x>100?100:x),L="".concat(r,"-notice");return e.createElement("div",a({},h,{ref:n,className:o(L,u,{["".concat(L,"-closable")]:v}),style:i,onMouseEnter:e=>{var t;C(!0),null==(t=null==h?void 0:h.onMouseEnter)||t.call(h,e)},onMouseLeave:e=>{var t;C(!1),null==(t=null==h?void 0:h.onMouseLeave)||t.call(h,e)},onClick:g}),e.createElement("div",{className:"".concat(L,"-content")},y),v&&e.createElement("button",a({className:"".concat(L,"-close"),onKeyDown:e=>{"Enter"!==e.key&&"Enter"!==e.code&&e.keyCode!==l.ENTER||M()},"aria-label":"Close"},P,{onClick:e=>{e.preventDefault(),e.stopPropagation(),M()}}),null!=(s=_.closeIcon)?s:"x"),A&&e.createElement("progress",{className:"".concat(L,"-progress"),max:"100",value:H},H+"%"))}),u=t.createContext({}),f=({children:e,classNames:n})=>t.createElement(u.Provider,{value:{classNames:n}},e);function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},m.apply(this,arguments)}const d=n=>{const{configList:c,placement:l,prefixCls:r,className:a,style:f,motion:d,onAllNoticeRemoved:p,onNoticeClose:y,stack:v}=n,{classNames:h}=e.useContext(u),g=e.useRef({}),[k,E]=e.useState(null),[N,b]=e.useState([]),C=c.map(e=>({config:e,key:String(e.key)})),[x,{offset:j,threshold:w,gap:O}]=(e=>{var t,n,o;const s={offset:8,threshold:3,gap:16};return e&&"object"==typeof e&&(s.offset=null!=(t=e.offset)?t:8,s.threshold=null!=(n=e.threshold)?n:3,s.gap=null!=(o=e.gap)?o:16),[!!e,s]})(v),R=x&&(N.length>0||C.length<=w),S="function"==typeof d?d(l):d;return e.useEffect(()=>{x&&N.length>1&&b(e=>e.filter(e=>C.some(({key:t})=>e===t)))},[N,C,x]),e.useEffect(()=>{var e,t;x&&g.current[null==(e=C[C.length-1])?void 0:e.key]&&E(g.current[null==(t=C[C.length-1])?void 0:t.key])},[C,x]),t.createElement(s,m({key:l,className:o(r,"".concat(r,"-").concat(l),null==h?void 0:h.list,a,{["".concat(r,"-stack")]:!!x,["".concat(r,"-stack-expanded")]:R}),style:f,keys:C,motionAppear:!0},S,{onAllRemoved:()=>{p(l)}}),({config:e,className:n,style:s,index:c},a)=>{var u,f,d,p;const{key:v,times:E}=e,w=String(v),{className:S,style:A,classNames:M,styles:_,...P}=e,H=C.findIndex(e=>e.key===w),L={};if(x){const e=C.length-1-(H>-1?H:c-1),t="top"===l||"bottom"===l?"-50%":"0";if(e>0){L.height=R?null==(u=g.current[w])?void 0:u.offsetHeight:null==k?void 0:k.offsetHeight;let n=0;for(let t=0;t<e;t++)n+=(null==(f=g.current[C[C.length-1-t].key])?void 0:f.offsetHeight)+O;const o=(R?n:e*j)*(l.startsWith("top")?1:-1),s=!R&&(null==k?void 0:k.offsetWidth)&&(null==(d=g.current[w])?void 0:d.offsetWidth)?((null==k?void 0:k.offsetWidth)-2*j*(e<3?e:3))/(null==(p=g.current[w])?void 0:p.offsetWidth):1;L.transform="translate3d(".concat(t,", ").concat(o,"px, 0) scaleX(").concat(s,")")}else L.transform="translate3d(".concat(t,", 0, 0)")}return t.createElement("div",{ref:a,className:o("".concat(r,"-notice-wrapper"),n,null==M?void 0:M.wrapper),style:{...s,...L,...null==_?void 0:_.wrapper},onMouseEnter:()=>b(e=>e.includes(w)?e:[...e,w]),onMouseLeave:()=>b(e=>e.filter(e=>e!==w))},t.createElement(i,m({},P,{ref:e=>{H>-1?g.current[w]=e:delete g.current[w]},prefixCls:r,classNames:M,styles:_,className:o(S,null==h?void 0:h.notice),style:A,times:E,key:v,eventKey:v,onNoticeClose:y,hovering:x&&N.length>0})))})},p=e.forwardRef((t,o)=>{const{prefixCls:s="rc-notification",container:c,motion:l,maxCount:r,className:a,style:i,onAllRemoved:u,stack:f,renderNotifications:m}=t,[p,y]=e.useState([]),v=e=>{var t;const n=p.find(t=>t.key===e),o=null==n?void 0:n.closable,s=o&&"object"==typeof o?o:{},{onClose:c}=s;null==c||c(),null==(t=null==n?void 0:n.onClose)||t.call(n),y(t=>t.filter(t=>t.key!==e))};e.useImperativeHandle(o,()=>({open:e=>{y(t=>{var n;let o=[...t];const s=o.findIndex(t=>t.key===e.key),c={...e};return s>=0?(c.times=((null==(n=t[s])?void 0:n.times)||0)+1,o[s]=c):(c.times=0,o.push(c)),r>0&&o.length>r&&(o=o.slice(-r)),o})},close:e=>{v(e)},destroy:()=>{y([])}}));const[h,g]=e.useState({});e.useEffect(()=>{const e={};p.forEach(t=>{const{placement:n="topRight"}=t;n&&(e[n]=e[n]||[],e[n].push(t))}),Object.keys(h).forEach(t=>{e[t]=e[t]||[]}),g(e)},[p]);const k=e=>{g(t=>{const n={...t};return(n[e]||[]).length||delete n[e],n})},E=e.useRef(!1);if(e.useEffect(()=>{Object.keys(h).length>0?E.current=!0:E.current&&(null==u||u(),E.current=!1)},[h]),!c)return null;const N=Object.keys(h);return n.createPortal(e.createElement(e.Fragment,null,N.map(t=>{const n=h[t],o=e.createElement(d,{key:t,configList:n,placement:t,prefixCls:s,className:null==a?void 0:a(t),style:null==i?void 0:i(t),motion:l,onNoticeClose:v,onAllNoticeRemoved:k,stack:f});return m?m(o,{prefixCls:s,key:t}):o})),c)}),y=()=>document.body;let v=0;function h(t={}){const{getContainer:n=y,motion:o,prefixCls:s,maxCount:c,className:l,style:a,onAllRemoved:i,stack:u,renderNotifications:f,...m}=t,[d,h]=e.useState(),g=e.useRef(),k=e.createElement(p,{container:d,ref:g,prefixCls:s,motion:o,maxCount:c,className:l,style:a,onAllRemoved:i,stack:u,renderNotifications:f}),[E,N]=e.useState([]),b=r(e=>{const t=function(...e){const t={};return e.forEach(e=>{e&&Object.keys(e).forEach(n=>{const o=e[n];void 0!==o&&(t[n]=o)})}),t}(m,e);null!==t.key&&void 0!==t.key||(t.key="rc-notification-".concat(v),v+=1),N(e=>[...e,{type:"open",config:t}])}),C=e.useMemo(()=>({open:b,close:e=>{N(t=>[...t,{type:"close",key:e}])},destroy:()=>{N(e=>[...e,{type:"destroy"}])}}),[]);return e.useEffect(()=>{h(n())}),e.useEffect(()=>{if(g.current&&E.length){let e,t;E.forEach(e=>{switch(e.type){case"open":g.current.open(e.config);break;case"close":g.current.close(e.key);break;case"destroy":g.current.destroy()}}),N(n=>(e===n&&t||(e=n,t=n.filter(e=>!E.includes(e))),t))}},[E]),[C,k]}export{i as N,f as a,h as u};
