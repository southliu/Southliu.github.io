import{c as e,h as t,H as n,a as o,r as c,f as r,e as s,s as i,n as u,j as l}from"./@rc-component_util@1.7.0_re_e38ee95702524036372f825efc96e921.ChzNieGb.js";import{r as d}from"./react@18.3.1.zoCbf7Ot.js";import{r as a}from"./react-dom@18.3.1_react@18.3.1.BHWKb6f6.js";const f=d.createContext(null);const m=[];const w="rc-util-locker-".concat(Date.now());let p=0;function h(e){const r=!!e,[s]=d.useState(()=>(p+=1,"".concat(w,"_").concat(p)));t(()=>{if(r){const e=n(document.body).width,t=document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth;o("\nhtml body {\n  overflow-y: hidden;\n  ".concat(t?"width: calc(100% - ".concat(e,"px);"):"","\n}"),s)}else c(s);return()=>{c(s)}},[r,s])}let E=[];let v=0;const y=e=>{if("Escape"===e.key&&!e.isComposing){if(Date.now()-v<200)return;const t=E.length;for(let n=t-1;n>=0;n-=1)E[n].onEsc({top:n===t-1,event:e})}},g=()=>{v=Date.now()};function b(e,t){const n=r(),o=s(t),c=()=>{E.find(e=>e.id===n)||E.push({id:n,onEsc:o})},i=()=>{E=E.filter(e=>e.id!==n)};d.useMemo(()=>{e?c():e||i()},[e]),d.useEffect(()=>{if(e)return c(),window.addEventListener("keydown",y),window.addEventListener("compositionend",g),()=>{i(),0===E.length&&(window.removeEventListener("keydown",y),window.removeEventListener("compositionend",g))}},[e])}const k=t=>!1!==t&&(e()&&t?"string"==typeof t?document.querySelector(t):"function"==typeof t?t():t:null),C=d.forwardRef((n,o)=>{const{open:c,autoLock:r,getContainer:s,debug:w,autoDestroy:p=!0,children:E,onEsc:v}=n,[y,g]=d.useState(c),C=y||c;d.useEffect(()=>{(p||c)&&g(c)},[c,p]);const[S,L]=d.useState(()=>k(s));d.useEffect(()=>{const e=k(s);L(()=>null!=e?e:null)});const[_,j]=function(n){const[o]=d.useState(()=>e()?document.createElement("div"):null),c=d.useRef(!1),r=d.useContext(f),[s,i]=d.useState(m),u=r||(c.current?void 0:e=>{i(t=>[e,...t])});function l(){o.parentElement||document.body.appendChild(o),c.current=!0}function a(){var e;null==(e=o.parentElement)||e.removeChild(o),c.current=!1}return t(()=>(n?r?r(l):l():a(),a),[n]),t(()=>{s.length&&(s.forEach(e=>e()),i(m))},[s]),[o,u]}(C&&!S),x=null!=S?S:_;h(r&&c&&e()&&(x===_||x===document.body)),b(c,v);let D=null;E&&i(E)&&o&&(D=u(E));const H=l(D,o);if(!C||!e()||void 0===S)return null;const P=!1===x||!1;let R=E;return o&&(R=d.cloneElement(E,{ref:H})),d.createElement(f.Provider,{value:j},P?R:a.createPortal(R,x))});export{C as P};
