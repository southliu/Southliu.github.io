import{c as e,h as t,H as n,a as o,r as c,f as r,e as s,s as i,n as d,j as a}from"./@rc-component_util@1.7.0_re_97ed4941f5d27d044aa2ecbc4a75f304.4n28hD7h.js";import{r as u}from"./react@19.2.3.DikTGMTS.js";import{r as l}from"./react-dom@19.2.3_react@19.2.3.Z7zCFVOQ.js";const f=u.createContext(null);const m=[];const w="rc-util-locker-".concat(Date.now());let p=0;function h(e){const r=!!e,[s]=u.useState(()=>(p+=1,"".concat(w,"_").concat(p)));t(()=>{if(r){const e=n(document.body).width,t=document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth;o("\nhtml body {\n  overflow-y: hidden;\n  ".concat(t?"width: calc(100% - ".concat(e,"px);"):"","\n}"),s)}else c(s);return()=>{c(s)}},[r,s])}let E=[];let v=0;const y=e=>{if("Escape"===e.key&&!e.isComposing){if(Date.now()-v<200)return;const t=E.length;for(let n=t-1;n>=0;n-=1)E[n].onEsc({top:n===t-1,event:e})}},g=()=>{v=Date.now()};function b(e,t){const n=r(),o=s(t),c=()=>{E.find(e=>e.id===n)||E.push({id:n,onEsc:o})},i=()=>{E=E.filter(e=>e.id!==n)};u.useMemo(()=>{e?c():e||i()},[e]),u.useEffect(()=>{if(e)return c(),window.addEventListener("keydown",y),window.addEventListener("compositionend",g),()=>{i(),0===E.length&&(window.removeEventListener("keydown",y),window.removeEventListener("compositionend",g))}},[e])}const k=t=>!1!==t&&(e()&&t?"string"==typeof t?document.querySelector(t):"function"==typeof t?t():t:null),C=u.forwardRef((n,o)=>{const{open:c,autoLock:r,getContainer:s,debug:w,autoDestroy:p=!0,children:E,onEsc:v}=n,[y,g]=u.useState(c),C=y||c;u.useEffect(()=>{(p||c)&&g(c)},[c,p]);const[S,L]=u.useState(()=>k(s));u.useEffect(()=>{const e=k(s);L(()=>null!=e?e:null)});const[_,j]=function(n){const[o]=u.useState(()=>e()?document.createElement("div"):null),c=u.useRef(!1),r=u.useContext(f),[s,i]=u.useState(m),d=r||(c.current?void 0:e=>{i(t=>[e,...t])});function a(){o.parentElement||document.body.appendChild(o),c.current=!0}function l(){var e;null==(e=o.parentElement)||e.removeChild(o),c.current=!1}return t(()=>(n?r?r(a):a():l(),l),[n]),t(()=>{s.length&&(s.forEach(e=>e()),i(m))},[s]),[o,d]}(C&&!S),x=null!=S?S:_;h(r&&c&&e()&&(x===_||x===document.body)),b(c,v);let D=null;E&&i(E)&&o&&(D=d(E));const H=a(D,o);if(!C||!e()||void 0===S)return null;const P=!1===x||!1;let R=E;return o&&(R=u.cloneElement(E,{ref:H})),u.createElement(f.Provider,{value:j},P?R:l.createPortal(R,x))});export{C as P};
