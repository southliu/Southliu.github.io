import{d as e,k as n,i as r,h as t,f as a}from"./@babel_runtime@7.28.3.BsXYqacS.js";import{n as u,t as s,g as o,a as c,v as i,b as l}from"./@rc-component_mini-decimal@1.1.0.4EUWm7g9.js";import{c as f}from"./classnames@2.5.1.DzaQuX-8.js";import{B as d,t as p}from"./rc-input@1.8.0_react-dom@19.1.1_react@19.1.1__react@19.1.1.BStWp2MJ.js";import{r as m}from"./react@19.1.1.DFOJwFPq.js";import{d as v,v as b,N as g,O as N,P as E,l as h}from"./rc-util@5.44.4_react-dom@19.1.1_react@19.1.1__react@19.1.1.Cptqj8wH.js";function w(r){var t=r.prefixCls,a=r.upNode,u=r.downNode,s=r.upDisabled,o=r.downDisabled,c=r.onStep,i=m.useRef(),l=m.useRef([]),d=m.useRef();d.current=c;var p=function(){clearTimeout(i.current)},v=function(e,n){e.preventDefault(),p(),d.current(n),i.current=setTimeout(function e(){d.current(n),i.current=setTimeout(e,200)},600)};if(m.useEffect(function(){return function(){p(),l.current.forEach(function(e){return b.cancel(e)})}},[]),g())return null;var N="".concat(t,"-handler"),E=f(N,"".concat(N,"-up"),e({},"".concat(N,"-up-disabled"),s)),h=f(N,"".concat(N,"-down"),e({},"".concat(N,"-down-disabled"),o)),w=function(){return l.current.push(b(p))},x={unselectable:"on",role:"button",onMouseUp:w,onMouseLeave:w};return m.createElement("div",{className:"".concat(N,"-wrap")},m.createElement("span",n({},x,{onMouseDown:function(e){v(e,!0)},"aria-label":"Increase Value","aria-disabled":s,className:E}),a||m.createElement("span",{unselectable:"on",className:"".concat(t,"-handler-up-inner")})),m.createElement("span",n({},x,{onMouseDown:function(e){v(e,!1)},"aria-label":"Decrease Value","aria-disabled":o,className:h}),u||m.createElement("span",{unselectable:"on",className:"".concat(t,"-handler-down-inner")})))}function x(e){var n="number"==typeof e?u(e):s(e).fullStr;return n.includes(".")?s(n.replace(/(\d)\.(\d)/g,"$1$2.")).fullStr:e+"0"}var y=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","changeOnWheel","controls","classNames","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep","changeOnBlur","domRef"],S=["disabled","style","prefixCls","value","prefix","suffix","addonBefore","addonAfter","className","classNames"],R=function(e,n){return e||n.isEmpty()?n.toString():n.toNumber()},C=function(e){var n=o(e);return n.isInvalidate()?null:n},I=m.forwardRef(function(s,d){var p=s.prefixCls,g=s.className,N=s.style,S=s.min,I=s.max,D=s.step,M=void 0===D?1:D,_=s.defaultValue,B=s.value,O=s.disabled,T=s.readOnly,k=s.upHandler,A=s.downHandler,j=s.keyboard,q=s.changeOnWheel,U=void 0!==q&&q,W=s.controls,H=void 0===W||W;s.classNames;var P=s.stringMode,V=s.parser,K=s.formatter,L=s.precision,F=s.decimalSeparator,$=s.onChange,Y=s.onInput,z=s.onPressEnter,G=s.onStep,J=s.changeOnBlur,Q=void 0===J||J,X=s.domRef,Z=r(s,y),ee="".concat(p,"-input"),ne=m.useRef(null),re=m.useState(!1),te=t(re,2),ae=te[0],ue=te[1],se=m.useRef(!1),oe=m.useRef(!1),ce=m.useRef(!1),ie=m.useState(function(){return o(null!=B?B:_)}),le=t(ie,2),fe=le[0],de=le[1];var pe=m.useCallback(function(e,n){if(!n)return L>=0?L:Math.max(c(e),c(M))},[L,M]),me=m.useCallback(function(e){var n=String(e);if(V)return V(n);var r=n;return F&&(r=r.replace(F,".")),r.replace(/[^\w.-]+/g,"")},[V,F]),ve=m.useRef(""),be=m.useCallback(function(e,n){if(K)return K(e,{userTyping:n,input:String(ve.current)});var r="number"==typeof e?u(e):e;if(!n){var t=pe(r,n);if(i(r)&&(F||t>=0))r=l(r,F||".",t)}return r},[K,pe,F]),ge=m.useState(function(){var e=null!=_?_:B;return fe.isInvalidate()&&["string","number"].includes(a(e))?Number.isNaN(e)?"":e:be(fe.toString(),!1)}),Ne=t(ge,2),Ee=Ne[0],he=Ne[1];function we(e,n){he(be(e.isInvalidate()?e.toString(!1):e.toString(!n),n))}ve.current=Ee;var xe,ye,Se,Re,Ce,Ie=m.useMemo(function(){return C(I)},[I,L]),De=m.useMemo(function(){return C(S)},[S,L]),Me=m.useMemo(function(){return!(!Ie||!fe||fe.isInvalidate())&&Ie.lessEquals(fe)},[Ie,fe]),_e=m.useMemo(function(){return!(!De||!fe||fe.isInvalidate())&&fe.lessEquals(De)},[De,fe]),Be=(xe=ne.current,ye=ae,Se=m.useRef(null),[function(){try{var e=xe.selectionStart,n=xe.selectionEnd,r=xe.value,t=r.substring(0,e),a=r.substring(n);Se.current={start:e,end:n,value:r,beforeTxt:t,afterTxt:a}}catch(u){}},function(){if(xe&&Se.current&&ye)try{var e=xe.value,n=Se.current,r=n.beforeTxt,t=n.afterTxt,a=n.start,u=e.length;if(e.startsWith(r))u=r.length;else if(e.endsWith(t))u=e.length-Se.current.afterTxt.length;else{var s=r[a-1],o=e.indexOf(s,a-1);-1!==o&&(u=o+1)}xe.setSelectionRange(u,u)}catch(c){v(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(c.message))}}]),Oe=t(Be,2),Te=Oe[0],ke=Oe[1],Ae=function(e){return Ie&&!e.lessEquals(Ie)?Ie:De&&!De.lessEquals(e)?De:null},je=function(e){return!Ae(e)},qe=function(e,n){var r,t=e,a=je(t)||t.isEmpty();if(t.isEmpty()||n||(t=Ae(t)||t,a=!0),!T&&!O&&a){var u=t.toString(),s=pe(u,n);return s>=0&&(t=o(l(u,".",s)),je(t)||(t=o(l(u,".",s,!0)))),t.equals(fe)||(r=t,void 0===B&&de(r),null==$||$(t.isEmpty()?null:R(P,t)),void 0===B&&we(t,n)),t}return fe},Ue=(Re=m.useRef(0),Ce=function(){b.cancel(Re.current)},m.useEffect(function(){return Ce},[]),function(e){Ce(),Re.current=b(function(){e()})}),We=function e(n){if(Te(),ve.current=n,he(n),!oe.current){var r=me(n),t=o(r);t.isNaN()||qe(t,!0)}null==Y||Y(n),Ue(function(){var r=n;V||(r=n.replace(/ã€‚/g,".")),r!==n&&e(r)})},He=function(e){var n;if(!(e&&Me||!e&&_e)){se.current=!1;var r=o(ce.current?x(M):M);e||(r=r.negate());var t=(fe||o(0)).add(r.toString()),a=qe(t,!1);null==G||G(R(P,a),{offset:ce.current?x(M):M,type:e?"up":"down"}),null===(n=ne.current)||void 0===n||n.focus()}},Pe=function(e){var n,r=o(me(Ee));n=r.isNaN()?qe(fe,e):qe(r,e),void 0!==B?we(fe,!1):n.isNaN()||we(n,!1)};m.useEffect(function(){if(U&&ae){var e=function(e){He(e.deltaY<0),e.preventDefault()},n=ne.current;if(n)return n.addEventListener("wheel",e,{passive:!1}),function(){return n.removeEventListener("wheel",e)}}});return E(function(){fe.isInvalidate()||we(fe,!1)},[L,K]),E(function(){var e=o(B);de(e);var n=o(me(Ee));e.equals(n)&&se.current&&!K||we(e,se.current)},[B]),E(function(){K&&ke()},[Ee]),m.createElement("div",{ref:X,className:f(p,g,e(e(e(e(e({},"".concat(p,"-focused"),ae),"".concat(p,"-disabled"),O),"".concat(p,"-readonly"),T),"".concat(p,"-not-a-number"),fe.isNaN()),"".concat(p,"-out-of-range"),!fe.isInvalidate()&&!je(fe))),style:N,onFocus:function(){ue(!0)},onBlur:function(){Q&&Pe(!1),ue(!1),se.current=!1},onKeyDown:function(e){var n=e.key,r=e.shiftKey;se.current=!0,ce.current=r,"Enter"===n&&(oe.current||(se.current=!1),Pe(!1),null==z||z(e)),!1!==j&&!oe.current&&["Up","ArrowUp","Down","ArrowDown"].includes(n)&&(He("Up"===n||"ArrowUp"===n),e.preventDefault())},onKeyUp:function(){se.current=!1,ce.current=!1},onCompositionStart:function(){oe.current=!0},onCompositionEnd:function(){oe.current=!1,We(ne.current.value)},onBeforeInput:function(){se.current=!0}},H&&m.createElement(w,{prefixCls:p,upNode:k,downNode:A,upDisabled:Me,downDisabled:_e,onStep:He}),m.createElement("div",{className:"".concat(ee,"-wrap")},m.createElement("input",n({autoComplete:"off",role:"spinbutton","aria-valuemin":S,"aria-valuemax":I,"aria-valuenow":fe.isInvalidate()?null:fe.toString(),step:M},Z,{ref:h(ne,d),className:ee,value:Ee,onChange:function(e){We(e.target.value)},disabled:O,readOnly:T}))))}),D=m.forwardRef(function(e,t){var a=e.disabled,u=e.style,s=e.prefixCls,o=void 0===s?"rc-input-number":s,c=e.value,i=e.prefix,l=e.suffix,f=e.addonBefore,v=e.addonAfter,b=e.className,g=e.classNames,E=r(e,S),h=m.useRef(null),w=m.useRef(null),x=m.useRef(null),y=function(e){x.current&&p(x.current,e)};return m.useImperativeHandle(t,function(){return N(x.current,{focus:y,nativeElement:h.current.nativeElement||w.current})}),m.createElement(d,{className:b,triggerFocus:y,prefixCls:o,value:c,disabled:a,style:u,prefix:i,suffix:l,addonAfter:v,addonBefore:f,classNames:g,components:{affixWrapper:"div",groupWrapper:"div",wrapper:"div",groupAddon:"div"},ref:h},m.createElement(I,n({prefixCls:o,disabled:a,ref:x,domRef:w,className:null==g?void 0:g.input},E)))});export{D as I};
