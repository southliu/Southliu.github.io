import{i as e,l as t,e as n,K as o,h as c,d as r}from"./@rc-component_util@1.7.0_re_97ed4941f5d27d044aa2ecbc4a75f304.OytLLzRX.js";import{c as a}from"./clsx@2.1.1.BvmCeSbq.js";import{r as s,e as i}from"./react@19.2.3.D3o_8b5j.js";import{C as l}from"./@rc-component_motion@1.1.6__75bed58c5aa0279623e804b6e3100d82.Dp7kHckh.js";import{P as u}from"./@rc-component_portal@2.2.0__23d0e188c8e59a845be2370f4ba3b141.DMGK87O5.js";const m=s.createContext(null);function f(){return{width:document.documentElement.clientWidth,height:window.innerHeight||document.documentElement.clientHeight}}const d={x:0,y:0,rotate:0,scale:1,flipX:!1,flipY:!1};function p(e,t,n,o){const c=t+n,r=(n-o)/2;if(n>o){if(t>0)return{[e]:r};if(t<0&&c<o)return{[e]:-r}}else if(t<0||c>o)return{[e]:t<0?r:-r};return{}}function h(e,t,n,o){const{width:c,height:r}=f();let a=null;return e<=c&&t<=r?a={x:0,y:0}:(e>c||t>r)&&(a={...p("x",n,e,c),...p("y",o,t,r)}),a}function v({src:e,isCustomPlaceholder:t,fallback:n}){const[o,c]=s.useState(t?"loading":"normal"),r=s.useRef(!1),a="error"===o;s.useEffect(()=>{let t=!0;return function(e){return new Promise(t=>{if(!e)return void t(!1);const n=document.createElement("img");n.onerror=()=>t(!1),n.onload=()=>t(!0),n.src=e})}(e).then(e=>{!e&&t&&c("error")}),()=>{t=!1}},[e]),s.useEffect(()=>{t&&!r.current?c("loading"):a&&c("normal")},[e]);const i=()=>{c("normal")};return[e=>{r.current=!1,"loading"===o&&(null==e?void 0:e.complete)&&(e.naturalWidth||e.naturalHeight)&&(r.current=!0,i())},a&&n?{src:n}:{onLoad:i,src:e},o]}function g(e,t){const n=e.x-t.x,o=e.y-t.y;return Math.hypot(n,o)}function y(e,t,n,o,c,r,a){const{rotate:i,scale:l,x:u,y:m}=c,[f,d]=s.useState(!1),p=s.useRef({point1:{x:0,y:0},point2:{x:0,y:0},eventType:"none"}),v=e=>{p.current={...p.current,...e}};return s.useEffect(()=>{const e=e=>{e.preventDefault()};return n&&t&&window.addEventListener("touchmove",e,{passive:!1}),()=>{window.removeEventListener("touchmove",e)}},[n,t]),{isTouching:f,onTouchStart:e=>{if(!t)return;e.stopPropagation(),d(!0);const{touches:n=[]}=e;n.length>1?v({point1:{x:n[0].clientX,y:n[0].clientY},point2:{x:n[1].clientX,y:n[1].clientY},eventType:"touchZoom"}):v({point1:{x:n[0].clientX-u,y:n[0].clientY-m},eventType:"move"})},onTouchMove:e=>{const{touches:t=[]}=e,{point1:n,point2:o,eventType:c}=p.current;if(t.length>1&&"touchZoom"===c){const e={x:t[0].clientX,y:t[0].clientY},c={x:t[1].clientX,y:t[1].clientY},[r,s]=function(e,t,n,o){const c=g(e,n),r=g(t,o);if(0===c&&0===r)return[e.x,e.y];const a=c/(c+r);return[e.x+a*(t.x-e.x),e.y+a*(t.y-e.y)]}(n,o,e,c),i=g(e,c)/g(n,o);a(i,"touchZoom",r,s,!0),v({point1:e,point2:c,eventType:"touchZoom"})}else"move"===c&&(r({x:t[0].clientX-n.x,y:t[0].clientY-n.y},"move"),v({eventType:"move"}))},onTouchEnd:()=>{if(!n)return;if(f&&d(!1),v({eventType:"none"}),o>l)return r({x:0,y:0,scale:o},"touchZoom");const t=e.current.offsetWidth*l,c=e.current.offsetHeight*l,{left:a,top:s}=e.current.getBoundingClientRect(),u=i%180!=0,m=h(u?c:t,u?t:c,a,s);m&&r({...m},"dragRebound")}}}function C(e){const{prefixCls:t,icon:n,onClick:o}=e;return s.createElement("button",{className:"".concat(t,"-close"),onClick:o},n)}function w(e){const{prefixCls:t,showProgress:n,current:o,count:c,showSwitch:r,classNames:i,styles:l,icons:u,image:m,transform:f,countRender:d,actionsRender:p,scale:h,minScale:v,maxScale:g,onActive:y,onFlipY:C,onFlipX:w,onRotateLeft:x,onRotateRight:E,onZoomOut:b,onZoomIn:k,onClose:R,onReset:N}=e,{left:Y,right:S,prev:T,next:X,flipY:O,flipX:P,rotateLeft:I,rotateRight:L,zoomOut:j,zoomIn:M}=u,Z=n&&s.createElement("div",{className:"".concat(t,"-progress")},d?d(o+1,c):s.createElement("bdi",null,"".concat(o+1," / ").concat(c))),z="".concat(t,"-actions-action"),F=({type:e,disabled:t,onClick:n,icon:o})=>s.createElement("div",{key:e,className:a(z,"".concat(z,"-").concat(e),{["".concat(z,"-disabled")]:!!t}),onClick:n},o),W=r?F({icon:null!=T?T:Y,onClick:()=>y(-1),type:"prev",disabled:0===o}):void 0,_=r?F({icon:null!=X?X:S,onClick:()=>y(1),type:"next",disabled:o===c-1}):void 0,H=F({icon:O,onClick:C,type:"flipY"}),A=F({icon:P,onClick:w,type:"flipX"}),D=F({icon:I,onClick:x,type:"rotateLeft"}),B=F({icon:L,onClick:E,type:"rotateRight"}),G=F({icon:j,onClick:b,type:"zoomOut",disabled:h<=v}),K=F({icon:M,onClick:k,type:"zoomIn",disabled:h===g}),U=s.createElement("div",{className:a("".concat(t,"-actions"),i.actions),style:l.actions},H,A,D,B,G,K);return s.createElement("div",{className:a("".concat(t,"-footer"),i.footer),style:l.footer},Z,p?p(U,{icons:{prevIcon:W,nextIcon:_,flipYIcon:H,flipXIcon:A,rotateLeftIcon:D,rotateRightIcon:B,zoomOutIcon:G,zoomInIcon:K},actions:{onActive:y,onFlipY:C,onFlipX:w,onRotateLeft:x,onRotateRight:E,onZoomOut:b,onZoomIn:k,onReset:N,onClose:R},transform:f,current:o,total:c,image:m}):U)}function x(e){const{prefixCls:t,onActive:n,current:o,count:c,icons:{left:r,right:i,prev:l,next:u}}=e,m="".concat(t,"-switch");return s.createElement(s.Fragment,null,s.createElement("div",{className:a(m,"".concat(m,"-prev"),{["".concat(m,"-disabled")]:0===o}),onClick:()=>n(-1)},null!=l?l:r),s.createElement("div",{className:a(m,"".concat(m,"-next"),{["".concat(m,"-disabled")]:o===c-1}),onClick:()=>n(1)},null!=u?u:i))}function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},E.apply(this,arguments)}const b=({fallback:e,src:t,imgRef:n,...o})=>{const[c,r]=v({src:t,fallback:e});return i.createElement("img",E({ref:e=>{n.current=e,c(e)}},o,r))},k=r=>{const{prefixCls:p,rootClassName:v,src:g,alt:k,imageInfo:R,fallback:N,movable:Y=!0,onClose:S,open:T,afterOpenChange:X,icons:O={},closeIcon:P,getContainer:I,current:L=0,count:j=1,countRender:M,scaleStep:Z=.5,minScale:z=1,maxScale:F=50,motionName:W="fade",imageRender:_,imgCommonProps:H,actionsRender:A,onTransform:D,onChange:B,classNames:G={},styles:K={},mousePosition:U,zIndex:V}=r,q=s.useRef(),J=s.useContext(m),Q=J&&j>1,$=J&&j>=1,[ee,te]=s.useState(!0),{transform:ne,resetTransform:oe,updateTransform:ce,dispatchZoomChange:re}=function(n,o,c,r){const a=s.useRef(null),i=s.useRef([]),[l,u]=s.useState(d),m=(e,n)=>{null===a.current&&(i.current=[],a.current=t(()=>{u(e=>{let t=e;return i.current.forEach(e=>{t={...t,...e}}),a.current=null,null==r||r({transform:t,action:n}),t})})),i.current.push({...l,...e})};return{transform:l,resetTransform:t=>{u(d),e(d,l)||null==r||r({transform:d,action:t})},updateTransform:m,dispatchZoomChange:(e,t,r,a,s)=>{const{width:i,height:u,offsetWidth:d,offsetHeight:p,offsetLeft:h,offsetTop:v}=n.current;let g=e,y=l.scale*e;y>c?(y=c,g=c/l.scale):y<o&&(y=s?y:o,g=y/l.scale);const C=null!=r?r:innerWidth/2,w=null!=a?a:innerHeight/2,x=g-1,E=x*i*.5,b=x*u*.5,k=x*(C-l.x-h),R=x*(w-l.y-v);let N=l.x-(k-E),Y=l.y-(R-b);if(e<1&&1===y){const e=d*y,t=p*y,{width:n,height:o}=f();e<=n&&t<=o&&(N=0,Y=0)}m({x:N,y:Y,scale:y},t)}}}(q,z,F,D),{isMoving:ae,onMouseDown:se,onWheel:ie}=function(e,t,n,o,c,r,a){const{rotate:i,scale:l,x:u,y:m}=c,[f,d]=s.useState(!1),p=s.useRef({diffX:0,diffY:0,transformX:0,transformY:0}),v=e=>{n&&f&&r({x:e.pageX-p.current.diffX,y:e.pageY-p.current.diffY},"move")},g=()=>{if(n&&f){d(!1);const{transformX:t,transformY:n}=p.current;if(u===t||m===n)return;const o=e.current.offsetWidth*l,c=e.current.offsetHeight*l,{left:a,top:s}=e.current.getBoundingClientRect(),f=i%180!=0,v=h(f?c:o,f?o:c,a,s);v&&r({...v},"dragRebound")}};return s.useEffect(()=>{if(t){window.addEventListener("mouseup",g,!1),window.addEventListener("mousemove",v,!1);try{window.top!==window.self&&(window.top.addEventListener("mouseup",g,!1),window.top.addEventListener("mousemove",v,!1))}catch(e){}}return()=>{var t,n;window.removeEventListener("mouseup",g),window.removeEventListener("mousemove",v);try{null==(t=window.top)||t.removeEventListener("mouseup",g),null==(n=window.top)||n.removeEventListener("mousemove",v)}catch(e){}}},[n,f,u,m,i,t]),{isMoving:f,onMouseDown:e=>{t&&0===e.button&&(e.preventDefault(),e.stopPropagation(),p.current={diffX:e.pageX-u,diffY:e.pageY-m,transformX:u,transformY:m},d(!0))},onMouseMove:v,onMouseUp:g,onWheel:e=>{if(!n||0==e.deltaY)return;const t=Math.abs(e.deltaY/100);let c=1+Math.min(t,1)*o;e.deltaY>0&&(c=1/c),a(c,"wheel",e.clientX,e.clientY)}}}(q,Y,T,Z,ne,ce,re),{isTouching:le,onTouchStart:ue,onTouchMove:me,onTouchEnd:fe}=y(q,Y,T,z,ne,ce,re),{rotate:de,scale:pe}=ne;s.useEffect(()=>{ee||te(!0)},[ee]),s.useEffect(()=>{T||oe("close")},[T]);const he=i.createElement(b,E({},H,{width:r.width,height:r.height,imgRef:q,className:"".concat(p,"-img"),alt:k,style:{transform:"translate3d(".concat(ne.x,"px, ").concat(ne.y,"px, 0) scale3d(").concat(ne.flipX?"-":"").concat(pe,", ").concat(ne.flipY?"-":"").concat(pe,", 1) rotate(").concat(de,"deg)"),transitionDuration:(!ee||le)&&"0s"},fallback:N,src:g,onWheel:ie,onMouseDown:se,onDoubleClick:e=>{T&&(1!==pe?ce({x:0,y:0,scale:1},"doubleClick"):re(1+Z,"doubleClick",e.clientX,e.clientY))},onTouchStart:ue,onTouchMove:me,onTouchEnd:fe,onTouchCancel:fe})),ve={url:g,alt:k,...R},ge=()=>{re(1+Z,"zoomIn")},ye=()=>{re(1/(1+Z),"zoomOut")},Ce=()=>{ce({rotate:de+90},"rotateRight")},we=()=>{ce({rotate:de-90},"rotateLeft")},xe=()=>{ce({flipX:!ne.flipX},"flipX")},Ee=()=>{ce({flipY:!ne.flipY},"flipY")},be=()=>{oe("reset")},ke=e=>{const t=L+e;t>=0&&t<=j-1&&(te(!1),oe(e<0?"prev":"next"),null==B||B(t,L))},Re=n(e=>{if(T){const{keyCode:t}=e;t===o.ESC&&(null==S||S()),Q&&(t===o.LEFT?ke(-1):t===o.RIGHT&&ke(1))}});s.useEffect(()=>{if(T)return window.addEventListener("keydown",Re),()=>{window.removeEventListener("keydown",Re)}},[T]);const[Ne,Ye]=s.useState(!1);i.useEffect(()=>{T&&Ye(!0)},[T]);const[Se,Te]=s.useState(!1);c(()=>{T&&Te(!0)},[T]);const Xe={...K.body};return U&&(Xe.transformOrigin="".concat(U.x,"px ").concat(U.y,"px")),i.createElement(u,{open:Se,getContainer:I,autoLock:Ne},i.createElement(l,{motionName:W,visible:Se&&T,motionAppear:!0,motionEnter:!0,motionLeave:!0,onVisibleChanged:e=>{e||Ye(!1),null==X||X(e)}},({className:e,style:t})=>{const n={...K.root,...t};return V&&(n.zIndex=V),i.createElement("div",{className:a(p,v,G.root,e,{["".concat(p,"-moving")]:ae}),style:n},i.createElement("div",{className:a("".concat(p,"-mask"),G.mask),style:K.mask,onClick:S}),i.createElement("div",{className:a("".concat(p,"-body"),G.body),style:Xe},_?_(he,{transform:ne,image:ve,...J?{current:L}:{}}):he),!1!==P&&null!==P&&i.createElement(C,{prefixCls:p,icon:!0===P?O.close:P||O.close,onClick:S}),Q&&i.createElement(x,{prefixCls:p,current:L,count:j,icons:O,onActive:ke}),i.createElement(w,{prefixCls:p,showProgress:$,current:L,count:j,showSwitch:Q,classNames:G,styles:K,image:ve,transform:ne,icons:O,countRender:M,actionsRender:A,scale:pe,minScale:z,maxScale:F,onActive:ke,onFlipY:Ee,onFlipX:xe,onRotateLeft:we,onRotateRight:Ce,onZoomOut:ye,onZoomIn:ge,onClose:S,onReset:be}))}))},R=["crossOrigin","decoding","draggable","loading","referrerPolicy","sizes","srcSet","useMap","alt"];function N(){return N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},N.apply(this,arguments)}let Y=0;function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},S.apply(this,arguments)}const T=e=>{const{prefixCls:t="rc-image",previewPrefixCls:n="".concat(t,"-preview"),rootClassName:o,className:c,style:i,classNames:l={},styles:u={},width:f,height:d,src:p,alt:h,placeholder:g,fallback:y,preview:C=!0,onClick:w,onError:x,...E}=e,b=s.useContext(m),N=!!C,{src:T,open:X,onOpenChange:O,cover:P,rootClassName:I,...L}=C&&"object"==typeof C?C:{},j="object"==typeof P&&P.placement&&P.placement||"center",M="object"==typeof P&&P.coverNode?P.coverNode:P,[Z,z]=r(!!X,X),[F,W]=s.useState(null),_=e=>{z(e),null==O||O(e)},H=g&&!0!==g,A=null!=T?T:p,[D,B,G]=v({src:p,isCustomPlaceholder:H,fallback:y}),K=s.useMemo(()=>{const t={};return R.forEach(n=>{void 0!==e[n]&&(t[n]=e[n])}),t},R.map(t=>e[t])),U=function(e,t){const[n]=s.useState(()=>(Y+=1,String(Y))),o=s.useContext(m),c={data:t,canPreview:e};return s.useEffect(()=>{if(o)return o.register(n,c)},[]),s.useEffect(()=>{o&&o.register(n,c)},[e,t]),n}(N,s.useMemo(()=>({...K,src:A}),[A,K]));return s.createElement(s.Fragment,null,s.createElement("div",S({},E,{className:a(t,o,l.root,{["".concat(t,"-error")]:"error"===G}),onClick:N?e=>{const t=e.target.getBoundingClientRect(),n=t.x+t.width/2,o=t.y+t.height/2;b?b.onPreview(U,A,n,o):(W({x:n,y:o}),_(!0)),null==w||w(e)}:w,style:{width:f,height:d,...u.root}}),s.createElement("img",S({},K,{className:a("".concat(t,"-img"),{["".concat(t,"-img-placeholder")]:!0===g},l.image,c),style:{height:d,...u.image,...i},ref:D},B,{width:f,height:d,onError:x})),"loading"===G&&s.createElement("div",{"aria-hidden":"true",className:"".concat(t,"-placeholder")},g),!1!==P&&N&&s.createElement("div",{className:a("".concat(t,"-cover"),l.cover,"".concat(t,"-cover-").concat(j)),style:{display:"none"===(null==i?void 0:i.display)?"none":void 0,...u.cover}},M)),!b&&N&&s.createElement(k,S({"aria-hidden":!Z,open:Z,prefixCls:n,onClose:()=>{_(!1)},mousePosition:F,src:A,alt:h,imageInfo:{width:f,height:d},fallback:y,imgCommonProps:K},L,{classNames:null==l?void 0:l.popup,styles:null==u?void 0:u.popup,rootClassName:a(I,o)})))};T.PreviewGroup=({previewPrefixCls:e="rc-image-preview",classNames:t,styles:o,children:c,icons:a={},items:i,preview:l,fallback:u})=>{var f;const{open:d,onOpenChange:p,current:h,onChange:v,...g}=l&&"object"==typeof l?l:{},[y,C,w]=function(e){const[t,n]=s.useState({}),o=s.useCallback((e,t)=>(n(n=>({...n,[e]:t})),()=>{n(t=>{const n={...t};return delete n[e],n})}),[]);return[s.useMemo(()=>e?e.map(e=>{if("string"==typeof e)return{data:{src:e}};const t={};return Object.keys(e).forEach(n=>{["src",...R].includes(n)&&(t[n]=e[n])}),{data:t}}):Object.keys(t).reduce((e,n)=>{const{canPreview:o,data:c}=t[n];return o&&e.push({data:c,id:n}),e},[]),[e,t]),o,!!e]}(i),[x,E]=r(0,h),[b,Y]=s.useState(!1),{src:S,...T}=(null==(f=y[x])?void 0:f.data)||{},[X,O]=r(!!d,d),P=n(e=>{O(e),e!==X&&(null==p||p(e,{current:x}))}),[I,L]=s.useState(null),j=s.useCallback((e,t,n,o)=>{const c=w?y.findIndex(e=>e.data.src===t):y.findIndex(t=>t.id===e);E(c<0?0:c),P(!0),L({x:n,y:o}),Y(!0)},[y,w]);s.useEffect(()=>{X?b||E(0):Y(!1)},[X]);const M=s.useMemo(()=>({register:C,onPreview:j}),[C,j]);return s.createElement(m.Provider,{value:M},c,s.createElement(k,N({"aria-hidden":!X,open:X,prefixCls:e,onClose:()=>{P(!1),L(null)},mousePosition:I,imgCommonProps:T,src:S,fallback:u,icons:a,current:x,count:y.length,onChange:(e,t)=>{E(e),null==v||v(e,t)}},g,{classNames:null==t?void 0:t.popup,styles:null==o?void 0:o.popup})))};export{T as I};
