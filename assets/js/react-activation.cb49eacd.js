import{n as e,l as t}from"./@babel_runtime.d775819b.js";import{r as n,a as r,b as o,c,d as a,e as u,f as i,g as l,h as s,i as p,j as f,k as d,l as h,m as v,n as y}from"./szfe-tools.83ebc5a8.js";import{r as m}from"./react.a7da97a2.js";import{r as g}from"./create-react-context.3ef34c67.js";import{r as w}from"./react-dom.cfbe57ec.js";import{a as b}from"./hoist-non-react-statics.b23c5de2.js";import{r as k}from"./react-node-key.23b4b3b4.js";var S={exports:{}},E={exports:{}};!function(e,t,n,r,o,c,a,u,i,l,s,p,f,d,h,v,y,m,g,w,b){t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var k="default"in c?c.default:c;function S(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)),r}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,F(r.key),r)}}function P(e,t,n){t&&C(e.prototype,t),n&&C(e,n),Object.defineProperty(e,"prototype",{writable:!1})}function j(e,t,n){return(t=F(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(){return(_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function I(e,t){if(null==e)return{};var n,r=function(e,t){if(null==e)return{};for(var n,r={},o=Object.keys(e),c=0;c<o.length;c++)n=o[c],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(e),c=0;c<o.length;c++)n=o[c],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n]);return r}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return B(e)}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A(e);return $(this,t?(n=A(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments))}}function R(e,t){return z(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,u=[],i=!0,l=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=c.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(s){l=!0,o=s}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(e,t)||M(e,t)||V()}function T(e){return z(e)||L(e)||M(e)||V()}function D(e){return function(e){if(Array.isArray(e))return W(e)}(e)||L(e)||M(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e){if(Array.isArray(e))return e}function L(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function M(e,t){var n;if(e)return"string"==typeof e?W(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function F(e){return"symbol"==typeof(e=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);if("object"!=typeof(n=n.call(e,t||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"))?e:String(e)}function K(){var e,t,n;return a(c.useContext)?c.useContext(X)||(t=(e=R(c.useState(te.currentContextValue),2))[0],n=e[1],c.useEffect((function(){var e=o(n);return ee.on("update",e),function(){return ee.off("update",e)}}),[]),t):{}}function q(e){var t=e.children;return e=I(e,re),k.createElement(G,_({},e,{_nk:"".concat(oe,"11")}),k.createElement(te,_({},e,{_nk:"".concat(oe,"21")}),t))}function H(e){var t=e.children;return k.createElement(J,{_nk:"".concat(oe,"31")},(function(e){return e?r(t,void 0,e):k.createElement(ne,{_nk:"".concat(oe,"41")},t)}))}a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,v=v&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,w=w&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w,b=b&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b;var X=u(),G=X.Provider,J=X.Consumer,Q=u(),Y=Q.Provider,Z=Q.Consumer,ee=new i,te=function(){x(t,c.Component);var e=U(t);function t(n){var r;return O(this,t),r=e.call(this,n),t.currentContextValue=n.value,r}return P(t,[{key:"shouldComponentUpdate",value:function(e){return e.value!==this.props.value&&(t.currentContextValue=e.value,ee.emit("update",e.value)),e.children!==this.props.children||e.value!==this.props.value}},{key:"render",value:function(){return this.props.children}}]),t}(),ne=(j(te,"eventBus",ee),j(te,"currentContextValue",void 0),function(){x(t,c.PureComponent);var e=U(t);function t(n){var r;return O(this,t),j(B(r=e.call(this,n)),"state",{context:te.currentContextValue}),j(B(r),"updateListener",o((function(e){r.setState({context:e})}))),ee.on("update",r.updateListener),r}return P(t,[{key:"componentWillUnmount",value:function(){ee.off("update",this.updateListener)}},{key:"render",value:function(){var e=this.props.children,t=this.state.context;return r(e,void 0,t)}}]),t}()),re=["children"],oe="qj9A",ce=function(){x(t,c.Component);var e=U(t);function t(){var n;O(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return j(B(n=e.call.apply(e,[this].concat(o))),"promiseCache",{}),n}return P(t,[{key:"render",value:function(){var e=(t=this.props).freeze,t=t.children,n=this.promiseCache;if(e&&!n.promise)throw n.promise=new Promise((function(e){n.resolve=e})),n.promise;if(e)throw n.promise;return n.promise&&(n.resolve(),n.promise=void 0),k.createElement(c.Fragment,null,t)}}]),t}();function ae(){try{for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach((function(e){var t=(e=T(e))[0];e.slice(1).forEach((function(e){var r;a(n(t,e))&&!n(t,[e,"_overridden"])&&(r=t[e].bind(t),t[e]=function(e){p(e)||fe(e);for(var t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return r.apply(void 0,[e].concat(n))},t[e]._overridden=!0)}))}))}catch(o){}}function ue(e){return e=e.children,r(e)}var ie=[],le=new Map,se=new i,pe=d((function(e){f(e)&&![X,Q].includes(e)&&(f(e.Consumer)||(e.Consumer=function(t){t=t.children;var n=r(c.useContext,void 0,e);return k.createElement(c.Fragment,null,r(t,void 0,n))}),ie.push(e),setTimeout((function(){return se.emit("update")})))})),fe=d((function(e){e=n(e,"_context")||n(e,"context"),n(e,"$$typeof")===n(X,"$$typeof")&&pe(e)})),de=(ae([k,"createElement"]),function(){x(t,c.PureComponent);var e=U(t);function t(n){var r,o;return O(this,t),j(B(r=e.call(this,n)),"unmount",null),0===(n=n.value).length?(r.state={ctxValue:null},$(r)):((n=R(n,1)[0]).ctx,o=n.value,n=n.onUpdate,r.state={ctxValue:o},r.unmount=n((function(e){r.setState({ctxValue:e})})),r)}return P(t,[{key:"componentWillUnmount",value:function(){r(this.unmount)}},{key:"render",value:function(){var e,n,r=(o=this.props).value,o=o.children;return 0===(r=r.filter(Boolean)).length?o:(e=this.state.ctxValue,n=(r=T(r))[0].ctx,r=r.slice(1),n=n.Provider,n=h(e)?o:k.createElement(n,{value:e,_nk:"".concat("lqEk","11")},o),0<r.length?k.createElement(t,{value:r,_nk:"".concat("lqEk","21")},n):n)}}]),t}()),he=function(){x(t,c.Component);var e=U(t);function t(o){O(this,t),j(B(c=e.call(this,o)),"updateListener",null),j(B(c),"ctxInfo",null);var c,a=o.value,u=o.ctx;return o=o.id,h(a)?$(c):(c.updateListener=n(le.get(u),o,new Map),r(c.updateListener,"forEach",(function(e){return e(a)})),c.ctxInfo={ctx:u,value:a,onUpdate:function(e){return c.updateListener.set(e,e),function(){return c.updateListener.delete(e)}}},c)}return P(t,[{key:"componentWillUnmount",value:function(){var e=(r=this.props).value,t=r.ctx,r=r.id;h(e)||le.set(t,E(E({},n(le.get(t),void 0,{})),{},j({},r,this.updateListener)))}},{key:"shouldComponentUpdate",value:function(e){var t=e.value;return this.props.value!==t&&r(this.updateListener,"forEach",(function(e){return e(t)})),!0}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.renderWrapper,o=t.renderContent;return t.id,r((function(t){return o(h(n)?t:[].concat(D(t),[e.ctxInfo]))}))}}]),t}(),ve={},ye=function(){x(t,c.PureComponent);var e=U(t);function t(n){var r;return O(this,t),j(B(r=e.call(this,n)),"renderWrapper",(function(e){var t=r.props.id;return ve[t].reduce((function(e,n){var r=n.Consumer;return function(o){return k.createElement(r,{_nk:"".concat("SsUr","11")},(function(r){return k.createElement(he,{value:r,ctx:n,renderWrapper:e,renderContent:o,id:t,_nk:"".concat("SsUr","21")})}))}}),(function(e){return e([])}))(e)})),n=n.id,ve[n]||(ve[n]=D(ie).filter((function(e){return f(e.Consumer)}))),r}return P(t,[{key:"render",value:function(){var e=this.props.children;return this.renderWrapper(e)}}]),t}(),me="46lG",ge=(d=a(c.lazy)&&!h(c.Suspense))?c.lazy((function(){return new Promise((function(){return null}))})):function(){return null},we=function(){x(t,c.Component);var e=U(t);function t(){return O(this,t),e.apply(this,arguments)}return P(t,[{key:"componentDidMount",value:function(){r(this.props,"onStart")}},{key:"componentWillUnmount",value:function(){r(this.props,"onEnd")}},{key:"render",value:function(){return null}}]),t}(),be=d?function(){x(t,c.Component);var e=U(t);function t(){var n;O(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return j(B(n=e.call.apply(e,[this].concat(o))),"state",{suspense:!1}),j(B(n),"onSuspenseStart",(function(){n.setState({suspense:!0})})),j(B(n),"onSuspenseEnd",(function(){n.setState({suspense:!1})})),j(B(n),"sus$$",{onSuspenseStart:n.onSuspenseStart,onSuspenseEnd:n.onSuspenseEnd}),n}return P(t,[{key:"render",value:function(){var e=this.props.children;return k.createElement(c.Fragment,null,r(e,void 0,this.sus$$),this.state.suspense&&k.createElement(ge,{_nk:"".concat(me,"31")}))}}]),t}():ue,ke=d?function(e){var t=e.children;return e=e.sus$$,k.createElement(c.Suspense,{fallback:k.createElement(we,{onStart:e.onSuspenseStart,onEnd:e.onSuspenseEnd,_nk:"".concat(me,"21")}),_nk:"".concat(me,"11")},t)}:ue,Se=function(){x(t,c.Component);var e=U(t);function t(){return O(this,t),e.apply(this,arguments)}return P(t,[{key:"componentDidCatch",value:function(e){var t=this.props.error$$;r(t,void 0,e,(function(){r(t,void 0,null)}))}},{key:"render",value:function(){return this.props.children}}]),t}(),Ee=(j(Se,"getDerivedStateFromError",(function(){return null})),function(){x(t,c.Component);var e=U(t);function t(){var n;O(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return j(B(n=e.call.apply(e,[this].concat(o))),"state",{error:null}),j(B(n),"throwError",(function(e,t){return n.setState({error:e},t)})),n}return P(t,[{key:"render",value:function(){if(this.state.error)throw this.state.error;return r(this.props.children,void 0,this.throwError)}}]),t}()),Oe="lajT";function Ce(e){var t=e.id,n=e.children,r=(e=e.bridgeProps).sus$$,o=e.ctx$$;return e=e.error$$,k.createElement(Se,{error$$:e,_nk:"".concat(Oe,"11")},k.createElement(ke,{sus$$:r,_nk:"".concat(Oe,"21")},k.createElement(de,{id:t,value:o,_nk:"".concat(Oe,"31")},n)))}function Pe(e){var t=e.id,n=e.children;return k.createElement(Ee,{_nk:"".concat(Oe,"41")},(function(e){return k.createElement(be,{_nk:"".concat(Oe,"51")},(function(o){return k.createElement(ye,{id:t,_nk:"".concat(Oe,"61")},(function(t){return r(n,void 0,{bridgeProps:{sus$$:o,ctx$$:t,error$$:e}})}))}))}))}function je(e){var t=function(){x(o,c.Component);var t=U(o);function o(){var e;O(this,o);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return j(B(e=t.call.apply(t,[this].concat(r))),"drop",null),e}return P(o,[{key:"componentWillUnmount",value:function(){r(this.drop)}},{key:"render",value:function(){var t=this,o=this.props,c=o.forwardedRef,u=I(o,xe);return k.createElement(Z,{_nk:"".concat(Ae,"11")},(function(){var o=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).attach;return k.createElement(e,_({ref:function(e){[Ne,Ie].every((function(t){return!a(n(e,t))}))||(t.drop=r(o,void 0,e),h(c))||(v(c)&&"current"in c?c.current=e:r(c,void 0,e))}},u,{_nk:"".concat(Ae,"21")}))}))}}]),o}();return a(e.prototype.componentDidMount)&&(e.prototype._componentDidMount=e.prototype.componentDidMount,e.prototype.componentDidMount=function(){var t=this;l((function(){return e.prototype._componentDidMount.call(t)}))}),a(c.forwardRef)?y(c.forwardRef((function(e,n){return k.createElement(t,_({},e,{forwardedRef:n,_nk:"".concat(Ae,"31")}))})),e):y(t,e)}function _e(e,t){var n,o;[c.useRef,c.useContext,c.useEffect].some((function(e){return!a(e)}))||(o=c.useContext(Q))&&(n=c.useRef({}).current,o=o.attach,n[e]=t,n.drop=o(n),c.useEffect((function(){return function(){return r(n.drop)}}),[]))}var xe=["forwardedRef"],Ae="XKTv",Ne="componentDidActivate",Ie="componentWillUnactivate",Be=(d=_e.bind(null,Ne),_e.bind(null,Ie)),$e=["id","autoFreeze"],Ue="bNyU",Re=c.Suspense?function(e){var t=e.freeze,n=e.children;return e=e.placeholder,k.createElement(c.Suspense,{fallback:void 0===e?null:e,_nk:"".concat("Leb+","11")},k.createElement(ce,{freeze:t,_nk:"".concat("Leb+","21")},n))}:function(e){return e.children},Te=function(){x(t,c.PureComponent);var e=U(t);function t(o){var c;O(this,t);for(var a=arguments.length,u=new Array(1<a?a-1:0),s=1;s<a;s++)u[s-1]=arguments[s];return j(B(c=e.call.apply(e,[this,o].concat(u))),"eventBus",new i),j(B(c),"listeners",new Map),j(B(c),"wrapper",null),j(B(c),"cache",void 0),j(B(c),"unmounted",!1),j(B(c),"safeSetState",(function(e,t){c.unmounted||c.setState(e,t)})),j(B(c),"freezeTimeout",null),j(B(c),"attach",(function(e){var t,n=c.listeners;return e?(e.isKeepAlive&&l((function(){var t,n=(t=c.props).id;(t=t.store.get(n)).aliveNodesId=new Set([].concat(D(t.aliveNodesId),[e.id]))})),n.set(e,(j(t={},Ne,(function(){return r(e,Ne)})),j(t,Ie,(function(){return r(e,Ie)})),t)),function(){n.delete(e)}):function(){return null}})),j(B(c),"contextValue",{id:c.props.id,attach:c.attach}),j(B(c),"drop",(function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).delay,t=void 0===e?1200:e;return new Promise((function(e){function r(){clearTimeout(o),c.eventBus.off(Ie,r),c.cache.willDrop=!0,u.nodes.delete(i),u.helpers=E({},u.helpers),u.smartForceUpdate((function(){return e(!0)}))}var o,a=c.props,u=a.scope,i=a.id;n(c.cache,"cached")||n(c.cache,"willDrop")?r():(c.eventBus.on(Ie,r),o=setTimeout((function(){c.eventBus.off(Ie,r),e(!1)}),t))}))})),j(B(c),"refresh",(function(){return new Promise((function(e){n(c.cache,"cached")&&e(!1),c.safeSetState({key:Math.random()},(function(){return e(!0)}))}))})),c.state={children:o.children,bridgeProps:o.bridgeProps,key:Math.random(),freeze:!1},c}return P(t,[{key:"componentDidMount",value:function(){var e,t=this,n=(r=this.props).store,r=r.id,o=this.listeners,c=this.wrapper;if(!n.has(r)){try{e=D(c.children)}catch(a){e=[c.children]}this.cache=(j(o={listeners:o,aliveNodesId:[],inited:!1,cached:!1,wrapper:c,nodes:e},Ne,(function(){return t[Ne]()})),j(o,Ie,(function(){return t[Ie]()})),o),n.set(r,this.cache)}}},{key:"componentWillUnmount",value:function(){var e=(n=this.props).store,t=n.keepers,n=n.id;try{var r=e.get(n);r.nodes.forEach((function(e){r.wrapper.appendChild(e)}))}catch(o){}e.delete(n),t.delete(n),this.unmounted=!0}},{key:Ne,value:function(){clearTimeout(this.freezeTimeout),this.safeSetState({freeze:!1}),this.eventBus.emit(Ne),this.listeners.forEach((function(e){return r(e,[Ne])}))}},{key:Ie,value:function(){var e=this;this.eventBus.emit(Ie),D(this.listeners).reverse().forEach((function(e){return e=R(e,2)[1],r(e,[Ie])})),clearTimeout(this.freezeTimeout),this.freezeTimeout=setTimeout((function(){s.flushSync((function(){e.safeSetState({freeze:!0})}))}),1e3)}},{key:"render",value:function(){var e=this,t=(a=this.props).id,n=void 0===(n=a.autoFreeze)||n,r=(I(a,$e),a=this.state).children,o=a.bridgeProps,c=a.key,a=a.freeze;return k.createElement(Re,{freeze:n&&a,_nk:"".concat(Ue,"11")},k.createElement("div",{ref:function(t){e.wrapper=t},_nk:"".concat(Ue,"21")},k.createElement("div",{key:"keeper-container",className:"ka-content"},k.createElement(Ce,{id:t,bridgeProps:o,_nk:"".concat(Ue,"31")},k.createElement(Y,{value:this.contextValue,_nk:"".concat(Ue,"41")},k.Children.map(r,(function(e,t){return k.cloneElement(e,{key:"".concat(e.key||"",":").concat(c,":").concat(t)})})))))))}}]),t}(),De=["children"],ze="UVSV",Le="drop",Me="refresh",We=function(){x(a,c.Component);var e=U(a);function a(){var c;O(this,a);for(var u=arguments.length,i=new Array(u),l=0;l<u;l++)i[l]=arguments[l];return j(B(c=e.call.apply(e,[this].concat(i))),"store",new Map),j(B(c),"nodes",new Map),j(B(c),"keepers",new Map),j(B(c),"debouncedForceUpdate",o((function(e){return c.forceUpdate(e)}))),j(B(c),"updateCallbackList",[]),j(B(c),"smartForceUpdate",(function(e){c.updateCallbackList.push(e),c.debouncedForceUpdate((function(){c.updateCallbackList.forEach((function(e){return r(e)})),c.updateCallbackList=[]}))})),j(B(c),"update",(function(e,t){return new Promise((function(n){var r=c.keepers.get(e),o=!r,a=Date.now(),u=c.nodes.get(e)||null;c.nodes.set(e,E(E({id:e,createTime:a,updateTime:a},u),t)),o?(c.helpers=E({},c.helpers),c.forceUpdate(n)):(a=t.children,u=t.bridgeProps,r.setState({children:a,bridgeProps:u},n))}))})),j(B(c),"keep",(function(e,t){return new Promise((function(n){c.update(e,E({id:e},t)).then((function(){n(c.store.get(e))}))}))})),j(B(c),"getCachingNodesByName",(function(e){return c.getCachingNodes().filter((function(t){return e instanceof RegExp?e.test(t.name):t.name===e}))})),j(B(c),"getScopeIds",(function(e){return t(e.map((function e(t){var r=n(c.getCache(t),"aliveNodesId",[]);return 0<r.size?[t,D(r).map(e)]:[t].concat(D(r))})))})),j(B(c),"dropById",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return c.handleNodes.apply(c,[[e],Le].concat(n))})),j(B(c),"dropScopeByIds",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return c.handleNodes.apply(c,[c.getScopeIds(e),Le].concat(n))})),j(B(c),"drop",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return c.handleNodes.apply(c,[c.getCachingNodesByName(e).map((function(e){return e.id})),Le].concat(n))})),j(B(c),"dropScope",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return c.dropScopeByIds.apply(c,[c.getCachingNodesByName(e).map((function(e){return e.id}))].concat(n))})),j(B(c),"refreshById",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return c.handleNodes.apply(c,[[e],Me].concat(n))})),j(B(c),"refreshScopeByIds",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return c.handleNodes.apply(c,[c.getScopeIds(e),Me].concat(n))})),j(B(c),"refresh",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return c.handleNodes.apply(c,[c.getCachingNodesByName(e).map((function(e){return e.id})),Me].concat(n))})),j(B(c),"refreshScope",(function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return c.refreshScopeByIds.apply(c,[c.getCachingNodesByName(e).map((function(e){return e.id}))].concat(n))})),j(B(c),"handleNodes",(function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Le,n=arguments.length,o=new Array(2<n?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];return new Promise((function(n){var a=[];e.forEach((function(e){c.store.get(e)&&(e=c.keepers.get(e),a.push(e))})),0===a.length?n(!1):Promise.all(a.map((function(e){return r.apply(void 0,[e,t].concat(o))}))).then((function(e){return n(e.every(Boolean))}))}))})),j(B(c),"clear",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.handleNodes.apply(c,[c.getCachingNodes().map((function(e){return e.id})),Le].concat(t))})),j(B(c),"getCache",(function(e){return c.store.get(e)})),j(B(c),"getNode",(function(e){return c.nodes.get(e)})),j(B(c),"getCachingNodes",(function(){return D(c.nodes.values())})),j(B(c),"helpers",{keep:c.keep,update:c.update,drop:c.drop,dropScope:c.dropScope,dropById:c.dropById,dropScopeByIds:c.dropScopeByIds,refresh:c.refresh,refreshScope:c.refreshScope,refreshById:c.refreshById,refreshScopeByIds:c.refreshScopeByIds,getScopeIds:c.getScopeIds,clear:c.clear,getCache:c.getCache,getNode:c.getNode,getCachingNodes:c.getCachingNodes}),c}return P(a,[{key:"render",value:function(){var e=this,t=void 0===(t=this.props.children)?null:t;return k.createElement(q,{value:this.helpers,_nk:"".concat(ze,"11")},t,k.createElement("div",{style:{display:"none"},_nk:"".concat(ze,"21")},D(this.nodes.values()).map((function(t){var n=t.children,r=I(t,De);return k.createElement(Te,_({key:r.id},r,{scope:e,store:e.store,keepers:e.keepers,ref:function(t){e.keepers.set(r.id,t)},_nk:"iAr".concat(ze,"31")}),n)}))))}}]),a}(),Ve=["id"],Fe=["id"],Ke=["forwardedRef"],qe=["forwardedRef"],He="X7Aa";function Xe(e){return{drop:e.drop,dropScope:e.dropScope,refresh:e.refresh,refreshScope:e.refreshScope,clear:e.clear,getCachingNodes:e.getCachingNodes}}function Ge(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return!!f(e)&&(e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight)}function Je(e){return a(n(w,"document.querySelectorAll"))?[].concat(D(m(r(e,"querySelectorAll","*"),[])),[e]).filter(Ge):[]}var Qe,Ye=["_helpers","id","children"],Ze=["_helpers","id","name"],et=n(w,"document.body"),tt=n(w,"document.scrollingElement",n(w,"document.documentElement",{})),nt=function(){x(n,c.Component);var e=U(n);function n(o){var c;return O(this,n),j(B(c=e.call(this,o)),"id",null),j(B(c),"isKeepAlive",!0),j(B(c),"cached",!1),j(B(c),"inject",(function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=(o=c.props).id,n=o.saveScrollPosition,o=o._helpers.getCache(t);try{o.nodes.forEach((function(e){c.placeholder.appendChild(e)})),e&&n&&r(o.revertScrollPos)}catch(a){}})),j(B(c),"eject",(function(){var e,n=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],o=(u=c.props).id,a=u._helpers.getCache(o),u=t(t([c.props.saveScrollPosition]).map((function(e){return!0===e?a.nodes:"screen"===e?[tt,et]:D(m(r(w,"document.querySelectorAll",e),[]))}))).filter(Boolean);try{n&&0<u.length&&(a.revertScrollPos=(e=D(new Set(D(t(u.map(Je))))).map((function(e){return[e,{x:e.scrollLeft,y:e.scrollTop}]})),function(){e.forEach((function(e){var t=(e=R(e,2))[0],n=(e=e[1]).x;e=e.y,t.scrollLeft=n,t.scrollTop=e}))})),a.nodes.forEach((function(e){n?c.placeholder.removeChild(e):a.wrapper.appendChild(e)}))}catch(i){}})),j(B(c),"init",(function(){var e=(o=c.props)._helpers,t=o.id,n=o.children,o=I(o,Ye);e.keep(t,E({children:n,getInstance:function(){return B(c)}},o)).then((function(e){e&&(c.inject(),e.inited?r(B(c),Ne):e.inited=!0,c.cached=!1)}))})),j(B(c),"update",(function(){var e=(r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})._helpers,t=r.id,n=r.name,r=I(r,Ze);e&&!c.cached&&e.update(t,E({name:n,getInstance:function(){return B(c)}},r))})),c.id=o.id,c.init(),[Ne,Ie].forEach((function(e){c[e]=function(){var t,n=(t=c.props).id,o=(t=t._helpers).getCache(n);(t=t.getNode(n))&&e===Ne&&(t.updateTime=Date.now()),n=e===Ie,!o||o.willDrop?c.cached&&!n&&c.init():(r(o,e),o.cached=n,c.cached=n)}})),c}return P(n,[{key:"shouldComponentUpdate",value:function(e){return this.update(e),!1}},{key:"componentWillUnmount",value:function(){var e=(n=this.props).id,t=n._helpers,n=void 0===(n=n.when)||n,o=t.getCache(e);n=r(n);var c=(n=R(g(n)?n:[n],2))[0];n=n[1],o&&(this.eject(),delete o.getInstance,c||(n?([o].concat(D(t.getScopeIds([e]).map((function(e){return t.getCache(e)})))).filter(Boolean).forEach((function(e){e.willDrop=!0})),l((function(){return t.dropScopeByIds([e])}))):(o.willDrop=!0,l((function(){return t.dropById(e)})))),r(this,Ie))}},{key:"render",value:function(){var e=this;return k.createElement("div",{key:"keep-alive-placeholder",className:"ka-wrapper",ref:function(t){e.placeholder=t}})}}]),n}();function rt(e){var t=e.idPrefix,r=e.helpers,o=e.props;return(e=h(r))?n(o,"children",null):k.createElement(b,{prefix:t,key:o._nk,manualKey:o.cacheKey,_nk:"".concat(He,"11")},(function(e){var t=o.cacheKey||e;return k.createElement(Pe,{key:t,id:t,_nk:"".concat(He,"21")},(function(e){return k.createElement(Qe,_({key:t},o,e,{id:t,_helpers:r,_nk:"".concat(He,"31")}))}))}))}j(nt,"defaultProps",{saveScrollPosition:!0}),nt=a(n(w,"document.getElementById"))?(Qe=je(nt),a(c.useContext)?function(e){var t=e.id;return e=I(e,Ve),rt({idPrefix:t,helpers:K(),props:e})}:function(e){var t=e.id,n=I(e,Fe);return k.createElement(H,{_nk:"".concat(He,"41")},(function(e){return rt({idPrefix:t,helpers:e,props:n})}))}):function(e){return e=e.children,k.createElement("div",{key:"keep-alive-placeholder",className:"ka-wrapper"},k.createElement("div",{key:"keeper-container",className:"ka-content"},e))},e.AliveScope=We,e.KeepAlive=nt,e.NodeKey=b,e.autoFixContext=ae,e.createContext=function(e,t){return e=u(e,t),pe(e),e},e.default=nt,e.fixContext=pe,e.useActivate=d,e.useAliveController=function(){var e;return a(c.useContext)&&(e=K())?Xe(e):{}},e.useUnactivate=Be,e.withActivation=je,e.withAliveScope=function(e){function t(t){var n=t.helpers,r=t.props;return t=t.forwardedRef,k.createElement(e,_({},r,n,{ref:t,_nk:"".concat(He,"51")}))}var n=a(c.useContext)?function(e){var n=e.forwardedRef;return e=I(e,Ke),t({helpers:Xe(K()||{}),props:e,forwardedRef:n})}:function(e){var n=e.forwardedRef,r=I(e,qe);return k.createElement(H,{_nk:"".concat(He,"42")},(function(){return t({helpers:Xe(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),props:r,forwardedRef:n})}))};return a(c.forwardRef)?y(c.forwardRef((function(e,t){return k.createElement(n,_({},e,{forwardedRef:t,_nk:"".concat(He,"61")}))})),e):y(n,e)},Object.defineProperty(e,"__esModule",{value:!0})}(E.exports,n(),r(),o(),c(),m,a(),g(),u(),i(),w,l(),s(),p(),f(),d(),b,h(),v(),y(),k());var O=E.exports;S.exports=O;var C=S.exports;const P=t(C);export{P as K,C as r};
